Imports System.IO
Public Class Form2
    Dim a() As String = New String() {"MOV", "ADD", "SUB", "MUL", "DIV", "AND", "OR", "XCHG", "INC", "DEC", "NOT", "ADC", "NEG", "TEST", "SBB", "SHL", "SHR", "SAR", "SAL", "ROL", "ROR", "CMP", "XOR"}
    Dim b() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
    Dim c() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
    Dim a2() As String = New String() {"STC", "CLC", "STP", "CLP", "STA", "CLA", "STZ", "CLZ", "STS", "CLS", "STT", "CLT", "STI", "CLI", "STD", "CLD", "STO", "CLO", "CBW", "CWD"}
    Dim f() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
    Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
    Dim c3() As String = New String() {"BX", "SI", "DI", "BP", "SP"}
    Dim c2() As String = New String() {"BX", "BP", "SP"}
    Dim c1() As String = New String() {"SI", "DI"}
    Dim G() As String = New String() {"[AX]", "[BX]", "[CX]", "[DX]"}
    Dim inpt, inpt1, inpt2 As String
    Dim inp3 As String
    Dim i As Integer
    Dim flag As Boolean = False
    Dim op As Integer
    Dim ch2 As String
    Dim statusflag As Boolean = 0
    Dim binOp1 As String = ""
    Dim binOp2 As String = ""
    Dim carry As Boolean = False
    Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click
        For Each gbox As Object In Me.Controls
            If gbox.GetType().Name.ToLower = "groupbox" Then
                For Each tbox As Object In gbox.controls
                    If tbox.GetType().Name.ToLower = "textbox" Then
                        tbox.text = ""
                        tbox.backcolor = Color.White
                    End If
                Next
            End If
        Next
        GroupBox5.Visible = False
    End Sub
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        'Button1.FlatStyle = FlatStyle.Flat
        inpt1 = UCase(TextBox30.Text)
        inpt2 = UCase(TextBox32.Text)
        inpt = UCase(TextBox29.Text.Trim)
        If TextBox29.Text = "" Then
            TextBox29.Text = ""
            TextBox30.Text = ""
            TextBox31.Text = ""
            TextBox32.Text = ""
            MsgBox("write the instruction")
        ElseIf a.Contains(inpt) Or a2.Contains(inpt) Then
            If TextBox29.Text = "" Then
                TextBox29.Text = ""
                TextBox30.Text = ""
                TextBox31.Text = ""
                TextBox32.Text = ""
                MsgBox("write the instruction")
            Else
                inpt = UCase(TextBox29.Text.Trim)

                If inpt = a(0) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))

                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If

                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub

                ElseIf inpt = a(1) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub

                ElseIf inpt = a(2) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(3) Then
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    inpt1 = UCase(Val(TextBox30.Text))
                    If TextBox30.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insufficiant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(4) Then
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(5) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(6) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(7) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                    Exit Sub
                ElseIf inpt = a(8) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    TextBox30.Visible = True
                    Label2.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    If TextBox30.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(9) Then
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    inpt1 = Val(UCase(TextBox30.Text))
                    If TextBox30.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(10) Then
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    inpt1 = Val(UCase(TextBox30.Text))

                    If TextBox30.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid instruction ")
                    Exit Sub
                ElseIf inpt = a(11) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(12) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    inpt1 = UCase(Val(TextBox30.Text))
                    If TextBox30.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.YesNoCancel)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(13) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(14) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(15) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(15) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(16) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(17) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(18) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(19) Then
                    GroupBox5.Visible = False
                    t15.Visible = True
                    t14.Visible = True
                    Label18.Visible = True
                    t16.Visible = True
                    Label19.Visible = True
                    Label20.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(20) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf inpt = a(21) Then
                    GroupBox5.Visible = False
                    TextBox31.Visible = True
                    TextBox32.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                        End If
                    Else
                        MsgBox("Given instruction is correct,but insufficiant operand", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf inpt = a(22) Then
                    GroupBox5.Visible = False
                    TextBox32.Visible = True
                    TextBox31.Visible = True
                    TextBox30.Visible = True
                    Label2.Visible = True
                    Label3.Visible = True
                    Label4.Visible = True
                    inpt1 = Val(UCase(TextBox30.Text))
                    inpt2 = Val(UCase(TextBox32.Text))
                    If TextBox30.Text <> "" And TextBox32.Text <> "" Then
                        op = op + 1
                        If inpt1 <> "" And inpt2 <> "" Then
                            MsgBox("The given istruction is correct")
                            flag = False
                        Else
                            MsgBox("Invalid instruction ")
                        End If
                    Else
                        MsgBox("Insuffeciant operand")
                    End If
                    Exit Sub
                ElseIf (inpt = "") Then
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                ElseIf a2.Contains(inpt) Then
                    GroupBox5.Visible = False
                    TextBox30.Visible = False
                    Label2.Visible = False
                    TextBox31.Visible = False
                    TextBox32.Visible = False
                    Label3.Visible = False
                    Label4.Visible = False
                    MsgBox("The given istruction is correct", MsgBoxStyle.Information, "confermation")
                Else
                    MsgBox("Invalid,Cannot proceed further ", MsgBoxStyle.OkOnly)
                    Exit Sub
                End If
            End If
        Else
            MsgBox("Invalid instruction")
            TextBox29.Text = ""
            TextBox29.Focus()
        End If
    End Sub
    Function implct_add(Optional ByVal state As Integer = 0) As Integer
        inpt1 = UCase(TextBox30.Text)
        inpt2 = UCase(TextBox32.Text)
        If TextBox29.Text.Length = 3 Then
            If TextBox29.Text.ToUpper = "STC" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t16.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLC" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t16.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STP" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t14.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLP" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t14.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STA" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t12.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLA" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t12.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STZ" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t10.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLZ" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t10.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STS" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False

                t9.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLS" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t9.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STT" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False

                t8.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLT" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t8.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STI" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False

                t7.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLI" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False

                t7.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STD" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t6.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLD" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False

                t6.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "STO" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False
                t5.Text = "1"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CLO" Then
                TextBox30.Visible = False
                Label2.Visible = False
                TextBox31.Visible = False
                TextBox32.Visible = False
                Label3.Visible = False
                Label4.Visible = False

                t5.Text = "0"
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CBW" Then
                CBW()
                Return 1
            ElseIf TextBox29.Text.ToUpper = "CWD" Then
                CWD()
                Return 1
            End If
        Else
            If state = 0 Then
                MsgBox("Invalid")
            End If
            Return 0
        End If
    End Function
    Sub CBW()
        Dim v1 As String = InputBox("Enter the value for AL register" + AL.Text)
        MsgBox(v1)
        AL.Text = v1
        Dim v2 As String = v1.ToUpper.Substring(0, 2)
        Dim v3 As Long = hex_to_dec(v2)
        If v3 < 128 Then
            AH.Text = "00H"
        ElseIf v3 >= 128 Then
            AH.Text = "FFH"
        End If
    End Sub
    Sub CWD()
        Dim v1 As String = InputBox("Enter the value for AH register")
        MsgBox(v1)
        Dim v2 As String = InputBox("Enter the value for AL  register")
        MsgBox(v2)
        AL.Text = v2
        AH.Text = v1
        Dim v3 As String = v1 + v2
        MsgBox(v3)
        Dim v4 As Long = hex_to_dec(v3)
        If v4 < 32768 Then
            DH.Text = "00"
            DL.Text = "00H"
        ElseIf v4 >= 32768 Then
            DH.Text = "FF"
            DL.Text = "FFH"
        End If
    End Sub
    Function reg1_add(ByVal p1 As String, Optional ByVal state As Integer = 0) As String
        Dim inp1, inp As String
        inp = UCase(TextBox29.Text.Trim.ToUpper)
        inp1 = p1.ToUpper
        If b.Contains(TextBox30.Text.Trim.ToUpper) Or c.Contains(TextBox30.Text.Trim.ToUpper) Then
            If inp = a(3) Or inp = a(4) Then
                If b.Contains(inp1.Substring(0, 2)) And b(0).ToUpper <> inp1.Trim.ToUpper Then
                    If state = 0 Then
                        MsgBox("valid")
                    End If
                    Return 1
                ElseIf c.Contains(inp1.Substring(0, 2)) And c(0).ToUpper <> inp1.Trim.ToUpper And c(1).ToUpper <> inp1.Trim.ToUpper Then
                    If state = 0 Then
                        MsgBox("Valid 56")
                    End If
                    Return 1
                Else
                    If state = 0 Then
                        MsgBox("invalid1")
                    End If
                    Return 0
                End If
            ElseIf inp = a(8) Or inp = a(9) Or inp = a(10) Or inp = a(12) Then
                If b.Contains(inp1.Substring(0, 2)) Then
                    If state = 0 Then
                        MsgBox("valid")
                    End If
                    Return 1
                ElseIf c.Contains(inp1.Substring(0, 2)) Then
                    If state = 0 Then
                        MsgBox("Valid 56")
                    End If
                    Return 1
                Else
                    If state = 0 Then
                        MsgBox("invalid1")
                    End If
                    Return 0
                End If
            Else
                If state = 0 Then
                    MsgBox("Inavlid")
                End If
                Return 0
            End If
        Else

            If state = 0 Then
                MsgBox("Valid")
            End If
            Return 1
        End If
    End Function
    Function rgster_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim inp, inp2, inp1 As String
        inp = UCase(TextBox29.Text)
        inp1 = p1
        inp2 = p2
        If b.Contains(inp1) Or c.Contains(inp1) Then
            If p2.Length = 2 Then
                If inp = a(0) Or inp = a(1) Or inp = a(2) Or inp = a(3) Or inp = a(4) Or inp = a(5) Or inp = a(6) Or inp = a(7) Or inp = a(11) Or inp = a(14) Or inp = a(13) Or inp = a(21) Or inp = a(22) Then
                    'MsgBox(b.Contains(inp2.Substring(0, 2)) And b.Contains(inp1.Substring(0, 2)) And inp1.ToUpper <> inp2.ToUpper)

                    If b.Contains(inp2.Substring(0, 2)) And b.Contains(inp1.Substring(0, 2)) And inp1.ToUpper.Trim <> inp2.ToUpper.Trim Then
                        If state = 0 Then
                            MsgBox("valid")
                        End If
                        Return 1
                    ElseIf c.Contains(inp2.Substring(0, 2)) And c.Contains(inp1.Substring(0, 2)) And inp1.ToUpper.Trim <> inp2.ToUpper.Trim Then
                        If state = 0 Then
                            MsgBox("valid")
                        End If
                        Return 1
                    Else
                        If state = 0 Then
                            MsgBox("Invalid")
                        End If
                        Return 0
                    End If
                Else
                    If state = 0 Then
                        MsgBox("Invalid")
                    End If
                    Return 0
                End If
            Else
                If state = 0 Then
                    MsgBox("Invalid")
                End If
                Return 0
            End If
        Else
            If p2.Length = 2 Then
                If state = 0 Then
                    MsgBox("valid")
                End If
                Return 1
            Else
                If state = 0 Then
                    MsgBox("Invalid")
                End If
                Return 0
            End If
        End If

    End Function  
    Function drct_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
       
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp1, inp2, inp As String
        Dim chh As Integer
        chh = Len(p2)
        Dim v As Boolean = True
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        inp1 = p1
        inp2 = p2
        If p2.Length <= 7 And p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") Then
            If inp1 = a1(0) Or inp1 = a2(1) Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(3) = "H" Or p2.Trim.ElementAt(3) = "h" Then
                    Return 1
                End If
                If p2.Length <= 7 And p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(4) = "H" Or p2.Trim.ElementAt(4) = "h" Or p2.Trim.ElementAt(5) = "H" Or p2.Trim.ElementAt(5) = "h" Then
                    Dim ch0 As Char = p2.Trim.ElementAt(1)
                    Dim ch1 As Char = p2.Trim.ElementAt(2)
                    Dim ch2 As Char = p2.Trim.ElementAt(3)
                    Dim ch3 As Char = p2.Trim.ElementAt(4)
                    If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or Char.IsDigit(ch2) Or Char.IsDigit(ch3) Then
                        Return 1
                    End If
                End If
            End If
        End If
        
    End Function
    Function drct_add3(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        'Dim a1() As String = New String() {"MOV", "ADD", "SUB", "MUL", "DIV", "AND", "OR", "XCHG", "ADC"}

        Dim inp1, inp2, inp As String
        Dim chh As Integer
        inp = UCase(TextBox29.Text)
        inp1 = p1
        inp2 = p2
        chh = Len(p2)
        Dim v As Boolean = True

        If b.Contains(TextBox30.Text.Trim.ToUpper) Or c.Contains(TextBox30.Text.Trim.ToUpper) Then
            If a.Contains(TextBox29.Text.Trim.ToUpper) Then
                If chh = 7 Then
                    If b.Contains(TextBox30.Text.Trim.ToUpper) Then

                        If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And (p2.Trim.ElementAt(5) = "H" Or p2.Trim.ElementAt(5) = "h") Then
                            Dim ch0 As Char = p2.Trim.ElementAt(1)
                            Dim ch1 As Char = p2.Trim.ElementAt(2)
                            Dim ch2 As Char = p2.Trim.ElementAt(3)
                            Dim ch3 As Char = p2.Trim.ElementAt(4)
                            If Char.IsDigit(ch0) Or (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then

                            Else
                                v = False
                                If state = 0 Then
                                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 0
                            End If
                            If Char.IsDigit(ch1) Or (ch1 >= "A" And ch1 <= "F") Or (ch1 >= "a" And ch1 <= "f") Then

                            Else
                                v = False
                                If state = 0 Then
                                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 0
                            End If
                            If Char.IsDigit(ch2) Or (ch2 >= "A" And ch2 <= "F") Or (ch2 >= "a" And ch2 <= "f") Then
                            Else
                                v = False
                                If state = 0 Then
                                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 0
                            End If
                            If Char.IsDigit(ch3) Or (ch3 >= "A" And ch3 <= "F") Or (ch3 >= "a" And ch3 <= "f") Then
                            Else
                                v = False
                                If state = 0 Then
                                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 0
                            End If
                            If v = True Then
                                If state = 0 Then
                                    MsgBox("valid Entry", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 1
                            End If
                        Else
                            If state = 0 Then
                                MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                            End If
                            Return 0
                        End If
                    Else
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                ElseIf chh = 5 Then
                    If inp1 = c(0) Or inp1 = c(1) Or inp1 = c(2) Or inp1 = c(3) Or inp1 = c(4) Or inp1 = c(5) Or inp1 = c(6) Or inp1 = c(7) Then
                        If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And (p2.Trim.ElementAt(3) = "H" Or p2.Trim.ElementAt(3) = "h") Then
                            Dim ch4 As Char = p2.Trim.ElementAt(1)
                            Dim ch5 As Char = p2.Trim.ElementAt(2)

                            If Char.IsDigit(ch4) Or (ch4 >= "A" And ch4 <= "F") Or (ch4 >= "a" And ch4 <= "f") Then
                                'MsgBox("valid 0")
                            Else
                                v = False
                                If state = 0 Then
                                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 0
                            End If
                            If Char.IsDigit(ch5) Or (ch5 >= "A" And ch5 <= "F") Or (ch5 >= "a" And ch5 <= "f") Then
                                'MsgBox("valid 1")
                            Else
                                v = False
                                If state = 0 Then
                                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 0
                            End If
                            If v = True Then
                                If state = 0 Then
                                    MsgBox("valid Entry", MsgBoxStyle.Information, "Confirmation")
                                End If
                                Return 1
                            End If
                        Else
                            If state = 0 Then
                                MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                            End If
                            Return 0
                        End If

                    Else
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                Else
                    If state = 0 Then
                        MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Return 0
                    Exit Function
                End If
            Else
                If state = 0 Then
                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                End If
                Return 0
            End If
        Else
            If chh = 7 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And (p2.Trim.ElementAt(5) = "H" Or p2.Trim.ElementAt(5) = "h") Then
                    Dim ch0 As Char = p2.Trim.ElementAt(1)
                    Dim ch1 As Char = p2.Trim.ElementAt(2)
                    Dim ch2 As Char = p2.Trim.ElementAt(3)
                    Dim ch3 As Char = p2.Trim.ElementAt(4)
                    If Char.IsDigit(ch0) Or (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then

                    Else
                        v = False
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                    If Char.IsDigit(ch1) Or (ch1 >= "A" And ch1 <= "F") Or (ch1 >= "a" And ch1 <= "f") Then

                    Else
                        v = False
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                    If Char.IsDigit(ch2) Or (ch2 >= "A" And ch2 <= "F") Or (ch2 >= "a" And ch2 <= "f") Then
                    Else
                        v = False
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                    If Char.IsDigit(ch3) Or (ch3 >= "A" And ch3 <= "F") Or (ch3 >= "a" And ch3 <= "f") Then
                    Else
                        v = False
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                    If v = True Then
                        If state = 0 Then
                            MsgBox("valid Entry", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 1
                    End If
                Else
                    If state = 0 Then
                        MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Return 0
                End If
            ElseIf chh = 5 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And (p2.Trim.ElementAt(3) = "H" Or p2.Trim.ElementAt(3) = "h") Then
                    Dim ch4 As Char = p2.Trim.ElementAt(1)
                    Dim ch5 As Char = p2.Trim.ElementAt(2)

                    If Char.IsDigit(ch4) Or (ch4 >= "A" And ch4 <= "F") Or (ch4 >= "a" And ch4 <= "f") Then
                        'MsgBox("valid 0")
                    Else
                        v = False
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                    If Char.IsDigit(ch5) Or (ch5 >= "A" And ch5 <= "F") Or (ch5 >= "a" And ch5 <= "f") Then
                        'MsgBox("valid 1")
                    Else
                        v = False
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If

                    If v = True Then
                        If state = 0 Then
                            MsgBox("valid Entry", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 1
                    End If
                Else
                    If state = 0 Then
                        MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Return 0
                End If

            Else
                If state = 0 Then
                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                End If
                Return 0
            End If
        End If
    End Function
    Function drct_add1(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp1, inp2, inp As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        inp1 = p1
        inp2 = p2
        If p1.Length <= 7 And p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") Then
            If inp2 = a1(0) Or inp2 = a2(1) Then
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Trim.ElementAt(3) = "H" Or p1.Trim.ElementAt(3) = "h" Then
                    Return 1
                End If
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Trim.ElementAt(4) = "H" Or p1.Trim.ElementAt(4) = "h" Or p1.Trim.ElementAt(5) = "H" Or p1.Trim.ElementAt(5) = "h" Then
                    Dim ch0 As Char = p1.Trim.ElementAt(1)
                    Dim ch1 As Char = p1.Trim.ElementAt(2)
                    Dim ch2 As Char = p1.Trim.ElementAt(3)
                    Dim ch3 As Char = p1.Trim.ElementAt(4)
                    If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or Char.IsDigit(ch2) Or Char.IsDigit(ch3) Then
                        Return 1
                    End If
                End If
            End If

        Else
            Return 0
            Exit Function
        End If
    End Function
    Function baseindx_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}

        Dim inpt, inpt1, inpt2 As String
        inpt = UCase(TextBox29.Text)
        inpt1 = UCase(TextBox30.Text)
        inpt2 = UCase(TextBox32.Text)
        p2 = inpt2
        p1 = inpt1
        If b.Contains(TextBox30.Text.Trim.ToUpper) Or c.Contains(TextBox32.Text.Trim.ToUpper) Then

            If p2.Length = 7 Then
                If TextBox32.Text.Trim.StartsWith("[") And TextBox32.Text.Trim.EndsWith("]") And TextBox32.Text.Trim.ElementAt(3) = "+" Or TextBox32.Text.Trim.ElementAt(3) = "-" Then

                    Dim reg As String = p1.ToUpper
                    Dim reg1 As String = p2.ToUpper
                    If b.Contains(reg.Substring(0, 2)) Or c.Contains(reg.Substring(0, 2)) Then
                        If c2.Contains(reg1.Substring(1, 2)) And c1.Contains(reg1.Substring(4, 2)) Then
                        End If
                        Return 1
                    End If
               
                End If
            End If
        Else
            If p2.Length = 7 Then
                If state = 0 Then
                    MsgBox("vaild", MsgBoxStyle.Information, "Confirmation")
                End If
                Return 1
            Else
                If state = 0 Then
                    MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                End If
                Return 0
            End If
        End If
    End Function
    Function baseindx_add1(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}

        Dim inpt, inpt1, inpt2 As String
        inpt = UCase(TextBox29.Text)
        inpt1 = UCase(TextBox30.Text)
        inpt2 = UCase(TextBox32.Text)
        p2 = inpt2
        p1 = inpt1
        If p1.Length = 7 Then
            If TextBox30.Text.Trim.StartsWith("[") And TextBox30.Text.Trim.EndsWith("]") And TextBox30.Text.Trim.ElementAt(3) = "+" Or TextBox30.Text.Trim.ElementAt(3) = "-" Then

                Dim reg As String = p1.ToUpper
                Dim reg1 As String = p2.ToUpper
                If b.Contains(reg1.Substring(0, 2)) Or c.Contains(reg1.Substring(0, 2)) Then
                    If c2.Contains(reg.Substring(1, 2)) And c1.Contains(reg.Substring(4, 2)) Then
                    End If
                    Return 1
                End If
            End If
        End If

    End Function
    Function immdt_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp, inp1, inp2 As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        Dim data As String = p2
        Dim ishex As Boolean = True
        p1 = inp1.Trim.ToUpper
        p2 = inp2.Trim.ToUpper
        'Dim ch0 As Char = p2.Trim.ElementAt(0)
        'Dim ch1 As Char = p2.Trim.ElementAt(1)

        If p2.Length <= 3 And p2.Trim.EndsWith("H") Or p2.Trim.EndsWith("h") Then
            If a2.Contains(inp1) Then
                Dim ch7 As Char = p2.Trim.ElementAt(0)
                Dim ch8 As Char = p2.Trim.ElementAt(1)
                If Char.IsDigit(ch7) Or Char.IsDigit(ch8) Or (ch7 >= "A" And ch7 <= "F") Or (ch7 >= "a" And ch7 <= "f") Or (ch8 >= "A" And ch8 <= "F") Or (ch8 >= "a" And ch8 <= "f") Then
                    Return 1
                End If
            End If
        ElseIf p2.Length = 5 And p2.Trim.EndsWith("H") Or p2.Trim.EndsWith("h") Then
            If a1.Contains(inp1) Then
               
                Dim ch3 As Char = p2.Trim.ElementAt(0)
                Dim ch4 As Char = p2.Trim.ElementAt(1)
                Dim ch5 As Char = p2.Trim.ElementAt(2)
                Dim ch6 As Char = p2.Trim.ElementAt(3)
                If Char.IsDigit(ch3) And Char.IsDigit(ch4) And Char.IsDigit(ch5) And Char.IsDigit(ch6) Or (ch3 >= "A" And ch3 <= "F") Or (ch3 >= "a" And ch3 <= "f") And (ch4 >= "A" And ch4 <= "F") Or (ch4 >= "a" And ch4 <= "f") And (ch5 >= "A" And ch5 <= "F") Or (ch5 >= "a" And ch5 <= "f") And (ch6 >= "A" And ch6 <= "F") Or (ch6 >= "a" And ch6 <= "f") Then
                    Return 1
                End If
            End If
        ElseIf p2.Length <= 3 And p2.Trim.EndsWith("B") Or p2.Trim.EndsWith("b") Then
            If a2.Contains(inp1) Then
                Dim ch7 As Char = p2.Trim.ElementAt(0)
                Dim ch8 As Char = p2.Trim.ElementAt(1)
                If ch7 = "0" Or "1" And ch8 = "0" Or "1" Then
                    Return 1
                End If
            End If
        ElseIf p2.Length = 5 And p2.Trim.EndsWith("B") Or p2.Trim.EndsWith("b") Then
            If a1.Contains(inp1) Then
                Dim ch3 As Char = p2.Trim.ElementAt(0)
                Dim ch4 As Char = p2.Trim.ElementAt(1)
                Dim ch5 As Char = p2.Trim.ElementAt(2)
                Dim ch6 As Char = p2.Trim.ElementAt(3)
                If ch3 = "0" Or "1" And ch4 = "0" Or "1" And ch5 = "0" Or "1" And ch6 = "0" Or "1" Then
                    Return 1
                End If
            End If
        ElseIf p2.Length <= 3 And p2.Trim.EndsWith("D") Or p2.Trim.EndsWith("d") Then
            If a2.Contains(inp1) Then
                Dim ch7 As Char = p2.Trim.ElementAt(0)
                Dim ch8 As Char = p2.Trim.ElementAt(1)
                If Char.IsDigit(ch7) And Char.IsDigit(ch8) Then
                    Return 1
                End If
            End If
        ElseIf p2.Length = 5 And p2.Trim.EndsWith("D") Or p2.Trim.EndsWith("d") Then
            If a1.Contains(inp1) Then
                Dim ch3 As Char = p2.Trim.ElementAt(0)
                Dim ch4 As Char = p2.Trim.ElementAt(1)
                Dim ch5 As Char = p2.Trim.ElementAt(2)
                Dim ch6 As Char = p2.Trim.ElementAt(3)
                If Char.IsDigit(ch3) And Char.IsDigit(ch4) And Char.IsDigit(ch5) And Char.IsDigit(ch6) Then
                    Return 1
                End If
            End If
        Else
            Return 0
        End If
    End Function
    Function regindct_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer

        Dim c3() As String = New String() {"BX", "SI", "DI", "BP", "SP"}
        If b.Contains(TextBox30.Text.Trim.ToUpper) Or c.Contains(TextBox30.Text.Trim.ToUpper) Then

            If p2.Length = 4 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Length = 4 Then
                    Dim reg As String = p2.Substring(1, 2).ToUpper
                    Dim reg1 As String = p1.ToUpper
                    Dim v As Boolean = True
                    If c3.Contains(reg) And reg1.ToUpper <> reg And b.Contains(reg1) Then
                        If state = 0 Then
                            MsgBox("vaild")
                        End If
                        Return 1
                    ElseIf c3.Contains(reg) And reg1.ToUpper <> reg And c.Contains(reg1) Then
                        If state = 0 Then
                            MsgBox("vaild")
                        End If
                        Return 1
                    Else
                        If state = 0 Then
                            MsgBox("invaild")
                        End If
                        Return 0
                    End If
                End If
            Else
                If state = 0 Then
                    MsgBox("invaild")
                End If
                Return 0
            End If
        Else
            If p2.Length = 4 Then
                If state = 0 Then
                    MsgBox("vaild")
                End If
                Return 1
            Else
                If state = 0 Then
                    MsgBox("invaild")
                End If
                Return 0
            End If
        End If
    End Function
    Function regindct_add1(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c3() As String = New String() {"BX", "SI", "DI", "BP", "SP"}
        If b.Contains(TextBox32.Text.Trim.ToUpper) Or c.Contains(TextBox32.Text.Trim.ToUpper) Then
            If p1.Length = 4 Then
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Length = 4 Then
                    Dim reg As String = p1.Substring(1, 2).ToUpper
                    Dim reg1 As String = p2.ToUpper
                    Dim v As Boolean = True
                    If c3.Contains(reg) And reg1.ToUpper <> reg And b.Contains(reg1) Then
                        If state = 0 Then
                            MsgBox("vaild")
                        End If
                        Return 1
                    ElseIf c3.Contains(reg) And reg1.ToUpper <> reg And c.Contains(reg1) Then
                        If state = 0 Then
                            MsgBox("vaild")
                        End If
                        Return 1
                    Else
                        If state = 0 Then
                            MsgBox("invaild")
                        End If
                        Return 0
                    End If
                End If
            Else
                If state = 0 Then
                    MsgBox("invaild")
                End If
                Return 0
            End If
        End If
    End Function

    Function regstrrltv_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp, inp1, inp2 As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        p1 = inp1.Trim.ToUpper
        p2 = inp2.Trim.ToUpper
        If a1.Contains(inp1) Then
            If p2.Length > 5 And p2.Length <= 10 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(p2.Trim.Length() - 2) = "h" Or p2.Trim.ElementAt(p2.Trim.Length() - 2) = "H" And p2.Trim.ElementAt(3) = "+" Or p2.Trim.ElementAt(3) = "-" Then
                    If c2.Contains(p2.Substring(1, 2)) Or c1.Contains(p2.Substring(1, 2)) Then
                        Dim ch0 As Char = p2.Trim.ElementAt(4)
                        Dim ch1 As Char = p2.Trim.ElementAt(5)
                        Dim ch2 As Char = p2.Trim.ElementAt(6)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or Char.IsDigit(ch2) Then
                            'Or (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then
                            Return 1
                        End If
                    End If
                End If
            End If
            Exit Function
        ElseIf a2.Contains(inp1) Then
            If p2.Length > 5 And p2.Length <= 10 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(p2.Trim.Length() - 2) = "h" Or p2.Trim.ElementAt(p2.Trim.Length() - 2) = "H" And p2.Trim.ElementAt(3) = "+" Or p2.Trim.ElementAt(3) = "-" Then
                    If c2.Contains(p2.Substring(1, 2)) Or c1.Contains(p2.Substring(1, 2)) Then
                        Dim ch0 As Char = p2.Trim.ElementAt(4)
                        Dim ch1 As Char = p2.Trim.ElementAt(5)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Then
                            'Or (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then
                            Return 1
                        End If
                    End If
                End If
            End If
            Exit Function
        Else
            If p2.Length > 8 And p2.Length <= 13 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(p2.Trim.Length() - 2) = "h" Or p2.Trim.ElementAt(p2.Trim.Length() - 2) = "H" And p2.Trim.ElementAt(3) = "+" Or p2.Trim.ElementAt(3) = "-" And p2.Trim.ElementAt(6) = "+" Or p2.Trim.ElementAt(6) = "-" Then
                    Dim reg2 As String = p2.ToUpper
                    If c2.Contains(reg2.Substring(1, 2)) And c1.Contains(reg2.Substring(4, 2)) Then
                        Dim str As String = reg2.Substring(7, reg2.Length - 9)
                        Dim count As Integer = 0
                        For i As Integer = 0 To str.Length - 1
                            If f1.Contains(str.Substring(i, 1)) Then
                                count = count + 1
                            End If
                        Next
                        If count = str.Length Then
                            If state = 0 Then
                                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                            End If
                            Return 1
                        Else
                            If state = 0 Then
                                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                            End If
                            Return 0
                        End If
                    Else
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                Else
                    If state = 0 Then
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Return 0
                End If
            Else
                If state = 0 Then
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                End If
                Return 0
            End If
        End If
        Return 0
    End Function
    Function regstrrltv_add1(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp, inp1, inp2 As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        p1 = inp1.Trim.ToUpper
        p2 = inp2.Trim.ToUpper
        If a1.Contains(inp2) Then
            If p1.Length > 5 And p1.Length <= 10 Then
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Trim.ElementAt(p1.Trim.Length() - 2) = "h" Or p1.Trim.ElementAt(p1.Trim.Length() - 2) = "H" And p1.Trim.ElementAt(3) = "+" Or p1.Trim.ElementAt(3) = "-" Then
                    If c2.Contains(p1.Substring(1, 2)) Or c1.Contains(p1.Substring(1, 2)) Then
                        Dim ch0 As Char = p1.Trim.ElementAt(4)
                        Dim ch1 As Char = p1.Trim.ElementAt(5)
                        Dim ch2 As Char = p1.Trim.ElementAt(6)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or Char.IsDigit(ch2) Then
                            '(ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then
                            Return 1
                        End If
                    End If
                End If
            End If
            Exit Function
        ElseIf a2.Contains(inp2) Then
            If p1.Length > 5 And p1.Length <= 10 Then
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Trim.ElementAt(p1.Trim.Length() - 2) = "h" Or p1.Trim.ElementAt(p1.Trim.Length() - 2) = "H" And p1.Trim.ElementAt(3) = "+" Or p1.Trim.ElementAt(3) = "-" Then
                    If c2.Contains(p1.Substring(1, 2)) Or c1.Contains(p1.Substring(1, 2)) Then
                        Dim ch0 As Char = p1.Trim.ElementAt(4)
                        Dim ch1 As Char = p1.Trim.ElementAt(5)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Then
                            ' (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then
                            Return 1

                        End If
                        Exit Function
                    End If
                End If
            End If
        Else
            Return 0
        End If
    End Function
    Function rltvbasdindx_add(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp, inp1, inp2 As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        p1 = inp1.Trim.ToUpper
        p2 = inp2.Trim.ToUpper
        If a1.Contains(inp1) Then
            If p2.Length > 8 And p2.Length <= 14 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(p2.Trim.Length() - 2) = "h" Or p2.Trim.ElementAt(p2.Trim.Length() - 2) = "H" And p2.Trim.ElementAt(3) = "+" Or p2.Trim.ElementAt(3) = "-" And p2.Trim.ElementAt(6) = "+" Or p2.Trim.ElementAt(6) = "-" Then
                    If c2.Contains(p2.Substring(1, 2)) And c1.Contains(p2.Substring(4, 2)) Then
                        Dim ch0 As Char = p2.Trim.ElementAt(7)
                        Dim ch1 As Char = p2.Trim.ElementAt(8)
                        Dim ch2 As Char = p2.Trim.ElementAt(9)
                        Dim ch3 As Char = p2.Trim.ElementAt(10)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or Char.IsDigit(ch2) Or Char.IsDigit(ch3) Or (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Or (ch1 >= "A" And ch1 <= "F") Or (ch1 >= "a" And ch1 <= "f") Or (ch2 >= "A" And ch2 <= "F") Or (ch2 >= "a" And ch2 <= "f") Or (ch3 >= "A" And ch3 <= "F") Or (ch3 >= "a" And ch3 <= "f") Then
                            Return 1

                        End If
                    End If
                End If
            End If
            Exit Function
        ElseIf a2.Contains(inp1) Then
            If p2.Length > 8 And p2.Length <= 12 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(p2.Trim.Length() - 2) = "h" Or p2.Trim.ElementAt(p2.Trim.Length() - 2) = "H" And p2.Trim.ElementAt(3) = "+" Or p2.Trim.ElementAt(3) = "-" And p2.Trim.ElementAt(6) = "+" Or p2.Trim.ElementAt(6) = "-" Then
                    If c2.Contains(p2.Substring(1, 2)) And c1.Contains(p2.Substring(4, 2)) Then
                        Dim ch0 As Char = p2.Trim.ElementAt(7)
                        Dim ch1 As Char = p2.Trim.ElementAt(8)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or (ch0 >= "A" And ch1 <= "F") Or (ch0 >= "a" And ch1 <= "f") Then
                            Return 1
                        End If
                        Exit Function
                    End If
                End If
            End If
        Else
            If p2.Length > 8 And p2.Length <= 13 Then
                If p2.Trim.StartsWith("[") And p2.Trim.EndsWith("]") And p2.Trim.ElementAt(p2.Trim.Length() - 2) = "h" Or p2.Trim.ElementAt(p2.Trim.Length() - 2) = "H" And p2.Trim.ElementAt(3) = "+" Or p2.Trim.ElementAt(3) = "-" And p2.Trim.ElementAt(6) = "+" Or p2.Trim.ElementAt(6) = "-" Then
                    Dim reg2 As String = p2.ToUpper
                    If c2.Contains(reg2.Substring(1, 2)) And c1.Contains(reg2.Substring(4, 2)) Then
                        Dim str As String = reg2.Substring(7, reg2.Length - 9)
                        Dim count As Integer = 0
                        For i As Integer = 0 To str.Length - 1
                            If f1.Contains(str.Substring(i, 1)) Then
                                count = count + 1
                            End If
                        Next
                        If count = str.Length Then
                            If state = 0 Then
                                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                            End If
                            Return 1
                        Else
                            If state = 0 Then
                                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                            End If
                            Return 0
                        End If
                    Else
                        If state = 0 Then
                            MsgBox("invalid", MsgBoxStyle.Information, "Confirmation")
                        End If
                        Return 0
                    End If
                Else
                    If state = 0 Then
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    End If
                    Return 0
                End If
            Else
                If state = 0 Then
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                End If
                Return 0
            End If
        End If

        Return 0
    End Function
    Function rltvbasdindx_add1(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim c2() As String = New String() {"BX", "BP", "SP"}
        Dim c1() As String = New String() {"SI", "DI"}
        Dim f1() As String = New String() {"A", "B", "C", "D", "E", "F", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
        Dim a1() As String = New String() {"AX", "BX", "CX", "DX", "SI", "DI", "SP", "BP"}
        Dim a2() As String = New String() {"AH", "AL", "BH", "BL", "CH", "CL", "DH", "DL"}
        Dim inp, inp1, inp2 As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        p1 = inp1.Trim.ToUpper
        p2 = inp2.Trim.ToUpper
        If a1.Contains(inp2) Then
            If p1.Length > 8 And p1.Length <= 13 Then
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Trim.ElementAt(p1.Trim.Length() - 2) = "h" Or p1.Trim.ElementAt(p1.Trim.Length() - 2) = "H" And p1.Trim.ElementAt(3) = "+" Or p1.Trim.ElementAt(3) = "-" And p1.Trim.ElementAt(6) = "+" Or p1.Trim.ElementAt(6) = "-" Then
                    If c2.Contains(p1.Substring(1, 2)) And c1.Contains(p1.Substring(4, 2)) Then
                        Dim ch0 As Char = p1.Trim.ElementAt(7)
                        Dim ch1 As Char = p1.Trim.ElementAt(8)
                        Dim ch2 As Char = p1.Trim.ElementAt(9)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or Char.IsDigit(ch2) Or (ch0 >= "A" And ch0 <= "F") Or (ch0 >= "a" And ch0 <= "f") Then
                            Return 1

                        End If
                    End If
                End If
            End If
            Exit Function
        ElseIf a2.Contains(inp2) Then
            If p1.Length > 8 And p1.Length <= 12 Then
                If p1.Trim.StartsWith("[") And p1.Trim.EndsWith("]") And p1.Trim.ElementAt(p1.Trim.Length() - 2) = "h" Or p1.Trim.ElementAt(p1.Trim.Length() - 2) = "H" And p1.Trim.ElementAt(3) = "+" Or p1.Trim.ElementAt(3) = "-" And p1.Trim.ElementAt(6) = "+" Or p1.Trim.ElementAt(6) = "-" Then
                    If c2.Contains(p1.Substring(1, 2)) And c1.Contains(p1.Substring(4, 2)) Then
                        Dim ch0 As Char = p1.Trim.ElementAt(7)
                        Dim ch1 As Char = p1.Trim.ElementAt(8)
                        If Char.IsDigit(ch0) Or Char.IsDigit(ch1) Or (ch0 >= "A" And ch1 <= "F") Or (ch0 >= "a" And ch1 <= "f") Then
                            Return 1
                        End If
                        Exit Function
                    End If
                End If
            End If
        Else
            Return 0
        End If
    End Function
    Function shftrtr(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim inp1, inp As String
        inp = UCase(TextBox29.Text.Trim.ToUpper)
        inp1 = p1.ToUpper
        inpt2 = p2.ToUpper
        If inp = a(15) Or inp = a(16) Or inp = a(17) Or inp = a(18) Or inp = a(19) Or inp = a(20) Then
            If c.Contains(inp1) Or b.Contains(inp1) Then
                If inpt2 = "cl" Or inpt2 = "CL" Then
                    If state = 0 Then
                        MsgBox("valid")
                    End If
                    Return 1
                Else
                    If state = 0 Then
                        MsgBox("invalid1")
                    End If
                    Return 0
                End If
            Else
                If state = 0 Then
                    MsgBox("invalid1")
                End If
                Return 0
            End If
        Else
            If state = 0 Then
                MsgBox("invalid1")
            End If
            Return 0
        End If
    End Function
    Function shftrtr1(ByVal p1 As String, ByVal p2 As String, Optional ByVal state As Integer = 0) As Integer
        Dim inp1, inp As String
        inp = UCase(TextBox29.Text.Trim.ToUpper)
        inp1 = p1.ToUpper
        inpt2 = p2.ToUpper
        If inp = a(15) Or inp = a(16) Or inp = a(17) Or inp = a(18) Or inp = a(19) Or inp = a(20) Then
            If c.Contains(inp1) Or b.Contains(inp1) Then
                If IsNumeric(inpt2) Then
                    If state = 0 Then
                        MsgBox("valid")
                    End If
                    Return 1
                Else
                    If state = 0 Then
                        MsgBox("invalid1")
                    End If
                    Return 0
                End If
            Else
                If state = 0 Then
                    MsgBox("invalid1")
                End If
                Return 0
            End If
        Else
            If state = 0 Then
                MsgBox("invalid1")
            End If
            Return 0
        End If
    End Function
    Function dec_to_bin() As Integer
        Dim dec As Integer = Val(t16.Text)

        Dim ss As String = Convert.ToString(dec, 2)
        If dec = 0 Or dec = 1 Then
            ss = "000" + ss
        ElseIf dec = 2 Or dec = 3 Then
            ss = "00" + ss
        ElseIf dec >= 4 And dec <= 7 Then
            ss = "0" + ss
        End If
        Return (ss)
    End Function
    Function bin_to_dec(ByVal s1 As String) As String
        Dim decval As String
        Dim pwrOf2 As Integer = 0
        Dim ans As Long = 0L

        If Long.TryParse(s1, Nothing) Then

            For Each n As Char In s1.Reverse
                Select Case n
                    Case Is = "0"c
                    Case Is = "1"c
                        ans += 1L << pwrOf2
                    Case Else

                        Stop
                End Select
                pwrOf2 += 1
            Next

        Else

        End If
        decval = ans.ToString("n0")
        Return (decval)
    End Function
    Function hex_to_dec(ByVal s1 As String) As Integer
        Dim lngOut As Long
        Dim i As Integer
        Dim c As Integer
        Dim HexNum As String = s1
        For i = 1 To Len(HexNum)
            c = Asc(UCase(Mid(HexNum, i, 1)))
            Select Case c
                Case 65 To 70
                    lngOut = lngOut + ((c - 55) * 16 ^ (Len(HexNum) - i))
                Case 48 To 57
                    lngOut = lngOut + ((c - 48) * 16 ^ (Len(HexNum) - i))
                Case Else

                    MsgBox("Invalid hexadecimal Number", MsgBoxStyle.Information, "COnfermation")
                    Exit Function
            End Select
        Next i
        Dim H_to_D As Long = lngOut
        Return (H_to_D)
    End Function
    Function hexa(ByVal s3 As String) As String
        Dim v2 As String = s3
        Dim v1 As String = Hex(v2)
        If v1.Length = 1 Then
            v1 = "000" + v1
        ElseIf v1.Length = 2 Then
            v1 = "00" + v1
        ElseIf v1.Length = 3 Then
            v1 = "0" + v1
        End If
        Return (v1)
    End Function
    Function hex8(ByVal s3 As String) As String
        Dim v2 As String = s3
        Dim v1 As String = Hex(v2)
        If v1.Length = 1 Then
            v1 = "0" + v1

        End If
        Return (v1)
    End Function
    Function hex_to_bin(ByVal s2 As String) As String
        Dim s1 As String = s2
        Dim s As String = s2
        Dim i As Integer = Convert.ToInt32(s, 16)
        s = Convert.ToString(i, 2)
        If s1.StartsWith("1") Then
            s = "000" + s
        ElseIf s1.StartsWith("2") Or s1.StartsWith("3") Then
            s = "00" + s
        ElseIf s1.StartsWith("4") Or s1.StartsWith("5") Or s1.StartsWith("6") Or s1.StartsWith("7") Then
            s = "0" + s
        End If
        Return (s.ToString)
    End Function
    Function hex_to_bin1(ByVal s2 As String) As String
        Dim s1 As String = s2
        Dim s As String = s2
        Dim i As Integer = Convert.ToInt64(s, 16)
        s = Convert.ToString(i, 2)
        If s1.StartsWith("1") Then
            s = "000" + s
        ElseIf s1.StartsWith("2") Or s1.StartsWith("3") Then
            s = "00" + s
        ElseIf s1.StartsWith("4") Or s1.StartsWith("5") Or s1.StartsWith("6") Or s1.StartsWith("7") Then
            s = "0" + s
        End If
        Return (s.ToString)
    End Function
    Function matchingaddress(ByVal inpt1 As String, ByVal inpt2 As String) As String
        inpt1 = TextBox30.Text.Trim.ToUpper
        inpt2 = TextBox32.Text.Trim.ToUpper
        If TextBox29.Text.Trim.Trim.ToUpper = a(15) Or TextBox29.Text.Trim.Trim.ToUpper = a(16) Or TextBox29.Text.Trim.Trim.ToUpper = a(17) Or TextBox29.Text.Trim.Trim.ToUpper = a(18) Or TextBox29.Text.Trim.Trim.ToUpper = a(19) Or TextBox29.Text.Trim.Trim.ToUpper = a(20) Then
            If (shftrtr(inpt1, inpt2, 1) = 1) Then
                Return ("Register Addressing Mode")
                Exit Function
            ElseIf (shftrtr1(inpt1, inpt2, 1) = 1) Then
                Return ("Immediate Addressing Mode")
                Exit Function
            End If
        Else
            If (implct_add(1) = 1) Then
                Return ("Implicit Addressing Mode")
                Exit Function
            End If
            If (regindct_add(inpt1, inpt2, 1) = 1) Then
                Return ("Register Indirect Addressing Mode")
                Exit Function
            End If
            If (regindct_add1(inpt1, inpt2, 1) = 1) Then
                Return ("Register Indirect Addressing Mode")
                Exit Function
            End If
            If (drct_add(inpt1, inpt2, 1) = 1) Then
                Return ("Direct Addressing Mode")
                Exit Function
            End If
            If (drct_add1(inpt1, inpt2, 1) = 1) Then
                Return ("Direct Addressing Mode")
                Exit Function
            End If
            If (immdt_add(inpt1, inpt2, 1) = 1) Then
                Return ("Immediate Addressing Mode")
                Exit Function
            End If
            If (baseindx_add(inpt1, inpt2, 1) = 1) Then
                Return ("Base Index Addressing Mode")
                Exit Function
            End If
            If (baseindx_add1(inpt1, inpt2, 1) = 1) Then
                Return ("Base Index Addressing Mode")
                Exit Function
            End If
            If (regstrrltv_add(inpt1, inpt2, 1) = 1) Then
                Return ("Register Relative Addressing Mode")
                Exit Function
            End If
            If (regstrrltv_add1(inpt1, inpt2, 1) = 1) Then
                Return ("Register Relative Addressing Mode")
                Exit Function
            End If
            If (rltvbasdindx_add(inpt1, inpt2, 1) = 1) Then
                Return (" Relative Based Indexed Addressing Mode")
                Exit Function
            End If
            If (rltvbasdindx_add1(inpt1, inpt2, 1) = 1) Then
                Return (" Relative Based Indexed Addressing Mode")
                Exit Function
            End If
            If (rgster_add(inpt1, inpt2, 1) = 1) Then
                Return ("Register Addressing Mode")
                Exit Function
            End If
            If (implct_add(1) = 1) Then
                Return ("Implicit Addressing Mode")
                Exit Function
            End If
            If (reg1_add(inpt1, 1) = 1) Then
                Return ("Register addressing mode for MUL,DIV,INC,DEC,NOT,NEG")
                Exit Function
            End If
        End If
        Return ("Invalid Addressing Mode")
    End Function

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        Dim inpt, inpt1, inpt2 As String
        inpt = UCase(TextBox29.Text)
        inpt1 = UCase(TextBox30.Text)
        inpt2 = UCase(TextBox32.Text)
        
        If b.Contains(inpt1) Or c.Contains(inpt1) Or (inpt1 = "" And inpt2 = "") Then
            Dim str As String = matchingaddress(inpt1, inpt2)
            MsgBox(str)
        ElseIf b.Contains(inpt2) Or c.Contains(inpt2) Then
            Dim str As String = matchingaddress(inpt1, inpt2)
            MsgBox(str)
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'MsgBox("Register Addressing Mode")
            GroupBox5.Visible = True
            TextBox35.Text = TextBox30.Text
        End If


    End Sub

    Private Sub TextBox1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox29.KeyDown

    End Sub

    Private Sub TextBox1_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles TextBox29.Leave
        If TextBox29.Text = "MUL" Or TextBox29.Text = "mul" Then
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
        If TextBox29.Text = "DIV" Or TextBox29.Text = "div" Then
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
        If TextBox29.Text = "INC" Or TextBox29.Text = "inc" Then
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
        If TextBox29.Text = "DEC" Or TextBox29.Text = "dec" Then
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
        If TextBox29.Text = "NOT" Or TextBox29.Text = "not" Then
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
        If TextBox29.Text = "NEG" Or TextBox29.Text = "neg" Then
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
        If a2.Contains(TextBox29.Text.ToUpper) Then
            TextBox30.Visible = False
            Label2.Visible = False
            TextBox31.Visible = False
            TextBox32.Visible = False
            Label3.Visible = False
            Label4.Visible = False
        End If
    End Sub

    Private Sub TextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox29.TextChanged

        TextBox30.Visible = True
        Label2.Visible = True
        TextBox31.Visible = True
        TextBox32.Visible = True
        Label3.Visible = True
        Label4.Visible = True

    End Sub

    Private Sub Form2_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        Control.CheckForIllegalCrossThreadCalls = False
        op = 0
        TextBox31.Text = ","
        GroupBox5.Visible = False
        DataGridView1.Columns.Add("Memory", "memory value")
        DataGridView1.Columns.Add("value123", "value")
        For i As Integer = 0 To 65536
            DataGridView1.Rows.Add()
            DataGridView1.RowHeadersVisible = False
            DataGridView1.Item(0, i).Value = Hex(i)
            DataGridView1.Item(1, i).Value = "00"
        Next
        DataGridView1.Columns(0).ReadOnly = True
        DataGridView1.SelectionMode = DataGridViewSelectionMode.FullRowSelect
        DataGridView1.BorderStyle = BorderStyle.Fixed3D
        DataGridView1.BackgroundColor = Color.White
        DataGridView1.RowsDefaultCellStyle.BackColor = Color.White
        DataGridView1.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke

    End Sub

    Sub cmpflagsetting(ByVal s1 As Long, ByVal s2 As Long)
        If s1 > s2 Then
            t16.Text = "0"
            t10.Text = "0"
            t9.Text = "0"
        ElseIf s1 < s2 Then
            t16.Text = "1"
            t10.Text = "0"
            t9.Text = "1"
        ElseIf s1 = s2 Then
            t16.Text = "0"
            t10.Text = "1"
            t9.Text = "0"
        Else
            MsgBox("Invalid")
        End If

    End Sub
    Sub andflagsetting(ByVal hexvalue As String)
        Dim binValue As String = hex_to_bin(hexvalue)
        If binValue.Length > 16 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        't12.Text = CheckAux()
        MsgBox(binValue.Length)
        OverFlow()
    End Sub
    Sub testflagsetting8(ByVal hexvalue As String)
        Dim binValue As String = hex_to_bin(hexvalue)
        If binValue.Length > 8 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Sub testflagsetting(ByVal hexvalue As String)
        Dim binValue As String = hex_to_bin(hexvalue)
        MsgBox(binValue)
        If binValue.Length > 16 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        't12.Text = CheckAux()
        MsgBox(binValue.Length)
    End Sub
    Sub orflagsetting(ByVal hexvalue As String)
        Dim binValue As String = hex_to_bin(hexvalue)
        If binValue.Length > 16 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Sub orflagsetting8(ByVal hexvalue As String)
        Dim binValue As String = hex_to_bin(hexvalue)
        If binValue.Length > 8 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Sub andflagsetting8(ByVal hexvalue As String)
        Dim binValue As String = hex_to_bin(hexvalue)
        If binValue.Length > 8 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow8()

    End Sub
    Sub AddFlagSetting(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        If binValue.Length > 16 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow()
        MsgBox(binValue.Length)
    End Sub
    Sub negflagsetting(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        If binValue.Length > 16 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If

        MsgBox(binValue.Length)
    End Sub
    Sub negflagsetting8(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        If binValue.Length > 8 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If

        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow8()
        MsgBox(binValue.Length)
    End Sub
    Sub mulfalgsetting8(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        MsgBox(binValue)
        Dim v1 As String = binValue.Substring(0, 8)
        MsgBox(v1)
        Dim carryflag As Boolean = True
        For Each pfff As Char In v1.ToCharArray
            If pfff = "1" Then
                carryflag = False
                Exit For
            End If
        Next
        If carryflag Then
            t16.Text = "0"
            t5.Text = "0"

        Else

            t16.Text = "1"
            t5.Text = "1"
        End If
    End Sub
    Sub mulflagsetting16(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        MsgBox(binValue)
        Dim v1 As String = binValue.Substring(binValue.Length - 16, 16)
        'Dim v1 As String = binValue.Substring(0, 8)
        MsgBox(v1)
        Dim carryflag As Boolean = True
        For Each pfff As Char In v1.ToCharArray
            If pfff = "1" Then
                carryflag = False
                Exit For
            End If
        Next
        If carryflag Then
            t16.Text = "0"
            t5.Text = "0"

        Else

            t16.Text = "1"
            t5.Text = "1"
        End If
        OverFlow()
    End Sub
    Sub incflagsetting8(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        If binValue.Length > 8 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If

        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Sub subflagsetting(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        'If binValue.Length > 16 Then
        '    t16.Text = 1
        'Else
        '    t16.Text = 0
        'End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow()
        MsgBox(binValue.Length)
    End Sub
    Sub subflagsetting64(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin1(hexValue)
        'If binValue.Length > 16 Then
        '    t16.Text = 1
        'Else
        '    t16.Text = 0
        'End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow()
        MsgBox(binValue.Length)
    End Sub
    Sub shl()
        Dim inp1 As String = TextBox30.Text.Trim.ToUpper
        Dim s1 As String
        Dim s2 As String
        Dim count As Integer
        If c.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 2)
            s2 = hex_to_bin(s1)

        ElseIf b.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 4)
            s2 = hex_to_bin(s1)

        End If
        If TextBox32.Text.Trim.ToUpper = "CL" Then
            count = Val(InputBox("Enter the  value for CL"))
        Else
            count = Val(TextBox32.Text.Trim.ToUpper)
        End If

        If s2.Length = 8 And count <= 7 Then
            Dim str As String
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(count - 1, 1)
            str = s2.Substring(count, s2.Length - count) + last
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = ans.ToUpper.Substring(0, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = ans.ToUpper.Substring(0, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = ans.ToUpper.Substring(0, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            Else
                MsgBox("Invalid")
            End If
        ElseIf s2.Length = 16 And count <= 15 Then
            Dim str As String
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(count - 1, 1)
            str = s2.Substring(count, s2.Length - count) + last
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = ans.ToUpper
            Else
                MsgBox("Invalid")
            End If
        Else
            MsgBox("Invalid shifting value")
        End If
    End Sub
    Sub sal()
        Dim inp1 As String = TextBox30.Text.Trim.ToUpper
        Dim s1 As String
        Dim s2 As String
        Dim count As Integer
        If c.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 2)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        ElseIf b.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 4)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        End If
        If TextBox32.Text.Trim.ToUpper = "CL" Then
            count = Val(InputBox("Enter the  value for CL"))
        Else
            count = Val(TextBox32.Text.Trim.ToUpper)
        End If

        If s2.Length = 8 And count <= 7 Then
            Dim str As String
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(count - 1, 1)
            str = s2.Substring(count, s2.Length - count) + last
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = ans.ToUpper.Substring(0, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = ans.ToUpper.Substring(0, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = ans.ToUpper.Substring(0, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            Else
                MsgBox("Invalid")
            End If

        ElseIf s2.Length = 16 And count <= 15 Then
            Dim str As String
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(count - 1, 1)
            str = s2.Substring(count, s2.Length - count) + last
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = ans.ToUpper
            Else
                MsgBox("Invalid")
            End If
        Else
            MsgBox("Invalid shifting value")
        End If
    End Sub
    Sub shr()
        Dim inp1 As String = TextBox30.Text.Trim.ToUpper
        Dim s1 As String
        Dim s2 As String
        Dim count As Integer
        If c.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 2)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        ElseIf b.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 4)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        End If
        If TextBox32.Text.Trim.ToUpper = "CL" Then
            count = Val(InputBox("Enter the  value for CL"))
        Else
            count = Val(TextBox32.Text.Trim.ToUpper)
        End If

        If s2.Length = 8 And count <= 7 Then
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(s2.Length - count, 1)
            Dim str As String
            str = last + s2.Substring(0, s2.Length - count)
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = ans.ToUpper.Substring(0, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = ans.ToUpper.Substring(0, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = ans.ToUpper.Substring(0, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            Else
                MsgBox("Invalid")
            End If
        ElseIf s2.Length = 16 And count <= 15 Then

            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(s2.Length - count, 1)
            Dim str As String
            str = last + s2.Substring(0, s2.Length - count)
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = ans.ToUpper
            Else
                MsgBox("Invalid")
            End If
        Else
            MsgBox("Invalid shifting value")
        End If
    End Sub
    Sub sar()
        Dim inp1 As String = TextBox30.Text.Trim.ToUpper
        Dim s1 As String
        Dim s2 As String
        Dim count As Integer
        If c.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 2)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        ElseIf b.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 4)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        End If
        If TextBox32.Text.Trim.ToUpper = "CL" Then
            count = Val(InputBox("Enter the  value for CL"))
        Else
            count = Val(TextBox32.Text.Trim.ToUpper)
        End If

        If s2.Length = 8 Then
            Dim last As String = ""
            t16.Text = s2.Substring(s2.Length - count, 1)
            Dim str As String
            Dim r As String = s2.Substring(0, 1)
            str = r + last + s2.Substring(0, s2.Length - count)
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = ans.ToUpper.Substring(0, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = ans.ToUpper.Substring(0, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = ans.ToUpper.Substring(0, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            Else
                MsgBox("Invalid")
            End If
        ElseIf s2.Length = 16 Then
            Dim last As String = ""
            t16.Text = s2.Substring(s2.Length - count, 1)
            Dim str As String
            Dim r As String = s2.Substring(0, 1)
            str = r + last + s2.Substring(0, s2.Length - count)
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = ans.ToUpper
            Else
                MsgBox("Invalid")
            End If
        End If
    End Sub
    Sub rol()
        Dim inp1 As String = TextBox30.Text.Trim.ToUpper
        Dim s1 As String
        Dim s2 As String
        Dim count As Integer
        If c.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 2)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        ElseIf b.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 4)
            s2 = hex_to_bin(s1)
            MsgBox(s2)
        End If
        If TextBox32.Text.Trim.ToUpper = "CL" Then
            count = Val(InputBox("Enter the  value for CL"))
        Else
            count = Val(TextBox32.Text.Trim.ToUpper)
        End If

        If s2.Length = 8 And count <= 7 Then
            Dim last As String = ""
            For i As Integer = 1 To count - 1
                last = last + "0"          
            Next
            t16.Text = s2.Substring(0, 1)
            Dim str As String
            Dim j As String = s2.Substring(0, count)
            str = s2.Substring(count, s2.Length - count) + j
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = ans.ToUpper.Substring(0, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = ans.ToUpper.Substring(0, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = ans.ToUpper.Substring(0, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            Else
                MsgBox("Invalid")
            End If
        ElseIf s2.Length = 16 And count <= 15 Then
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(0, 1)
            Dim str As String
            Dim j As String = s2.Substring(0, count)
            str = s2.Substring(count, s2.Length - count) + j
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = ans.ToUpper
            Else
                MsgBox("Invalid")
            End If
        Else
            MsgBox("Invalid shifting value")
        End If
    End Sub
    Sub ror()
        Dim inp1 As String = TextBox30.Text.Trim.ToUpper
        Dim s1 As String
        Dim s2 As String
        Dim count As Integer
        If c.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 2)
            s2 = hex_to_bin(s1)

        ElseIf b.Contains(inp1) Then
            inp1 = InputBox("Enter the  value for " + inp1)
            s1 = inp1.Substring(0, 4)
            s2 = hex_to_bin(s1)
        End If
        If TextBox32.Text.Trim.ToUpper = "CL" Then
            count = Val(InputBox("Enter the  value for CL"))
        Else
            count = Val(TextBox32.Text.Trim.ToUpper)
        End If

        If s2.Length = 8 And count <= 7 Then
            Dim last As String = ""
            For i As Integer = 1 To count - 1
                last = last + "0"
            Next
            t16.Text = s2.Substring(s2.Length - 1, 1)
            Dim str As String
            Dim f As String = s2.Substring(s2.Length - count, count)
            str = f + s2.Substring(0, s2.Length - count)
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = ans.ToUpper.Substring(0, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = ans.ToUpper.Substring(0, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = ans.ToUpper.Substring(0, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = "00"
            Else
                MsgBox("Invalid")
            End If
        ElseIf s2.Length = 16 And count <= 15 Then
            Dim last As String = ""
            For i As Integer = 1 To count
                last = last + "0"
            Next
            t16.Text = s2.Substring(s2.Length - 1, 1)
            Dim str As String
            Dim f As String = s2.Substring(s2.Length - count, count)
            str = f + s2.Substring(0, s2.Length - count)
            MsgBox(str)
            Dim ans1 As String = bin_to_dec(str)
            Dim ans As String = Hex(ans1)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = ans.ToUpper.Substring(0, 2)
                AL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = ans.ToUpper.Substring(0, 2)
                BL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = ans.ToUpper.Substring(0, 2)
                CL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = ans.ToUpper.Substring(0, 2)
                DL.Text = ans.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = ans.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = ans.ToUpper
            Else
                MsgBox("Invalid")
            End If
        Else
            MsgBox("Invalid shifting value")
        End If
    End Sub
    Sub decflagsetting(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)

        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Sub decflagsetting8(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)

        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Sub addflagsetting8(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        If binValue.Length > 8 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If

        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow8()
        MsgBox(binValue.Length)
    End Sub
    Sub subflagsetting8(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)

        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If

        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow8()
        MsgBox(binValue.Length)
    End Sub
    Sub subflagsetting16(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin1(hexValue)

        Dim pfflag As String = binValue
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If

        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        OverFlow8()
        MsgBox(binValue.Length)
    End Sub
    Sub incflagsetting(ByVal hexValue As String)
        Dim binValue As String = hex_to_bin(hexValue)
        If binValue.Length > 16 Then
            t16.Text = 1
        Else
            t16.Text = 0
        End If
        Dim pfflag As String = binValue.Substring(binValue.Length - 8, 8)
        Dim charcount As Integer = 0
        For Each pfff As Char In pfflag.ToCharArray
            If pfff = "1" Then
                charcount = charcount + 1
            End If
        Next
        If charcount = 2 Or charcount = 4 Or charcount = 6 Or charcount = 8 Then
            t14.Text = "1"
        Else
            t14.Text = "0"
        End If
        Dim zeroFlag As Boolean = True
        For Each pfff As Char In binValue.ToCharArray
            If pfff = "1" Then
                zeroFlag = False
                Exit For
            End If
        Next
        If zeroFlag Then
            t10.Text = "1"
        Else
            t10.Text = "0"
        End If
        If binValue.StartsWith("1") Then
            t9.Text = "1"
        Else
            t9.Text = "0"
        End If
        MsgBox(binValue.Length)
    End Sub
    Function OverFlow() As String
        Dim result As String = "0"
        Dim checkMsb As Boolean = False
        Dim retVal As String = ""
        For i As Integer = 0 To 15
            If binOp1.ToCharArray()(i) = binOp2.ToCharArray()(i) = "0" Then
                If carry Then
                    result = "1" + result
                    carry = False
                Else
                    result = "0" + result
                End If

            ElseIf binOp1.ToCharArray()(i) = "0" And binOp2.ToCharArray()(i) = "1" Then
                If carry Then
                    result = "0" + result
                    carry = True
                Else
                    result = "1" + result
                End If
            ElseIf binOp1.ToCharArray()(i) = "1" And binOp2.ToCharArray()(i) = "0" Then
                If carry Then
                    result = "0" + result
                    carry = True
                Else
                    result = "1" + result
                End If
            ElseIf binOp1.ToCharArray()(i) = binOp2.ToCharArray()(i) = "1" Then
                If carry Then
                    result = "1" + result
                    carry = True
                Else
                    result = "0" + result
                    carry = True
                End If
            End If
            If i = 3 And carry Then
                t12.Text = "1"
            Else
                t12.Text = "0"
            End If
            If i = 14 And carry Then
                checkMsb = True
            End If
            If i = 15 And checkMsb And Not carry Then
                retVal = "1"
            Else
                retVal = "0"
            End If
        Next
        Return retVal
    End Function
    Function overflowSub() As String
        Dim result As String = "0"
        Dim borrow As Boolean = False
        Dim checkMsb As Boolean = False
        Dim retVal As String = ""
        For i As Integer = 0 To 15
            If binOp1.ToCharArray()(i) = binOp2.ToCharArray()(i) = "0" Then

            End If
        Next
        Return retVal
    End Function
    Function OverFlow8() As String
        Dim result As String = "0"
        Dim checkMsb As Boolean = False
        Dim retVal As String = ""
        For i As Integer = 0 To 7
            If binOp1.ToCharArray()(i) = binOp2.ToCharArray()(i) = "0" Then
                If carry Then
                    result = "1" + result
                    carry = False
                Else
                    result = "0" + result
                End If

            ElseIf binOp1.ToCharArray()(i) = "0" And binOp2.ToCharArray()(i) = "1" Then
                If carry Then
                    result = "0" + result
                    carry = True
                Else
                    result = "1" + result
                End If
            ElseIf binOp1.ToCharArray()(i) = "1" And binOp2.ToCharArray()(i) = "0" Then
                If carry Then
                    result = "0" + result
                    carry = True
                Else
                    result = "1" + result
                End If
            ElseIf binOp1.ToCharArray()(i) = binOp2.ToCharArray()(i) = "1" Then
                If carry Then
                    result = "1" + result
                    carry = True
                Else
                    result = "0" + result
                    carry = True
                End If
            End If
            If i = 3 And carry Then
                t12.Text = "1"
            Else
                t12.Text = "0"
            End If
            If i = 6 And carry Then
                checkMsb = True
            End If
            If i = 7 And checkMsb And Not carry Then
                retVal = "1"
            Else
                retVal = "0"
            End If
        Next
        Return retVal
    End Function
    Sub MOVimmediateAddressing()

        If TextBox30.Text.ToUpper = b(0) Then
            AH.Text = TextBox32.Text.Substring(0, 2)
            AL.Text = TextBox32.Text.Substring(2, 2)
        ElseIf TextBox30.Text.ToUpper = b(1) Then
            BH.Text = TextBox32.Text.Substring(0, 2)
            BL.Text = TextBox32.Text.Substring(2, 2)
        ElseIf TextBox30.Text.ToUpper = b(2) Then
            CH.Text = TextBox32.Text.Substring(0, 2)
            CL.Text = TextBox32.Text.Substring(2, 2)
        ElseIf TextBox30.Text.ToUpper = b(3) Then
            DH.Text = TextBox32.Text.Substring(0, 2)
            DL.Text = TextBox32.Text.Substring(2, 2)
        ElseIf TextBox30.Text.ToUpper = b(4) Then
            SI.Text = TextBox32.Text
        ElseIf TextBox30.Text.ToUpper = b(5) Then
            DI.Text = TextBox32.Text
        ElseIf TextBox30.Text.ToUpper = b(6) Then
            SP.Text = TextBox32.Text
        ElseIf TextBox30.Text.ToUpper = b(7) Then
            BP.Text = TextBox32.Text

        ElseIf TextBox30.Text.ToUpper = c(0) Then
            AH.Text = TextBox32.Text
            AL.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(1) Then
            AL.Text = TextBox32.Text
            AH.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(2) Then
            BH.Text = TextBox32.Text
            BL.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(3) Then
            BL.Text = TextBox32.Text
            BH.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(4) Then
            CH.Text = TextBox32.Text
            CL.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(5) Then
            CL.Text = TextBox32.Text
            CH.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(6) Then
            DH.Text = TextBox32.Text
            DL.Text = "00"
        ElseIf TextBox30.Text.ToUpper = c(7) Then
            DL.Text = TextBox32.Text
            DH.Text = "00"
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varmovimmdtMode()
        Else
            MsgBox("Invalid,mov Immdeiate addresing mode")
        End If
    End Sub
    Sub AddImmediateAddressing()
        If b.Contains(TextBox30.Text.ToUpper) And TextBox32.Text.Length = 5 Then
            Dim addvalue As String = InputBox(TextBox30.Text.ToUpper)
            Dim addvalue1 As String = addvalue.Substring(0, 4)
            Dim addvalue2 As String = TextBox32.Text.Trim.Substring(0, 4)
            binOp1 = hex_to_bin(addvalue1)
            binOp2 = hex_to_bin(addvalue2)
            t5.Text = OverFlow()
            Dim adddec As Long = hex_to_dec(addvalue1)
            Dim adddec1 As Long = hex_to_dec(addvalue2)
            Dim adddecsum As Long = adddec + adddec1
            Dim addhexsum As String = Hex(adddecsum)
            AddFlagSetting(addhexsum)
            Dim hexsum As String = addhexsum + "H"
            TextBox32.Text = hexsum
            Dim hexsum1 As String = hexsum.Substring(0, 4)

            If TextBox30.Text.ToUpper = b(0) And hexsum.Length >= 5 Then

                AH.Text = hexsum.Substring(0, 2)
                AL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(1) Then

                BH.Text = hexsum.Substring(0, 2)
                BL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(2) Then

                CH.Text = hexsum.Substring(0, 2)
                CL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(3) Then

                DH.Text = hexsum.Substring(0, 2)
                DL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = hexsum
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = hexsum
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = hexsum
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = hexsum
            End If

        ElseIf c.Contains(TextBox30.Text.ToUpper) And TextBox32.Text.Trim.Length = 3 Then
            Dim addvalue As String = InputBox(TextBox30.Text.ToUpper)
            Dim addvalue1 As String = addvalue.Substring(0, 2)
            Dim addvalue2 As String = TextBox32.Text.Trim.Substring(0, 2)
            Dim adddec As Long = hex_to_dec(addvalue1)
            Dim adddec1 As Long = hex_to_dec(addvalue2)
            binOp1 = hex_to_bin(addvalue1)
            binOp2 = hex_to_bin(addvalue2)
            t5.Text = OverFlow8()
            Dim adddecsum As Long = adddec + adddec1
            Dim addhexsum As String = Hex(adddecsum)
            addflagsetting8(addhexsum)
            Dim hexsum As String = addhexsum + "H"
            TextBox32.Text = hexsum
            MsgBox(hexsum.Length = 3)

            If TextBox30.Text.ToUpper = c(0) And hexsum.Length = 3 Then

                AH.Text = hexsum.Substring(0, 2)
                AL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(1) Then

                AL.Text = hexsum.Substring(0, 2)
                AH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(2) Then

                BH.Text = hexsum.Substring(0, 2)
                BL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(3) Then

                BL.Text = hexsum.Substring(0, 2)
                BH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(4) Then

                CH.Text = hexsum.Substring(0, 2)
                CL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(5) Then

                CL.Text = hexsum.Substring(0, 2)
                CH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(6) Then

                DH.Text = hexsum.Substring(0, 2)
                DL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(7) Then

                DL.Text = hexsum.Substring(0, 2)
                DH.Text = "00"
            Else
                MsgBox("Invalid regsiter combination")

            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddImmdtMode()
        Else
            MsgBox("invalid regsiter immdte add")
        End If

    End Sub
    Sub varmovimmdtMode()
        Dim v1 As String = TextBox32.Text.Trim.ToUpper
        If v1.Length = 5 Then
            If v1.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = v1.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = v1.Substring(2, 2)
            Else
                MsgBox("Invalid hexadecimal number or final result")
            End If

        ElseIf v1.Length = 3 Then
            If v1.Length = 3 Then
                DataGridView1.Rows(0).Cells(1).Value = v1.Substring(0, 2)

            Else
                MsgBox("Invalid hexadecimal number or final result")
            End If
        Else
            MsgBox("Invalid combination of register")
        End If
    End Sub
    Sub sbbimmdte()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.ToUpper) And v1.Length = 5 And v1.ToUpper.ElementAt(4) = "h" Or v1.ToUpper.ElementAt(4) = "H" Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)
            MsgBox(v2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            MsgBox(v3)
            Dim v4 As String = v3.ToUpper.Substring(0, 4)
            MsgBox(v4)
            If v2 > v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)
                Dim subdec2 As Long = hex_to_dec(v4)
                Dim subimm As Long = subdec1 - subdec2
                Dim subhex2 As String = Hex(subimm)
                MsgBox(subhex2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow()
                subflagsetting(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subimm - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If subhex.Length = 4 Then
                        AH.Text = subhex.Substring(0, 2)
                        AL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If subhex.Length = 4 Then
                        BH.Text = subhex.Substring(0, 2)
                        BL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If subhex.Length = 4 Then
                        CH.Text = subhex.Substring(0, 2)
                        CL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If subhex.Length = 4 Then
                        DH.Text = subhex.Substring(0, 2)
                        DL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    SI.Text = subhex1
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    DI.Text = subhex1
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    SP.Text = subhex1
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    BP.Text = subhex1
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v2 <= v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)
                Dim subdec2 As Long = hex_to_dec(v4)
                Dim subimm As Long = subdec1 - subdec2
                Dim subhex2 As String = Hex(subimm)
                MsgBox(subhex2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow()
                subflagsetting64(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subimm - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If subhex.Length >= 4 Then
                        AH.Text = subhex.Substring(subhex.Length - 4, 2)
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If subhex.Length >= 4 Then
                        BH.Text = subhex.Substring(subhex.Length - 4, 2)
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If subhex.Length >= 4 Then
                        CH.Text = subhex.Substring(subhex.Length - 4, 2)
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If subhex.Length >= 4 Then
                        DH.Text = subhex.Substring(subhex.Length - 4, 2)
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    SI.Text = subhex
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    DI.Text = subhex
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    SP.Text = subhex
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    BP.Text = subhex
                Else
                    MsgBox("Invalid register combination")
                End If
            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        ElseIf c.Contains(TextBox30.Text.ToUpper) And v1.Length = 3 And v1.ToUpper.ElementAt(2) = "h" Or v1.ToUpper.ElementAt(2) = "H" Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next

            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v3 As String = TextBox32.Text.Trim.ToUpper

            Dim v4 As String = v3.ToUpper.Substring(0, 2)

            If v2 > v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex2 As String = Hex(subimm)
                MsgBox(subhex2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow8()
                subflagsetting8(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subimm - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    If subhex1.Length = 3 Then
                        AH.Text = subhex1
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    If subhex1.Length = 3 Then
                        AL.Text = subhex1
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    If subhex1.Length = 3 Then
                        BH.Text = subhex1
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    If subhex1.Length = 3 Then
                        BL.Text = subhex1
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    If subhex1.Length = 3 Then
                        CH.Text = subhex1
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    If subhex1.Length = 3 Then
                        CL.Text = subhex1
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    If subhex1.Length = 3 Then
                        DH.Text = subhex1
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    If subhex1.Length = 3 Then
                        DL.Text = subhex1
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v2 <= v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex2 As String = Hex(subimm)
                MsgBox(subhex2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow8()
                subflagsetting8(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subimm - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    If subhex1.Length = 3 Then
                        AH.Text = subhex.Substring(subhex.Length - 2, 2)
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    If subhex1.Length = 3 Then
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    If subhex1.Length = 3 Then
                        BH.Text = subhex.Substring(subhex.Length - 2, 2)
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    If subhex1.Length = 3 Then
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    If subhex1.Length = 3 Then
                        CH.Text = subhex.Substring(subhex.Length - 2, 2)
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    If subhex1.Length = 3 Then
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    If subhex1.Length = 3 Then
                        DH.Text = subhex.Substring(subhex.Length - 2, 2)
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    If subhex1.Length = 3 Then
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        Else
            MsgBox("invalid regsiter immdte add")
        End If
    End Sub
    Sub subcar()

        Dim borrow As Boolean = False
        Dim result As String = ""
        For i As Integer = binop1.Trim.Length - 1 To 0 Step -1
            If binop1.ToCharArray()(i) = "0" And binop2.ToCharArray()(i) = "0" Then
                result = "0" + result
            ElseIf binop1.ToCharArray()(i) = "1" And binop2.ToCharArray()(i) = "0" Then
                result = "1" + result
            ElseIf binop1.ToCharArray()(i) = "1" And binop2.ToCharArray()(i) = "1" Then
                result = "0" + result
            ElseIf binop1.ToCharArray()(i) = "0" And binop2.ToCharArray()(i) = "1" Then
                If i = 1 Then
                    borrow = True
                End If
                Dim k As Integer = 1
                While (i - k >= 0)
                    If binop1.ToCharArray()(i - k) = "1" Then
                        change(binop1, i - k, "0")
                        For j As Integer = k - 1 To 1 Step -1
                            change(binop1, i - j, "1")
                        Next
                        result = "1" + result
                        Exit While
                    End If
                    k = k + 1
                End While
            End If
            If i = 0 Then
                If binop1.ToCharArray()(i) = "0" And binop2.ToCharArray()(i) = "1" Then
                    t16.Text = "1"
                    If borrow Then
                        t5.Text = "1"
                    Else
                        t5.Text = "0"
                    End If
                Else
                    t16.Text = "0"
                End If
            End If
        Next
    End Sub
    Sub change(ByRef source As String, ByVal pos As Integer, ByVal val As String)
        source = source.Substring(0, pos) + val + source.Substring(pos + 1, source.Length - pos - 1)
    End Sub
    Sub SubImmediateAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.ToUpper) And v1.Length = 5 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)
            Dim s1 As String = TextBox32.Text.ToUpper
            Dim s2 As String = s1.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next

            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            Dim v4 As String = v3.ToUpper.Substring(0, 4)
            If v2 > v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex As String = hexa(subimm)
                MsgBox(subhex)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                t5.Text = OverFlow()
                subflagsetting(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If subhex.Length >= 4 Then
                        AH.Text = subhex.Substring(0, 2)
                        AL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If subhex.Length >= 4 Then
                        BH.Text = subhex.Substring(0, 2)
                        BL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If subhex.Length >= 4 Then
                        CH.Text = subhex.Substring(0, 2)
                        CL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If subhex.Length >= 4 Then
                        DH.Text = subhex.Substring(0, 2)
                        DL.Text = subhex.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    SI.Text = subhex1
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    DI.Text = subhex1
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    SP.Text = subhex1
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    BP.Text = subhex1
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v2 <= v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex As String = hexa(subimm)
                MsgBox(subhex)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                t5.Text = OverFlow()
                subflagsetting(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If subhex.Length >= 4 Then
                        AH.Text = subhex.Substring(subhex.Length - 4, 2)
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If subhex.Length >= 4 Then
                        BH.Text = subhex.Substring(subhex.Length - 4, 2)
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If subhex.Length >= 4 Then
                        CH.Text = subhex.Substring(subhex.Length - 4, 2)
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If subhex.Length >= 4 Then
                        DH.Text = subhex.Substring(subhex.Length - 4, 2)
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Invalid hexa num")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    SI.Text = subhex
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    DI.Text = subhex
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    SP.Text = subhex
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    BP.Text = subhex
                Else
                    MsgBox("Invalid register combination")
                End If

            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        ElseIf c.Contains(TextBox30.Text.ToUpper) And v1.Length = 3 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)

            Dim s1 As String = TextBox32.Text.ToUpper
            Dim s2 As String = s1.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next

            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v3 As String = TextBox32.Text.Trim.ToUpper

            Dim v4 As String = v3.ToUpper.Substring(0, 2)

            If v2 > v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex As String = hexa(subimm)
                MsgBox(subhex)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                t5.Text = OverFlow8()
                subflagsetting8(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    If subhex1.Length >= 3 Then
                        AH.Text = subhex
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    If subhex1.Length >= 3 Then
                        AL.Text = subhex
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    If subhex1.Length >= 3 Then
                        BH.Text = subhex
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    If subhex1.Length >= 3 Then
                        BL.Text = subhex
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    If subhex1.Length >= 3 Then
                        CH.Text = subhex
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    If subhex1.Length >= 3 Then
                        CL.Text = subhex
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    If subhex1.Length >= 3 Then
                        DH.Text = subhex
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    If subhex1.Length >= 3 Then
                        DL.Text = subhex
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v2 <= v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex As String = hexa(subimm)
                MsgBox(subhex)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(s2)
                t5.Text = OverFlow8()
                subflagsetting16(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    If subhex1.Length >= 3 Then
                        AH.Text = subhex.Substring(subhex.Length - 2, 2)
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    If subhex1.Length >= 3 Then
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    If subhex1.Length >= 3 Then
                        BH.Text = subhex.Substring(subhex.Length - 2, 2)
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    If subhex1.Length >= 3 Then
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    If subhex1.Length >= 3 Then
                        CH.Text = subhex.Substring(subhex.Length - 2, 2)
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    If subhex1.Length >= 3 Then
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    If subhex1.Length >= 3 Then
                        DH.Text = subhex.Substring(subhex.Length - 2, 2)
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    If subhex1.Length >= 3 Then
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubimmtrMode()
        Else
            MsgBox("invalid regsiter immdte add")
        End If
    End Sub
    Sub andimmdtemode()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 4)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v2)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v2)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            andflagsetting(r1)

            If TextBox30.Text.Trim.ToUpper = b(0) Then
                AH.Text = r1.Substring(0, 2).ToUpper
                AL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                BH.Text = r1.Substring(0, 2).ToUpper
                BL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                CH.Text = r1.Substring(0, 2).ToUpper
                CL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                CL.Text = r1.Substring(0, 2).ToUpper
                DL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                SI.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                DI.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                SP.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                BP.Text = r1.ToUpper
            Else
                MsgBox("Invalid combination of register")
            End If
        ElseIf v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v2)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v2)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            MsgBox(r)
            Dim r1 As String = hex8(r)
            MsgBox(r1)

            andflagsetting8(r1)
            If TextBox30.Text.Trim.ToUpper = c(0) Then
                AH.Text = r1.ToUpper
                AL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                AL.Text = r1.ToUpper
                AH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                BH.Text = r1.ToUpper
                BL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                BL.Text = r1.ToUpper
                BH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                CH.Text = r1.ToUpper
                CL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                CL.Text = r1.ToUpper
                CH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                DH.Text = r1.ToUpper
                DL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                DL.Text = r1.ToUpper
                DH.Text = "00"
            Else
                MsgBox("Invalid combination of register")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandimmedate()
        Else
            MsgBox("Invalid combination of regisetr value")
        End If
    End Sub
    Sub orimmdete()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 4)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v2)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v2)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            orflagsetting(r1)
            If TextBox30.Text.Trim.ToUpper = b(0) Then
                AH.Text = r1.Substring(0, 2).ToUpper
                AL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                BH.Text = r1.Substring(0, 2).ToUpper
                BL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                CH.Text = r1.Substring(0, 2).ToUpper
                CL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                DH.Text = r1.Substring(0, 2).ToUpper
                DL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                SI.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                DI.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                SP.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                BP.Text = r1.ToUpper
            Else
                MsgBox("Invalid combination of register")
            End If
        ElseIf v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 2)
            MsgBox(v2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            MsgBox(v3)
            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 2)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v2)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v2)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            orflagsetting8(r1)
            If TextBox30.Text.Trim.ToUpper = c(0) Then
                AH.Text = r1.ToUpper
                AL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                AL.Text = r1.ToUpper
                AH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                BH.Text = r1.ToUpper
                BL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                BL.Text = r1.ToUpper
                BH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                CH.Text = r1.ToUpper
                CL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                CL.Text = r1.ToUpper
                CH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                DH.Text = r1.ToUpper
                DL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                DL.Text = r1.ToUpper
                DH.Text = "00"
            Else
                MsgBox("Invalid combination of register")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varorimmdete()
        Else
            MsgBox("Invalid combination of regisetr value")
        End If
    End Sub
    Sub cmpimmdte()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v1.Length = 5 Then
            Dim v2 As String = v1.Substring(0, 4)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As Long = hex_to_dec(v2)

            Dim s2 As Long = hex_to_dec(v3)
            Dim a As Long = s1 - s2
            Dim a2 As String = hexa(a)
            MsgBox(a2)
            cmpflagsetting(s1, s2)
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v1.Length = 3 Then
            Dim v2 As String = v1.Substring(0, 2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As Long = hex_to_dec(v2)

            Dim s2 As Long = hex_to_dec(v3)
            Dim a As Long = s1 - s2
            Dim a2 As String = hexa(a)
            MsgBox(a2)
            cmpflagsetting(s1, s2)
        Else
            MsgBox("Invalid register combiantion")
        End If
    End Sub
    Sub testimmdte()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 4)

            Dim v3 As String = TextBox32.Text.Trim.ToUpper

            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As String = hex_to_bin(v2)

            Dim s2 As String = hex_to_bin(v4)

            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)

            Dim r1 As String = hexa(r)

            testflagsetting(r1)

        ElseIf v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 2)

            Dim v3 As String = TextBox32.Text.Trim.ToUpper

            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As String = hex_to_bin(v2)

            Dim s2 As String = hex_to_bin(v4)

            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)

            Dim r1 As String = hex8(r)

            testflagsetting8(r1)

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandimmedate()
        Else
            MsgBox("Invalid combination of regisetr value")
        End If

    End Sub
    Sub exchangeimmdte()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)

        If v1.Length = 5 Then
            Dim v3 As String = v1.Trim.ToUpper.Substring(0, 4)
            Dim v4 As String = TextBox32.Text.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v4.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = v4.ToUpper.Substring(0, 2)
                AL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = v4.ToUpper.Substring(0, 2)
                BL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = v4.ToUpper.Substring(0, 2)
                CL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = v4.ToUpper.Substring(0, 2)
                DL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = v4.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = v4.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = v4.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = v4.ToUpper
            Else
                MsgBox("Invalid register combination")
            End If



        ElseIf v1.Length = 3 Then
            Dim v3 As String = v1.Trim.ToUpper.Substring(0, 2)
            Dim v4 As String = TextBox32.Text.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v4.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            If TextBox30.Text.ToUpper = c(0) Then

                AH.Text = v4.Substring(0, 2)
                AL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(1) Then

                AL.Text = v4.Substring(0, 2)
                AH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(2) Then

                BH.Text = v4.Substring(0, 2)
                BL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(3) Then

                BL.Text = v4.Substring(0, 2)
                BH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(4) Then

                CH.Text = v4.Substring(0, 2)
                CL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(5) Then

                CL.Text = v4.Substring(0, 2)
                CH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(6) Then

                DH.Text = v4.Substring(0, 2)
                DL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(7) Then

                DL.Text = v4.Substring(0, 2)
                DH.Text = "00"
            Else
                MsgBox("Invalid regsiter combination")

            End If


        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub adcimmdte()

        If b.Contains(TextBox30.Text.ToUpper) And TextBox32.Text.Length = 5 Then
            Dim addvalue As String = InputBox(TextBox30.Text.ToUpper)
            Dim addvalue1 As String = addvalue.Substring(0, 4)
            Dim addvalue2 As String = TextBox32.Text.Trim.Substring(0, 4)
            binOp1 = hex_to_bin(addvalue1)
            binOp2 = hex_to_bin(addvalue2)
            t5.Text = OverFlow()
            Dim adddec As Long = hex_to_dec(addvalue1)

            Dim adddec1 As Long = hex_to_dec(addvalue2)

            Dim adddecsum As Long = adddec + adddec1

            Dim addhexsum As String = Hex(adddecsum)
            AddFlagSetting(addhexsum)
            Dim adddc As Long = hex_to_dec(addhexsum)
            Dim p As String = t16.Text
            Dim adddc1 As Long = hex_to_dec(p)
            Dim addh As Long = adddc + adddc1

            Dim hexsum As String = Hex(addh)

            If TextBox30.Text.ToUpper = b(0) And hexsum.Length = 4 Then

                AH.Text = hexsum.Substring(0, 2)
                AL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = hexsum.Substring(0, 2)
                BL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(2) Then

                CH.Text = hexsum.Substring(0, 2)
                CL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(3) Then

                DH.Text = hexsum.Substring(0, 2)
                DL.Text = hexsum.Substring(2, 2)

            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = hexsum
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = hexsum
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                SP.Text = hexsum
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                BP.Text = hexsum
            Else
                MsgBox("Invalid affa")
            End If

        ElseIf c.Contains(TextBox30.Text.ToUpper) And TextBox32.Text.Trim.Length = 3 Then
            Dim addvalue As String = InputBox(TextBox30.Text.ToUpper)

            Dim addvalue1 As String = addvalue.Substring(0, 2)

            Dim addvalue2 As String = TextBox32.Text.Trim.Substring(0, 2)

            Dim adddec As Long = hex_to_dec(addvalue1)

            Dim adddec1 As Long = hex_to_dec(addvalue2)
            binOp1 = hex_to_bin(addvalue1)
            binOp2 = hex_to_bin(addvalue2)
            t5.Text = OverFlow8()
            Dim adddecsum As Long = adddec + adddec1
            Dim addhexsum As String = Hex(adddecsum)
            AddFlagSetting(addhexsum)
            Dim adddc As Long = hex_to_dec(addhexsum)
            Dim p As String = t16.Text
            Dim adddc1 As Long = hex_to_dec(p)
            Dim addh As Long = adddc + adddc1

            Dim hexsum As String = Hex(addh)


            If TextBox30.Text.ToUpper = c(0) And hexsum.Length = 2 Then

                AH.Text = hexsum.Substring(0, 2)
                AL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(1) Then

                AL.Text = hexsum.Substring(0, 2)
                AH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(2) Then

                BH.Text = hexsum.Substring(0, 2)
                BL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(3) Then

                BL.Text = hexsum.Substring(0, 2)
                BH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(4) Then

                CH.Text = hexsum.Substring(0, 2)
                CL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(5) Then

                CL.Text = hexsum.Substring(0, 2)
                CH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(6) Then

                DH.Text = hexsum.Substring(0, 2)
                DL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(7) Then

                DL.Text = hexsum.Substring(0, 2)
                DH.Text = "00"


            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddImmdtMode()
        Else
            MsgBox("invalid regsiter immdte add")
        End If
    End Sub
    Sub MOVregisterAddressing()
        Dim regval As String = InputBox(TextBox32.Text.ToUpper)
        If (b.Contains(TextBox30.Text.ToUpper) And regval.Trim.Length = 5) Or (c.Contains(TextBox30.Text.ToUpper) And regval.Trim.Length = 3) Then

            If TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(1) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Substring(0, 2)
                    AL.Text = regval.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else

                    MsgBox("invalid regstr ax to bx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(2) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Substring(0, 2)
                    AL.Text = regval.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else

                    MsgBox("invalid regstr ax to cx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(3) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Substring(0, 2)
                    AL.Text = regval.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else

                    MsgBox("invalid regstr ax to dx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(4) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Trim.Substring(0, 2)
                    AL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else

                    MsgBox("invalid regstr ax to si")
                End If
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(5) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Trim.Substring(0, 2)
                    AL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else

                    MsgBox("invalid regstr ax to di")
                End If
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(6) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Trim.Substring(0, 2)
                    AL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else
                    MsgBox("invalid regstr ax to sp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(7) Then
                If regval.Length = 5 Then
                    AH.Text = regval.Trim.Substring(0, 2)
                    AL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    AH.Text = regval
                    AL.Text = "00"
                Else

                    MsgBox("invalid regstr ax to bp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(0) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else

                    MsgBox("invalid regstr bx to ax")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(2) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else

                    MsgBox("invalid regstr bx to cx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(3) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else
                    MsgBox("invalid regstr bx to dx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(4) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else
                    MsgBox("invalid regstr bx to si")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(5) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else
                    MsgBox("invalid regstr bx to di")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(6) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else
                    MsgBox("invalid regstr bx to sp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(7) Then
                If regval.Length = 5 Then
                    BH.Text = regval.Trim.Substring(0, 2)
                    BL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    BH.Text = regval
                    BL.Text = "00"
                Else
                    MsgBox("invalid regstr bx to bp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(0) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else
                    MsgBox("invalid regstr cx to ax")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(1) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else
                    MsgBox("invalid regstr cx to bx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(3) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else
                    MsgBox("invalid regstr cx to dx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(4) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else
                    MsgBox("invalid regstr cx to si")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(5) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else

                    MsgBox("invalid regstr cx to di")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(6) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else
                    MsgBox("invalid regstr cx to sp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(7) Then
                If regval.Length = 5 Then
                    CH.Text = regval.Trim.Substring(0, 2)
                    CL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    CH.Text = regval
                    CL.Text = "00"
                Else
                    MsgBox("invalid regstr cx to bp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(0) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to ax")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(1) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to bx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(2) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to cx")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(4) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to si")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(5) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to di")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(6) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to sp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(7) Then
                If regval.Length = 5 Then
                    DH.Text = regval.Trim.Substring(0, 2)
                    DL.Text = regval.Trim.Substring(2, 2)
                ElseIf regval.Length = 3 Then
                    DH.Text = regval
                    DL.Text = "00"
                Else
                    MsgBox("invalid regstr dx to bp")
                End If
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(0) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(1) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(2) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(3) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(5) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(6) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(4) And TextBox32.Text.ToUpper = b(7) Then
                SI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox32.Text.ToUpper = b(0) Then
                DI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox32.Text.ToUpper = b(1) Then
                DI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox30.Text.ToUpper = b(2) Then
                DI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox32.Text.ToUpper = b(3) Then
                DI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox32.Text.ToUpper = b(4) Then
                DI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox32.Text.ToUpper = b(6) Then
                DI.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(5) And TextBox32.Text.ToUpper = b(7) Then
                DI.Text = regval


            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = b(0) Then
                SP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = c(1) Then
                SP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = b(2) Then
                SP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = b(3) Then
                SP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = b(4) Then
                SP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = b(5) Then
                SP.Text = DI.Text
            ElseIf TextBox30.Text.ToUpper = b(6) And TextBox32.Text.ToUpper = b(7) Then
                SP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(0) Then
                BP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(1) Then
                BP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(2) Then
                BP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(3) Then
                BP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(4) Then
                BP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(5) Then
                BP.Text = regval
            ElseIf TextBox30.Text.ToUpper = b(7) And TextBox32.Text.ToUpper = b(6) Then
                BP.Text = regval

            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(1) Then
                AH.Text = regval
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(2) Then
                AH.Text = regval
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(3) Then
                AH.Text = regval
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(4) Then
                AH.Text = regval
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(5) Then
                AH.Text = regval
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(6) Then
                AH.Text = regval
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(7) Then
                AH.Text = regval
                AL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(0) Then
                AL.Text = regval
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(2) Then
                AL.Text = regval
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(3) Then
                AL.Text = regval
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(4) Then
                AL.Text = regval
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(5) Then
                AL.Text = regval
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(6) Then
                AL.Text = regval
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(7) Then
                AL.Text = regval
                AH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(0) Then
                BH.Text = regval
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(1) Then
                BH.Text = regval
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(3) Then
                BH.Text = regval
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(4) Then
                BH.Text = regval
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(5) Then
                BH.Text = regval
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(6) Then
                BH.Text = regval
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(7) Then
                BH.Text = regval
                BL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(0) Then
                BL.Text = regval
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(1) Then
                BL.Text = regval
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(2) Then
                BL.Text = regval
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(4) Then
                BL.Text = regval
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(5) Then
                BL.Text = regval
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(6) Then
                BL.Text = regval
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(7) Then
                BL.Text = regval
                BH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(0) Then
                CH.Text = regval
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(1) Then
                CH.Text = regval
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(2) Then
                CH.Text = regval
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(3) Then
                CH.Text = regval
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(5) Then
                CH.Text = regval
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(6) Then
                CH.Text = regval
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(7) Then
                CH.Text = regval
                CL.Text = "00"



            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(0) Then
                CL.Text = regval
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(1) Then
                CL.Text = regval
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(2) Then
                CL.Text = regval
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(3) Then
                CL.Text = regval
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(4) Then
                CL.Text = regval
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(6) Then
                CL.Text = regval
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(7) Then
                CL.Text = regval
                CH.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(0) Then
                DH.Text = regval
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(1) Then
                DH.Text = regval
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(2) Then
                DH.Text = regval
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(3) Then
                DH.Text = regval
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(4) Then
                DH.Text = regval
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(5) Then
                DH.Text = regval
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(7) Then
                DH.Text = regval
                DL.Text = "00"

            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(0) Then
                DL.Text = regval
                DH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(1) Then
                DL.Text = regval
                DH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(2) Then
                DL.Text = regval
                DH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(3) Then
                DL.Text = regval
                DH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(4) Then
                DL.Text = regval
                DH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(5) Then
                DL.Text = regval
                DH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(6) Then
                DL.Text = regval
                DH.Text = "00"
            Else
                MsgBox("Invalid regisetr mod(length)")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varmovregMode()
        Else
            MsgBox("Invalid,mov register addresing mode")
        End If
    End Sub
    Sub andregstrMode()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 5 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 4)
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            andflagsetting(r1)
            If (b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AH.Text = r1.ToUpper.Substring(0, 2)
                AL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BH.Text = r1.ToUpper.Substring(0, 2)
                BL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = r1.ToUpper.Substring(0, 2)
                CL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = r1.ToUpper.Substring(0, 2)
                DL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SI.Text = r1.ToUpper
            ElseIf (b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DI.Text = r1.ToUpper
            ElseIf (b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = r1.ToUpper
            ElseIf (b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BP.Text = r1.ToUpper
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 2)
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As String = hex_to_bin(v3)
            MsgBox(s1)
            Dim s2 As String = hex_to_bin(v4)
            MsgBox(s2)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            MsgBox(r)
            Dim r1 As String = hex8(r)
            MsgBox(r1)
            andflagsetting8(r1)
            If (c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AH.Text = r1.ToUpper
                AL.Text = "00"
            ElseIf (c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AL.Text = r1.ToUpper
                AH.Text = "00"
            ElseIf (c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BH.Text = r1.ToUpper
                BL.Text = "00"
            ElseIf (c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BL.Text = r1.ToUpper
                BH.Text = "00"
            ElseIf (c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = r1.ToUpper
                CL.Text = "00"
            ElseIf (c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CL.Text = r1.ToUpper
                CH.Text = "00"
            ElseIf (c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = r1.ToUpper
                DL.Text = "00"
            ElseIf (c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DL.Text = r1.ToUpper
                DH.Text = "00"
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandreg()
        Else
            MsgBox("Invalid combination of register")
        End If

    End Sub
    Sub orregstrMod()

        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 5 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("Or Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            orflagsetting(r1)
            If (b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AH.Text = r1.ToUpper.Substring(0, 2)
                AL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BH.Text = r1.ToUpper.Substring(0, 2)
                BL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = r1.ToUpper.Substring(0, 2)
                CL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = r1.ToUpper.Substring(0, 2)
                DL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SI.Text = r1.ToUpper
            ElseIf (b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DI.Text = r1.ToUpper
            ElseIf (b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = r1.ToUpper
            ElseIf (b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BP.Text = r1.ToUpper
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            orflagsetting8(r1)
            If (c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AH.Text = r1.ToUpper
                AL.Text = "00"
            ElseIf (c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AL.Text = r1.ToUpper
                AH.Text = "00"
            ElseIf (c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BH.Text = r1.ToUpper
                BL.Text = "00"
            ElseIf (c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BL.Text = r1.ToUpper
                BH.Text = "00"
            ElseIf (c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = r1.ToUpper
                CL.Text = "00"
            ElseIf (c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CL.Text = r1.ToUpper
                CH.Text = "00"
            ElseIf (c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = r1.ToUpper
                DL.Text = "00"
            ElseIf (c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DL.Text = r1.ToUpper
                DH.Text = "00"
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varorregster()
        Else
            MsgBox("Invalid combination of register")
        End If

    End Sub
    Sub MulRegisterAddressing()
        If b.Contains(TextBox30.Text.Trim.ToUpper) And b(0).Trim.ToUpper <> TextBox30.Text.Trim.ToUpper Then
            Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = v1.Substring(v1.Length - 5, 2)
                AL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = v1.Substring(v1.Length - 5, 2)
                BL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = v1.Substring(v1.Length - 5, 2)
                CL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = v1.Substring(v1.Length - 5, 2)
                DL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = v1.Substring(v1.Length - 5, 4)
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = v1.Substring(v1.Length - 5, 4)
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = v1.Substring(v1.Length - 5, 4)
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = v1.Substring(v1.Length - 5, 4)
            End If
            If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                AH.Text = InputBox("Enter the value for AH accumalator")
                AL.Text = InputBox("Enter the value for AL accumalator")
                If AH.Text.Length = 2 And AL.Text.Length = 2 Then
                    Dim n1 As String = AH.Text.ToUpper
                    Dim n2 As String = AL.Text.ToUpper
                    Dim sumn As String = n1 + n2
                    MsgBox(sumn)
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(sumn)
                    t5.Text = OverFlow()
                    Dim count As Integer = 0
                    For i As Integer = 0 To v2.Length - 1
                        If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To sumn.Length - 1

                        If f1.Contains(sumn.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next

                    If count = v2.Length And count1 = sumn.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim dec1 As Long = hex_to_dec(v2)
                    Dim dec2 As Long = hex_to_dec(sumn)
                    Dim decsum As Long = dec1 * dec2
                    Dim dechex As String = Hex(decsum)
                    mulflagsetting16(dechex)
                    Dim dechex1 As String = dechex + "H"
                    MsgBox(dechex1)
                    If dechex.Length = 8 Then
                        AH.Text = dechex.Substring(0, 2)
                        AL.Text = dechex.Substring(2, 2)
                        DH.Text = dechex.Substring(4, 2)
                        DL.Text = dechex.Substring(6, 2)
                    ElseIf dechex.Length = 7 Then
                        Dim dechexa As String = "0" + dechex
                        AH.Text = dechexa.Substring(0, 2)
                        AL.Text = dechexa.Substring(2, 2)
                        DH.Text = dechexa.Substring(4, 2)
                        DL.Text = dechexa.Substring(6, 2)
                    Else
                        MsgBox("Invalid value for result")
                    End If
                Else
                    MsgBox("Invalid value for accumalator")
                End If
            Else
                MsgBox("Invalid length of regstr value")
            End If

        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And c(0).Trim.ToUpper <> TextBox30.Text.Trim.ToUpper And c(1).Trim.ToUpper <> TextBox30.Text.Trim.ToUpper Then
            Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper + "Enter")
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                DH.Text = "00"
            End If
            If v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)
                AL.Text = InputBox("Enter the value for AL accumalator ")
                If AL.Text.Length = 2 Then
                    Dim n1 As String = AL.Text
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(n1)
                    t5.Text = OverFlow8()
                    Dim count As Integer = 0
                    For i As Integer = 0 To v2.Length - 1
                        If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To n1.Length - 1
                        If f1.Contains(n1.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    If count = v2.Length And count1 = n1.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim dec1 As Long = hex_to_dec(v2)
                    Dim dec2 As Long = hex_to_dec(n1)
                    Dim decsum As Long = dec1 * dec2
                    Dim dechex As String = Hex(decsum)
                    mulfalgsetting8(dechex)
                    Dim dechex1 As String = dechex + "H"
                    MsgBox(dechex1)
                    If dechex.Length = 4 Then
                        AH.Text = dechex.ToUpper.Substring(0, 2)
                        AL.Text = dechex.ToUpper.Substring(2, 2)
                    ElseIf dechex.Length = 3 Then
                        Dim dechexa As String = "0" + dechex
                        AH.Text = dechexa.ToUpper.Substring(0, 2)
                        AL.Text = dechexa.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid result")
                    End If
                Else
                    MsgBox("Invalid value for accumalator")
                End If
            Else
                MsgBox("Operand value is not in length")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.ToUpper.Trim) Or c.Contains(TextBox30.Text.ToUpper.Trim))) Then
            varmulregstrMode()
        Else
            MsgBox("Invlid for rg mode")
        End If
    End Sub
    Sub DivRegisterAddressing()
        If c.Contains(TextBox30.Text.Trim.ToUpper) And b(0).Trim.ToUpper <> TextBox30.Text.Trim.ToUpper Then
            Dim v1 As String = InputBox("enter the value(8)" + TextBox30.Text.Trim.ToUpper)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DL.Text = v1.ToUpper.Substring(v1.Length - 3, 2)
                DH.Text = "00"
            End If
            If v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)
                AH.Text = InputBox("Enter the value for AH Accumalator")
                AL.Text = InputBox("Enter the value for AL Accumalator")
                If AH.Text.Length = 2 And AH.Text.Length = 2 Then
                    Dim n1 As String = AH.Text.ToUpper
                    Dim n2 As String = AL.Text.ToUpper
                    Dim sumn As String = n1 + n2
                    Dim count As Integer = 0
                    For i As Integer = 0 To v2.Length - 1
                        If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To sumn.Length - 1
                        If f1.Contains(sumn.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    If count = v2.Length And count1 = sumn.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim dec1 As Long = hex_to_dec(v2)                  
                    Dim dec2 As Long = hex_to_dec(sumn)                  
                    Dim s1 As Long
                    Dim s2 As Long
                    s1 = dec2 / dec1
                    s2 = dec2 Mod dec1
                    Dim sh1 As String
                    Dim sh2 As String
                    sh1 = Hex(s1)
                    sh2 = Hex(s2)
                    AL.Text = sh1
                    AH.Text = sh2
                Else
                    MsgBox("Invalid, accumalator value is nt in range")
                End If
            Else
                MsgBox("Invalid length for 8 bit register")
            End If
        ElseIf b.Contains(TextBox30.Text.Trim.ToUpper) And b(0).Trim.ToUpper <> TextBox30.Text.Trim.ToUpper Then
            Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper + "enter the value(16)")
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = v1.Substring(v1.Length - 5, 2)
                AL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = v1.Substring(v1.Length - 5, 2)
                BL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = v1.Substring(v1.Length - 5, 2)
                CL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = v1.Substring(v1.Length - 5, 2)
                DL.Text = v1.Substring(v1.Length - 3, 2)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = v1.Substring(v1.Length - 5, 4)
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = v1.Substring(v1.Length - 5, 4)
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = v1.Substring(v1.Length - 5, 4)
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = v1.Substring(v1.Length - 5, 4)
            End If
            If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                AH.Text = InputBox("Enter the value for AH register")
                AL.Text = InputBox("Enter the value for AL register")
                DH.Text = InputBox("Enter the value for DH register")
                DL.Text = InputBox("Enter the value for DL register")
                If AH.Text.Length = 2 And AL.Text.Length = 2 And DH.Text.Length = 2 And DL.Text.Length = 2 Then
                    Dim n1 As String = AH.Text.Trim.ToUpper
                    Dim n2 As String = AL.Text.Trim.ToUpper
                    Dim s1 As String = n1 + n2
                    Dim n3 As String = DH.Text.ToUpper
                    Dim n4 As String = DL.Text.ToUpper
                    Dim s2 As String = n3 + n4                  
                    Dim count As Integer = 0
                    For i As Integer = 0 To v2.Length - 1
                        If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To s1.Length - 1
                        If f1.Contains(s1.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To s2.Length - 1

                        If f1.Contains(s2.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v2.Length And count1 = s1.Length And count2 = s2.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim dec1 As Long = hex_to_dec(v2)
                    Dim dec2 As Long = hex_to_dec(s1)
                    Dim dec3 As Long = hex_to_dec(s2)
                    Dim dec4 As Long = dec2 * dec3
                    Dim s3 As Long = dec4 / dec1
                    Dim s4 As Long = dec4 Mod dec1
                    Dim sumh1 As String = Hex(s3)
                    Dim sumh2 As String = Hex(s4)

                    If sumh1.Length = 4 And sumh2.Length = 4 Then
                        AH.Text = sumh1.ToUpper.Substring(0, 2)
                        AL.Text = sumh1.ToUpper.Substring(2, 2)
                        DH.Text = sumh2.ToUpper.Substring(0, 2)
                        DL.Text = sumh2.ToUpper.Substring(2, 2)
                    ElseIf sumh1.Length = 4 And sumh2.Length = 3 Then
                        AH.Text = sumh1.ToUpper.Substring(0, 2)
                        AL.Text = sumh1.ToUpper.Substring(2, 2)
                        Dim sumh2a As String = "0" + sumh2
                        DH.Text = sumh2a.ToUpper.Substring(0, 2)
                        DL.Text = sumh2a.ToUpper.Substring(2, 2)
                    ElseIf sumh1.Length = 3 And sumh2.Length = 4 Then
                        Dim sumh1a As String = "0" + sumh1
                        AH.Text = sumh1a.ToUpper.Substring(0, 2)
                        AL.Text = sumh1a.ToUpper.Substring(2, 2)
                        DH.Text = sumh2.ToUpper.Substring(0, 2)
                        DL.Text = sumh2.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid result")
                    End If
                Else
                    MsgBox("Invlid value for 32 bitt register")
                End If
            Else
                MsgBox("Invalid length of regstr value")
            End If
        Else
            MsgBox("Invalid regstr addnsing div mode")
        End If
    End Sub
    Sub AddRegisterAddressing()
        Dim regadd1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim regadd2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (regadd1.ToUpper.Length = 5) And (regadd1.ToUpper.Trim.EndsWith("h") Or regadd1.ToUpper.Trim.EndsWith("H"))) And (b.Contains(TextBox32.Text.Trim.ToUpper) And (regadd2.ToUpper.Length = 5 And (regadd2.ToUpper.Trim.EndsWith("h") Or regadd2.ToUpper.Trim.EndsWith("H")))) Then
            Dim regadd3 As String = regadd1.ToUpper.Substring(0, 4)
            Dim regadd4 As String = regadd2.ToUpper.Substring(0, 4)
            binOp1 = hex_to_bin(regadd3)
            binOp2 = hex_to_bin(regadd4)
            t5.Text = OverFlow()
            Dim count As Integer = 0
            For i As Integer = 0 To regadd3.Length - 1

                If f1.Contains(regadd3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To regadd4.Length - 1

                If f1.Contains(regadd4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = regadd3.Length And count1 = regadd4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim regdec1 As Long = hex_to_dec(regadd3)
            Dim regdec2 As Long = hex_to_dec(regadd4)
            Dim regdecsum As Long = regdec1 + regdec2
            Dim reghex As String = Hex(regdecsum)
            AddFlagSetting(reghex)
            If (b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper)) Then

                AH.Text = reghex.Substring(0, 2)
                AL.Text = reghex.Substring(2, 2)

            ElseIf (b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper)) Then

                BH.Text = reghex.Substring(0, 2)
                BL.Text = reghex.Substring(2, 2)

            ElseIf (b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper)) Then

                CH.Text = reghex.Substring(0, 2)
                CL.Text = reghex.Substring(2, 2)

            ElseIf (b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper)) Then

                DH.Text = reghex.Substring(0, 2)
                DL.Text = reghex.Substring(2, 2)

            ElseIf (b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SI.Text = reghex
            ElseIf (b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DI.Text = reghex
            ElseIf (b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = reghex
            ElseIf (b(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = reghex
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If

        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (regadd1.ToUpper.Length = 3) And (regadd1.ToUpper.Trim.EndsWith("h") Or regadd1.ToUpper.Trim.EndsWith("H"))) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (regadd2.ToUpper.Length = 3 And (regadd2.ToUpper.Trim.EndsWith("h") Or regadd2.ToUpper.Trim.EndsWith("H")))) Then
            Dim regadd3 As String = regadd1.ToUpper.Substring(0, 2)
            Dim regadd4 As String = regadd2.ToUpper.Substring(0, 2)
            binOp1 = hex_to_bin(regadd3)
            binOp2 = hex_to_bin(regadd4)
            t5.Text = OverFlow8()
            Dim count As Integer = 0
            For i As Integer = 0 To regadd3.Length - 1
                If f1.Contains(regadd3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To regadd4.Length - 1
                If f1.Contains(regadd4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = regadd3.Length And count1 = regadd4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            End If
            Dim regdec1 As Long = hex_to_dec(regadd3)
            Dim regdec2 As Long = hex_to_dec(regadd4)
            Dim regdecsum As Long = regdec1 + regdec2
            Dim reghex1 As String = Hex(regdecsum)
            addflagsetting8(reghex1)
            Dim reghex As String = reghex1 + "H"
            If (c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper)) Then

                AH.Text = reghex.Substring(0, 3)
                AL.Text = "00"


            ElseIf (c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper)) Then

                AL.Text = reghex.Substring(0, 3)
                AH.Text = "00"

            ElseIf (c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper)) Then

                BH.Text = reghex.Substring(0, 3)
                BL.Text = "00"

            ElseIf (c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper)) Then

                BL.Text = reghex.Substring(0, 3)
                BH.Text = "00"

            ElseIf (c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = reghex.Substring(0, 3)
                CL.Text = "00"
            ElseIf (c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CL.Text = reghex.Substring(0, 3)
                CH.Text = "00"
            ElseIf (c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = reghex.Substring(0, 3)
                DL.Text = "00"
            ElseIf (c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DL.Text = reghex.Substring(0, 3)
                DH.Text = "00"
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddregadd()
        Else
            MsgBox("invalid regstr")
        End If
    End Sub
    Sub SubRegisterAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) And (b.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 5 And (v2.ToUpper.Trim.EndsWith("h") Or v2.ToUpper.Trim.EndsWith("H")))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4) 
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v3 > v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)
                Dim subdec2 As Long = hex_to_dec(v4)
                Dim subdec As Long = subdec1 - subdec2
                Dim subhex As String = Hex(subdec)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow()
                subflagsetting(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If ((b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        AH.Text = subhex.ToUpper.Substring(0, 2)
                        AL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        BH.Text = subhex.ToUpper.Substring(0, 2)
                        BL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        CH.Text = subhex.ToUpper.Substring(0, 2)
                        CL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        DH.Text = subhex.ToUpper.Substring(0, 2)
                        DL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SI.Text = subhex1
                ElseIf ((b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    DI.Text = subhex1
                ElseIf ((b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SP.Text = subhex1
                ElseIf ((b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    BP.Text = subhex1
                Else
                    MsgBox("Invalid register combination")
                End If

            ElseIf v3 <= v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)
                Dim subdec2 As Long = hex_to_dec(v4)
                Dim subdec As Long = subdec1 - subdec2
                Dim subhex As String = Hex(subdec)                
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow()
                subflagsetting64(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)

                If ((b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        AH.Text = subhex.Substring(subhex.Length - 4, 2)
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        BH.Text = subhex.Substring(subhex.Length - 4, 2)
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        CH.Text = subhex.Substring(subhex.Length - 4, 2)
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length >= 4 Then
                        DH.Text = subhex.Substring(subhex.Length - 4, 2)
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SI.Text = subhex
                ElseIf ((b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    DI.Text = subhex
                ElseIf ((b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SP.Text = subhex
                ElseIf ((b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    BP.Text = subhex
                Else
                    MsgBox("Invalid register combination")
                End If
            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 3 And (v2.ToUpper.Trim.EndsWith("h") Or v2.ToUpper.Trim.EndsWith("H")))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v3 > v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subdec As Long = subdec1 - subdec2

                Dim subhex As String = Hex(subdec)
                MsgBox(subhex)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow8()
                subflagsetting8(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If ((c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        AH.Text = subhex
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        AL.Text = subhex
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        BH.Text = subhex
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        BL.Text = subhex
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        CH.Text = subhex
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        CL.Text = subhex
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        DH.Text = subhex
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        DL.Text = subhex
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v3 <= v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subdec As Long = subdec1 - subdec2

                Dim subhex As String = Hex(subdec)
                MsgBox(subhex)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow8()
                subflagsetting16(subhex)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If ((c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        AH.Text = subhex.Substring(subhex.Length - 2, 2)
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        BH.Text = subhex.Substring(subhex.Length - 2, 2)
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        CH.Text = subhex.Substring(subhex.Length - 2, 2)
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        DH.Text = subhex.Substring(subhex.Length - 2, 2)
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubregMode()
        Else
            MsgBox("invalid regsiter  sub")
        End If
    End Sub
    Sub IncRegisterAddressing()
        If b.Contains(TextBox30.Text.Trim.ToUpper) Then
            Dim v1 As String = InputBox(TextBox30.Text)
            If v1.Length = 5 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 + 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow()
                incflagsetting(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If dech.Length = 4 Then
                        AH.Text = dech.ToUpper.Substring(0, 2)
                        AL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        AH.Text = decha.ToUpper.Substring(0, 2)
                        AL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If dech.Length = 4 Then
                        BH.Text = dech.ToUpper.Substring(0, 2)
                        BL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        BH.Text = decha.ToUpper.Substring(0, 2)
                        BL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If dech.Length = 4 Then
                        CH.Text = dech.ToUpper.Substring(0, 2)

                        CL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        CH.Text = decha.ToUpper.Substring(0, 2)
                        CL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If dech.Length = 4 Then
                        DH.Text = dech.ToUpper.Substring(0, 2)
                        DL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        DH.Text = decha.ToUpper.Substring(0, 2)
                        DL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    If dech.Length = 4 Then
                        SI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    If dech.Length = 4 Then
                        DI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        DI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    If dech.Length = 4 Then
                        SP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    If dech.Length = 4 Then
                        BP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        BP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            Else
                MsgBox("Invalid length")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) Then
            Dim v1 As String = InputBox(TextBox30.Text)

            If v1.Length = 3 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 + 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow8()
                incflagsetting8(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper.ToUpper = c(0) Then
                    If dech.Length = 2 Then
                        AH.Text = dech1.ToUpper
                        AL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AH.Text = decha1.ToUpper
                        AL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(1) Then
                    If dech.Length = 2 Then
                        AL.Text = dech1.ToUpper
                        AH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AL.Text = decha1.ToUpper
                        AH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(2) Then
                    If dech.Length = 2 Then
                        BH.Text = dech1.ToUpper
                        BL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BH.Text = decha1.ToUpper
                        BL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(3) Then
                    If dech.Length = 2 Then
                        BL.Text = dech1.ToUpper
                        BH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BL.Text = decha1.ToUpper
                        BH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(4) Then
                    If dech.Length = 2 Then
                        CH.Text = dech1.ToUpper
                        CL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CH.Text = decha1.ToUpper
                        CL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(5) Then
                    If dech.Length = 2 Then
                        CL.Text = dech1.ToUpper
                        CH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CL.Text = decha1.ToUpper
                        CH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(6) Then
                    If dech.Length = 2 Then
                        DH.Text = dech1.ToUpper
                        DL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DH.Text = decha1.ToUpper
                        DL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(7) Then
                    If dech.Length = 2 Then
                        DL.Text = dech1.ToUpper
                        DH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DL.Text = decha1.ToUpper
                        DH.Text = "00"
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            Else
                MsgBox("Invalid length")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varincrgstr()
        Else
            MsgBox("Invaid regtsr combination")
        End If
    End Sub
    Sub decregisteraddressingMode()
        If b.Contains(TextBox30.Text.Trim.ToUpper) Then
            Dim v1 As String = InputBox(TextBox30.Text)
            If v1 = "0000" Then
                MsgBox("invalid")
            End If
            If v1.Length = 5 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 - 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow()
                incflagsetting(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If dech.Length = 4 Then
                        AH.Text = dech.ToUpper.Substring(0, 2)
                        AL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        AH.Text = decha.ToUpper.Substring(0, 2)
                        AL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If dech.Length = 4 Then
                        BH.Text = dech.ToUpper.Substring(0, 2)

                        BL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        BH.Text = decha.ToUpper.Substring(0, 2)
                        BL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If dech.Length = 4 Then
                        CH.Text = dech.ToUpper.Substring(0, 2)
                        CL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        CH.Text = decha.ToUpper.Substring(0, 2)
                        CL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If dech.Length = 4 Then
                        DH.Text = dech.ToUpper.Substring(0, 2)
                        DL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        DH.Text = decha.ToUpper.Substring(0, 2)
                        DL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    If dech.Length = 4 Then
                        SI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    If dech.Length = 4 Then
                        DI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        DI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    If dech.Length = 4 Then
                        SP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    If dech.Length = 4 Then
                        BP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        BP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            Else
                MsgBox("Invalid length")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) Then
            Dim v1 As String = InputBox(TextBox30.Text)
            If v1.Length = 3 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 - 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow8()
                incflagsetting8(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper.ToUpper = c(0) Then
                    If dech.Length = 2 Then
                        AH.Text = dech1.ToUpper
                        AL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AH.Text = decha1.ToUpper
                        AL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(1) Then
                    If dech.Length = 2 Then
                        AL.Text = dech1.ToUpper
                        AH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AL.Text = decha1.ToUpper
                        AH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(2) Then
                    If dech.Length = 2 Then
                        BH.Text = dech1.ToUpper
                        BL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BH.Text = decha1.ToUpper
                        BL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(3) Then
                    If dech.Length = 2 Then
                        BL.Text = dech1.ToUpper
                        BH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BL.Text = decha1.ToUpper
                        BH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(4) Then
                    If dech.Length = 2 Then
                        CH.Text = dech1.ToUpper
                        CL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CH.Text = decha1.ToUpper
                        CL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(5) Then
                    If dech.Length = 2 Then
                        CL.Text = dech1.ToUpper
                        CH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CL.Text = decha1.ToUpper
                        CH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(6) Then
                    If dech.Length = 2 Then
                        DH.Text = dech1.ToUpper
                        DL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DH.Text = decha1.ToUpper
                        DL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(7) Then
                    If dech.Length = 2 Then
                        DL.Text = dech1.ToUpper
                        DH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DL.Text = decha1.ToUpper
                        DH.Text = "00"
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            Else
                MsgBox("Invalid length")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            vardecrgstrMode()
        Else
            MsgBox("Invaid regtsr combination")
        End If
    End Sub
    Sub NotRegisterAddressing()
        Label3.Visible = False
        Label4.Visible = False
        TextBox31.Visible = False
        TextBox32.Visible = False

        If b.Contains(TextBox30.Text.Trim.ToUpper) Then
            Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
            If v1.ToUpper.Length = 5 And v1.ToUpper.EndsWith("h") Or v1.ToUpper.EndsWith("H") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim fr As String = v2.ElementAt(0)
                Dim s1 As Long = hex_to_bin(v2)
                Dim s4 As String = s1.ToString
                Dim fr1() As String = New String() {"1"}
                Dim fr2() As String = New String() {"4", "5", "6", "7"}
                Dim fr3() As String = New String() {"2", "3"}
                Dim fr4() As String = New String() {"8", "9", "A", "B", "C", "D", "E", "F"}
                If fr = fr1(0) Then
                    Dim s2 As String = "000" + s4
                    Dim a() As Char = s2.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)
                    Dim res2 As String = Hex(res1)
                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                        AH.Text = res2.ToUpper.Substring(0, 2)
                        AL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                        BH.Text = res2.ToUpper.Substring(0, 2)
                        BL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                        CH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                        DH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        Dim res3 As String = res2 + "H"
                        SI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        Dim res3 As String = res2 + "H"
                        DI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        Dim res3 As String = res2 + "H"
                        SP.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        Dim res3 As String = res2 + "H"
                        BP.Text = res3
                    Else
                        MsgBox("inavld")
                    End If
                ElseIf fr = fr3(0) Or fr = fr3(1) Then
                    Dim s2 As String = "00" + s4            
                    Dim a() As Char = s2.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)
                    Dim res2 As String = Hex(res1)
                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                        AH.Text = res2.ToUpper.Substring(0, 2)
                        AL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                        BH.Text = res2.ToUpper.Substring(0, 2)
                        BL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                        CH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                        DH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        Dim res3 As String = res2 + "H"
                        SI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        Dim res3 As String = res2 + "H"
                        DI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        Dim res3 As String = res2 + "H"
                        SP.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        Dim res3 As String = res2 + "H"
                        BP.Text = res3
                    Else
                        MsgBox("inavld")
                    End If
                ElseIf fr = fr2(0) Or fr = fr2(1) Or fr = fr2(2) Or fr = fr2(3) Then
                    Dim s2 As String = "0" + s4
                    Dim a() As Char = s2.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)                  
                    Dim res2 As String = Hex(res1)       
                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                        AH.Text = res2.ToUpper.Substring(0, 2)
                        AL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                        BH.Text = res2.ToUpper.Substring(0, 2)
                        BL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                        CH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                        DH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        Dim res3 As String = res2 + "H"
                        SI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        Dim res3 As String = res2 + "H"
                        DI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        Dim res3 As String = res2 + "H"
                        SP.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        Dim res3 As String = res2 + "H"
                        BP.Text = res3
                    Else
                        MsgBox("inavld")
                    End If
                ElseIf fr4.Contains(fr) Then
                    Dim a() As Char = s4.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)
                    Dim res2 As String = Hex(res1)                 
                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                        AH.Text = res2.ToUpper.Substring(0, 2)
                        AL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                        BH.Text = res2.ToUpper.Substring(0, 2)
                        BL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                        CH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                        DH.Text = res2.ToUpper.Substring(0, 2)
                        DL.Text = res2.ToUpper.Substring(2, 2)
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        Dim res3 As String = res2 + "H"
                        SI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        Dim res3 As String = res2 + "H"
                        DI.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        Dim res3 As String = res2 + "H"
                        SP.Text = res3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        Dim res3 As String = res2 + "H"
                        BP.Text = res3
                    Else
                        MsgBox("inavld")
                    End If
                End If
            Else
                MsgBox("Invalid length")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) Then
            Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
            If v1.ToUpper.Length = 3 And v1.ToUpper.EndsWith("h") Or v1.ToUpper.EndsWith("H") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)


                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim fr As String = v2.ElementAt(0)
                Dim s1 As Long = hex_to_bin(v2)
                Dim s4 As String = s1.ToString
                Dim fr1() As String = New String() {"1"}
                Dim fr2() As String = New String() {"4", "5", "6", "7"}
                Dim fr3() As String = New String() {"2", "3"}
                Dim fr4() As String = New String() {"8", "9", "A", "B", "C", "D", "E", "F"}
                If fr = fr1(0) Then
                    Dim s2 As String = "000" + s4
                    Dim a() As Char = s2.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)
                    Dim res2 As String = Hex(res1)
                    Dim res3 As String = res2 + "H"
                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                        AH.Text = res3.ToUpper
                        AL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                        AL.Text = res3.ToUpper
                        AH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                        BH.Text = res3.ToUpper
                        BL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                        BL.Text = res3.ToUpper
                        BH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                        CH.Text = res3.ToUpper
                        CL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                        CL.Text = res3.ToUpper
                        CH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                        DH.Text = res3.ToUpper
                        DL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                        DL.Text = res3.ToUpper
                        DH.Text = "00"
                    Else
                        MsgBox("Invalid")
                    End If
                ElseIf fr3.Contains(fr) Then
                    Dim s2 As String = "00" + s4
                    Dim a() As Char = s2.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)
                    Dim res2 As String = Hex(res1)
                    Dim res3 As String = res2 + "H"
                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                        AH.Text = res3.ToUpper
                        AL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                        AL.Text = res3.ToUpper
                        AH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                        BH.Text = res3.ToUpper
                        BL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                        BL.Text = res3.ToUpper
                        BH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                        CH.Text = res3.ToUpper
                        CL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                        CL.Text = res3.ToUpper
                        CH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                        DH.Text = res3.ToUpper
                        DL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                        DL.Text = res3.ToUpper
                        DH.Text = "00"
                    Else
                        MsgBox("Invalid")
                    End If
                ElseIf fr2.Contains(fr) Then
                    Dim s2 As String = "0" + s4
                    Dim a() As Char = s2.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)
                    MsgBox(res1)
                    Dim res2 As String = Hex(res1)
                    MsgBox(res2)
                    Dim res3 As String = res2 + "H"
                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                        AH.Text = res3.ToUpper
                        AL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                        AL.Text = res3.ToUpper
                        AH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                        BH.Text = res3.ToUpper
                        BL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                        BL.Text = res3.ToUpper
                        BH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                        CH.Text = res3.ToUpper
                        CL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                        CL.Text = res3.ToUpper
                        CH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                        DH.Text = res3.ToUpper
                        DL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                        DL.Text = res3.ToUpper
                        DH.Text = "00"
                    Else
                        MsgBox("Invalid")
                    End If
                ElseIf fr4.Contains(fr) Then
                    Dim a() As Char = s4.ToString.ToCharArray
                    Dim negative As String = ""
                    For Each el As Char In a
                        If el = "1" Then
                            negative = negative + "0"
                        Else
                            negative = negative + "1"
                        End If
                    Next
                    MsgBox("Negative  : " + negative)
                    Dim res1 As String = bin_to_dec(negative)

                    Dim res2 As String = Hex(res1)

                    Dim res3 As String = res2 + "H"
                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                        AH.Text = res3.ToUpper
                        AL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                        AL.Text = res3.ToUpper
                        AH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                        BH.Text = res3.ToUpper
                        BL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                        BL.Text = res3.ToUpper
                        BH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                        CH.Text = res3.ToUpper
                        CL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                        CL.Text = res3.ToUpper
                        CH.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                        DH.Text = res3.ToUpper
                        DL.Text = "00"
                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                        DL.Text = res3.ToUpper
                        DH.Text = "00"
                    Else
                        MsgBox("Invalid")
                    End If
                End If
            Else
                MsgBox("Invalid length")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varnotregMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub adcrgstr()
        Dim regadd1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim regadd2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (regadd1.ToUpper.Length = 5) And (regadd1.ToUpper.Trim.EndsWith("h") Or regadd1.ToUpper.Trim.EndsWith("H"))) And (b.Contains(TextBox32.Text.Trim.ToUpper) And (regadd2.ToUpper.Length = 5 And (regadd2.ToUpper.Trim.EndsWith("h") Or regadd2.ToUpper.Trim.EndsWith("H")))) Then
            Dim regadd3 As String = regadd1.ToUpper.Substring(0, 4)

            Dim regadd4 As String = regadd2.ToUpper.Substring(0, 4)
            binOp1 = hex_to_bin(regadd3)
            binOp2 = hex_to_bin(regadd4)
            t5.Text = OverFlow()
            Dim count As Integer = 0
            For i As Integer = 0 To regadd3.Length - 1

                If f1.Contains(regadd3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To regadd4.Length - 1

                If f1.Contains(regadd4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = regadd3.Length And count1 = regadd4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim regdec1 As Long = hex_to_dec(regadd3)
            Dim regdec2 As Long = hex_to_dec(regadd4)
            Dim regdecsum As Long = regdec1 + regdec2
            Dim reghex1 As String = Hex(regdecsum)
            AddFlagSetting(reghex1)
            Dim p As String = t16.Text
            Dim p1 As Long = hex_to_dec(p)
            Dim p2 As Long = regdecsum + p1
            Dim reghex As String = Hex(p2)

            If (b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper)) Then

                AH.Text = reghex.Substring(0, 2)
                AL.Text = reghex.Substring(2, 2)

            ElseIf (b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper)) Then

                BH.Text = reghex.Substring(0, 2)
                BL.Text = reghex.Substring(2, 2)

            ElseIf (b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper)) Then

                CH.Text = reghex.Substring(0, 2)
                CL.Text = reghex.Substring(2, 2)

            ElseIf (b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper)) Then

                DH.Text = reghex.Substring(0, 2)
                DL.Text = reghex.Substring(2, 2)

            ElseIf (b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SI.Text = reghex
            ElseIf (b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DI.Text = reghex
            ElseIf (b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = reghex
            ElseIf (b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = reghex
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If

        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (regadd1.ToUpper.Length = 3) And (regadd1.ToUpper.Trim.EndsWith("h") Or regadd1.ToUpper.Trim.EndsWith("H"))) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (regadd2.ToUpper.Length = 3 And (regadd2.ToUpper.Trim.EndsWith("h") Or regadd2.ToUpper.Trim.EndsWith("H")))) Then
            Dim regadd3 As String = regadd1.ToUpper.Substring(0, 2)

            Dim regadd4 As String = regadd2.ToUpper.Substring(0, 2)
            binOp1 = hex_to_bin(regadd3)
            binOp2 = hex_to_bin(regadd4)
            t5.Text = OverFlow8()
            Dim count As Integer = 0
            For i As Integer = 0 To regadd3.Length - 1

                If f1.Contains(regadd3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To regadd4.Length - 1

                If f1.Contains(regadd4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = regadd3.Length And count1 = regadd4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            End If
            Dim regdec1 As Long = hex_to_dec(regadd3)
            Dim regdec2 As Long = hex_to_dec(regadd4)
            Dim regdecsum As Long = regdec1 + regdec2
            Dim reghex1 As String = Hex(regdecsum)
            addflagsetting8(reghex1)
            Dim p As String = t16.Text
            Dim p1 As Long = hex_to_dec(p)
            Dim p2 As Long = regdecsum + p1
            Dim reghex2 As String = Hex(p2)
            Dim reghex As String = reghex2 + "H"

            If (c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper)) Then

                AH.Text = reghex.Substring(0, 3)
                AL.Text = "00"


            ElseIf (c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper)) Then

                AL.Text = reghex.Substring(0, 3)
                AH.Text = "00"

            ElseIf (c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper)) Then

                BH.Text = reghex.Substring(0, 3)
                BL.Text = "00"

            ElseIf (c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper)) Then

                BL.Text = reghex.Substring(0, 3)
                BH.Text = "00"

            ElseIf (c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = reghex.Substring(0, 3)
                CL.Text = "00"
            ElseIf (c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CL.Text = reghex.Substring(0, 3)
                CH.Text = "00"
            ElseIf (c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = reghex.Substring(0, 3)
                DL.Text = "00"
            ElseIf (c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DL.Text = reghex.Substring(0, 3)
                DH.Text = "00"
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddregadd()
        Else
            MsgBox("invalid regstr")
        End If
    End Sub
    Sub xchgregaddsngMode()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)

        If v1.Length = 5 And v2.Length = 5 Then
            Dim v3 As String = v1.Trim.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.Trim.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v2 + "H"
            If TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(1) Then

                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)
                BH.Text = v3.Substring(0, 2)
                BL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(2) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)
                CH.Text = v3.Substring(0, 2)
                CL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(3) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)
                DH.Text = v3.Substring(0, 2)
                DL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(4) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)

                SI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(5) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)

                DI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(6) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)

                SP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(0) And TextBox32.Text.ToUpper = b(7) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)

                BP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(0) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)
                AH.Text = v3.Substring(0, 2)
                AL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(2) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)
                CH.Text = v3.Substring(0, 2)
                CL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(3) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)
                DH.Text = v3.Substring(0, 2)
                DL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(4) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)

                SI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(5) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)

                DI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(6) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)

                SP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(1) And TextBox32.Text.ToUpper = b(7) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)

                BP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(0) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)
                AH.Text = v3.Substring(0, 2)
                AL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(1) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)
                BH.Text = v3.Substring(0, 2)
                BL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(3) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)
                DH.Text = v3.Substring(0, 2)
                DL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(4) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)

                SI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(5) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)

                DI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(6) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)

                SP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(2) And TextBox32.Text.ToUpper = b(7) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)

                BP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(0) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)
                AH.Text = v3.Substring(0, 2)
                AL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(1) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)
                BH.Text = v3.Substring(0, 2)
                BL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(2) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)
                CH.Text = v3.Substring(0, 2)
                CL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(4) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)

                SI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(5) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)

                DI.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(6) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)

                SP.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(3) And TextBox32.Text.ToUpper = b(7) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)

                BP.Text = v5.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(0) Then
                SI.Text = v5.ToUpper
                AH.Text = v4.ToUpper.Substring(0, 2)
                AL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(1) Then
                SI.Text = v5.ToUpper
                BH.Text = v4.ToUpper.Substring(0, 2)
                BL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(2) Then
                SI.Text = v5.ToUpper
                CH.Text = v4.ToUpper.Substring(0, 2)
                CL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(3) Then
                SI.Text = v5.ToUpper
                DH.Text = v4.ToUpper.Substring(0, 2)
                DL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(5) Then
                SI.Text = v5.ToUpper
                DI.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(6) Then
                SI.Text = v5.ToUpper
                SP.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) And TextBox32.Text.Trim.ToUpper = b(7) Then
                SI.Text = v5.ToUpper
                BP.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(0) Then
                DI.Text = v5.ToUpper
                AH.Text = v4.ToUpper.Substring(0, 2)
                AL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(1) Then
                DI.Text = v5.ToUpper
                BH.Text = v4.ToUpper.Substring(0, 2)
                BL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(2) Then
                DI.Text = v5.ToUpper
                CH.Text = v4.ToUpper.Substring(0, 2)
                CL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(3) Then
                DI.Text = v5.ToUpper
                DH.Text = v4.ToUpper.Substring(0, 2)
                DL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(4) Then
                DI.Text = v5.ToUpper
                SI.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(6) Then
                DI.Text = v5.ToUpper
                SP.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) And TextBox32.Text.Trim.ToUpper = b(7) Then
                DI.Text = v5.ToUpper
                BP.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(0) Then
                SP.Text = v5.ToUpper
                AH.Text = v4.ToUpper.Substring(0, 2)
                AL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(1) Then
                SP.Text = v5.ToUpper
                BH.Text = v4.ToUpper.Substring(0, 2)
                BL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(2) Then
                SP.Text = v5.ToUpper
                CH.Text = v4.ToUpper.Substring(0, 2)
                CL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(3) Then
                SP.Text = v5.ToUpper
                DH.Text = v4.ToUpper.Substring(0, 2)
                DL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(4) Then
                SP.Text = v5.ToUpper
                SI.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(5) Then
                SP.Text = v5.ToUpper
                DI.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) And TextBox32.Text.Trim.ToUpper = b(7) Then
                SP.Text = v5.ToUpper
                BP.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(0) Then
                BP.Text = v5.ToUpper
                AH.Text = v4.ToUpper.Substring(0, 2)
                AL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(1) Then
                BP.Text = v5.ToUpper
                BH.Text = v4.ToUpper.Substring(0, 2)
                BL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(2) Then
                BP.Text = v5.ToUpper
                CH.Text = v4.ToUpper.Substring(0, 2)
                CL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(3) Then
                BP.Text = v5.ToUpper
                DH.Text = v4.ToUpper.Substring(0, 2)
                DL.Text = v4.ToUpper.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(4) Then
                BP.Text = v5.ToUpper
                SI.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(5) Then
                BP.Text = v5.ToUpper
                DI.Text = v4.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) And TextBox32.Text.Trim.ToUpper = b(7) Then
                BP.Text = v5.ToUpper
                SP.Text = v4.ToUpper
            Else
                MsgBox("Invalid")
            End If
        ElseIf v1.Length = 3 And v2.Length = 3 Then
            Dim v3 As String = v1.Trim.ToUpper.Substring(0, 2)


            Dim v4 As String = v2.Trim.ToUpper.Substring(0, 2)


            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v3 + "H"
            Dim v6 As String = v4 + "H"

            If TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(1) Then
                AH.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(2) Then
                AH.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(3) Then
                AH.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(4) Then
                AH.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(5) Then
                AH.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(6) Then
                AH.Text = v6.ToUpper
                DH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(0) And TextBox32.Text.ToUpper = c(7) Then
                AH.Text = v6.ToUpper
                DL.Text = v5.ToUpper


            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(0) Then
                AL.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(2) Then
                AL.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(3) Then
                AL.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(4) Then
                AL.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(5) Then
                AL.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(6) Then
                AL.Text = v6.ToUpper
                DH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(1) And TextBox32.Text.ToUpper = c(7) Then
                AL.Text = v6.ToUpper
                DL.Text = v5.ToUpper



            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(0) Then
                BH.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(1) Then
                BH.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(3) Then
                BH.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(4) Then
                BH.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(5) Then
                BH.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(6) Then
                BH.Text = v6.ToUpper
                DH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(2) And TextBox32.Text.ToUpper = c(7) Then
                BH.Text = v6.ToUpper
                DL.Text = v5.ToUpper

            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(0) Then
                BL.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(1) Then
                BL.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(2) Then
                BL.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(4) Then
                BL.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(5) Then
                BL.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(6) Then
                BL.Text = v6.ToUpper
                DH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(3) And TextBox32.Text.ToUpper = c(7) Then
                BL.Text = v6.ToUpper
                DL.Text = v5.ToUpper

            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(0) Then
                CH.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(1) Then
                CH.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(2) Then
                CH.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(3) Then
                CH.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(5) Then
                CH.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(6) Then
                CH.Text = v6.ToUpper
                DH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(4) And TextBox32.Text.ToUpper = c(7) Then
                CH.Text = v6.ToUpper
                DL.Text = v5.ToUpper


            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(0) Then
                CL.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(1) Then
                CL.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(2) Then
                CL.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(3) Then
                CL.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(4) Then
                CL.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(6) Then
                CL.Text = v6.ToUpper
                DH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(5) And TextBox32.Text.ToUpper = c(7) Then
                CL.Text = v6.ToUpper
                DL.Text = v5.ToUpper

            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(0) Then
                DH.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(1) Then
                DH.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(2) Then
                DH.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(3) Then
                DH.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(4) Then
                DH.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(5) Then
                DH.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(6) And TextBox32.Text.ToUpper = c(7) Then
                DH.Text = v6.ToUpper
                DL.Text = v5.ToUpper

            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(0) Then
                DL.Text = v6.ToUpper
                AH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(1) Then
                DL.Text = v6.ToUpper
                AL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(2) Then
                DL.Text = v6.ToUpper
                BH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(3) Then
                DL.Text = v6.ToUpper
                BL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(4) Then
                DL.Text = v6.ToUpper
                CH.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(5) Then
                DL.Text = v6.ToUpper
                CL.Text = v5.ToUpper
            ElseIf TextBox30.Text.ToUpper = c(7) And TextBox32.Text.ToUpper = c(6) Then
                DL.Text = v6.ToUpper
                DH.Text = v5.ToUpper

            Else
                MsgBox("Invalid combination of register")
            End If
        Else
            MsgBox("Invad register combination")
        End If
    End Sub
    Sub negrgstr()
        Dim v1 As String = InputBox("Enter the value for destination" + TextBox30.Text.ToUpper)
        MsgBox(v1)
        If v1.Length = 5 Then
            Dim v2 As String = v1.Substring(0, 4)
            Dim dest As String = hex_to_bin(v2)
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Then
                    result = result + "0"
                Else
                    result = result + "1"
                End If
            Next
            MsgBox("Neg Result is " + result)
            Dim v6 As String = result
            Dim V5 As Long = bin_to_dec(v6)
            Dim V8 As String = V5 + 1
            Dim v9 As String = Hex(V8)
            MsgBox(v9)
            negflagsetting(v2)
            If TextBox30.Text.ToUpper = b(0) Then
                AH.Text = v9.Substring(0, 2)
                AL.Text = v9.Substring(2, 4)
            ElseIf TextBox30.Text.ToUpper = b(1) Then
                BH.Text = v9.Substring(0, 2)
                BL.Text = v9.Substring(2, 4)
            ElseIf TextBox30.Text.ToUpper = b(2) Then
                CH.Text = v9.Substring(0, 2)
                CL.Text = v9.Substring(2, 4)
            ElseIf TextBox30.Text.ToUpper = b(3) Then
                DH.Text = v9.Substring(0, 2)
                DL.Text = v9.Substring(2, 4)
            ElseIf TextBox30.Text.ToUpper = b(4) Then
                SI.Text = v9.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(5) Then
                DI.Text = v9.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(6) Then
                SP.Text = v9.ToUpper
            ElseIf TextBox30.Text.ToUpper = b(7) Then
                BP.Text = v9.ToUpper
            Else
                MsgBox("Invalid regster")
            End If
        ElseIf v1.Length = 3 Then
            Dim v2 As String = v1.Substring(0, 2)
            Dim dest As String = hex_to_bin(v2)
            MsgBox(dest)
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Then
                    result = result + "0"
                Else
                    result = result + "1"
                End If
            Next
            MsgBox("Neg Result is " + result)
            Dim v6 As String = result
            Dim V5 As Long = bin_to_dec(v6)
            Dim V8 As String = V5 + 1
            Dim v9 As String = Hex(V8)
            MsgBox(v9)
            negflagsetting(v2)
            If TextBox30.Text.ToUpper = c(0) Then
                AH.Text = v9.Substring(v9.Length - 2, 2)
                AL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(1) Then
                AL.Text = v9.Substring(v9.Length - 2, 2)
                AH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(2) Then
                BH.Text = v9.Substring(v9.Length - 2, 2)
                BL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(3) Then
                BL.Text = v9.Substring(v9.Length - 2, 2)
                BH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(4) Then
                CH.Text = v9.Substring(v9.Length - 2, 2)
                CL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(5) Then
                CL.Text = v9.Substring(v9.Length - 2, 2)
                CH.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(6) Then
                DH.Text = v9.Substring(v9.Length - 2, 2)
                DL.Text = "00"
            ElseIf TextBox30.Text.ToUpper = c(7) Then
                DL.Text = v9.Substring(v9.Length - 2, 2)
                DH.Text = "00"
            Else
                MsgBox("Invalid regster")
            End If
        End If
    End Sub
    Sub testrgstr()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox("enter the value for" + TextBox32.Text.Trim.ToUpper)

        If v1.Length = 5 And v2.Length = 5 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 4)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As String = hex_to_bin(v3)
            MsgBox(s1)
            Dim s2 As String = hex_to_bin(v4)
            MsgBox(s2)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            MsgBox(r)
            Dim r1 As String = hexa(r)
            MsgBox(r1)

            testflagsetting(r1)

        ElseIf v1.Length = 3 And v2.Length = 3 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 2)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 2)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim s1 As String = hex_to_bin(v3)
            MsgBox(s1)
            Dim s2 As String = hex_to_bin(v4)
            MsgBox(s2)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            MsgBox(r)
            Dim r1 As String = hex8(r)
            MsgBox(r1)
            testflagsetting8(r1)

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandreg()
        Else
            MsgBox("Invalid combination of register")
        End If

    End Sub
    Sub sbbregstr()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        MsgBox((b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) And (b.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 5 And (v2.ToUpper.Trim.EndsWith("h") Or v2.ToUpper.Trim.EndsWith("H")))))
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) And (b.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 5 And (v2.ToUpper.Trim.EndsWith("h") Or v2.ToUpper.Trim.EndsWith("H")))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v3 > v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)
                Dim subdec2 As Long = hex_to_dec(v4)
                Dim subdec As Long = subdec1 - subdec2
                Dim subhex2 As String = Hex(subdec)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow()
                subflagsetting(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subdec - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                If ((b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length = 4 Then
                        AH.Text = subhex.ToUpper.Substring(0, 2)
                        AL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length = 4 Then
                        BH.Text = subhex.ToUpper.Substring(0, 2)
                        BL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length = 4 Then
                        CH.Text = subhex.ToUpper.Substring(0, 2)
                        CL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex.Length = 4 Then
                        DH.Text = subhex.ToUpper.Substring(0, 2)
                        DL.Text = subhex.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SI.Text = subhex
                ElseIf ((b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    DI.Text = subhex
                ElseIf ((b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SP.Text = subhex
                ElseIf ((b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    BP.Text = subhex
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v3 <= v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)
                Dim subdec2 As Long = hex_to_dec(v4)
                Dim subdec As Long = subdec1 - subdec2
                Dim subhex2 As String = Hex(subdec)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow()
                subflagsetting64(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subdec - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                MsgBox(subhex1)
                If ((b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 4 Then
                        AH.Text = subhex.Substring(subhex.Length - 4, 2)
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 4 Then
                        BH.Text = subhex.Substring(subhex.Length - 4, 2)
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 4 Then
                        CH.Text = subhex.Substring(subhex.Length - 4, 2)
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 4 Then
                        DH.Text = subhex.Substring(subhex.Length - 4, 2)
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SI.Text = subhex
                ElseIf ((b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    DI.Text = subhex
                ElseIf ((b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    SP.Text = subhex
                ElseIf ((b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    BP.Text = subhex
                Else
                    MsgBox("Invalid register combination")
                End If

            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 3 And (v2.ToUpper.Trim.EndsWith("h") Or v2.ToUpper.Trim.EndsWith("H")))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v3 > v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subdec As Long = subdec1 - subdec2

                Dim subhex2 As String = Hex(subdec)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow8()
                subflagsetting8(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subdec - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"

                If ((c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        AH.Text = subhex1
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        AL.Text = subhex1
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        BH.Text = subhex1
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        BL.Text = subhex1
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        CH.Text = subhex1
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        CL.Text = subhex1
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        DH.Text = subhex1
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length = 3 Then
                        DL.Text = subhex1
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            ElseIf v3 <= v4 Then
                Dim subdec1 As Long = hex_to_dec(v3)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subdec As Long = subdec1 - subdec2

                Dim subhex2 As String = Hex(subdec)
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                subcar()
                binOp1 = hex_to_bin(v3)
                binOp2 = hex_to_bin(v4)
                t5.Text = OverFlow8()
                subflagsetting16(subhex2)
                Dim p As String = t16.Text
                Dim p1 As Long = hex_to_dec(p)
                Dim p2 As Long = subdec - p1
                Dim subhex As String = Hex(p2)
                Dim subhex1 As String = subhex + "H"
                If ((c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        AH.Text = subhex.Substring(subhex.Length - 2, 2)
                        AL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        AL.Text = subhex.Substring(subhex.Length - 2, 2)
                        AH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        BH.Text = subhex.Substring(subhex.Length - 2, 2)
                        BL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        BL.Text = subhex.Substring(subhex.Length - 2, 2)
                        BH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        CH.Text = subhex.Substring(subhex.Length - 2, 2)
                        CL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        CL.Text = subhex.Substring(subhex.Length - 2, 2)
                        CH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        DH.Text = subhex.Substring(subhex.Length - 2, 2)
                        DL.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                ElseIf ((c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper))) Then
                    If subhex1.Length >= 3 Then
                        DL.Text = subhex.Substring(subhex.Length - 2, 2)
                        DH.Text = "00"
                    Else
                        MsgBox("Inalid hex number")
                    End If
                Else
                    MsgBox("Invalid register combination")
                End If
            Else
                MsgBox("Inalid,Substraction cannot processed")
            End If

        Else
            MsgBox("invalid regsiter  sub")
        End If
    End Sub
    Sub cmpregstr()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("H"))) And (b.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 5 And (v2.ToUpper.Trim.EndsWith("H")))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4)
            If TextBox30.Text.Trim.ToUpper = b(0) Then
                AH.Text = v3.Substring(0, 2)
                AL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                BH.Text = v3.Substring(0, 2)
                BL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                CH.Text = v3.Substring(0, 2)
                CL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                DH.Text = v3.Substring(0, 2)
                DL.Text = v3.Substring(2, 2)
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                SI.Text = v3
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                DI.Text = v3
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                SP.Text = v3
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                BP.Text = v3
            Else
                MsgBox("Invalid 16 bit drct add register")
            End If
            If TextBox32.Text.Trim.ToUpper = b(0) Then
                AH.Text = v4.Substring(0, 2)
                AL.Text = v4.Substring(2, 2)
            ElseIf TextBox32.Text.Trim.ToUpper = b(1) Then
                BH.Text = v4.Substring(0, 2)
                BL.Text = v4.Substring(2, 2)
            ElseIf TextBox32.Text.Trim.ToUpper = b(2) Then
                CH.Text = v4.Substring(0, 2)
                CL.Text = v4.Substring(2, 2)
            ElseIf TextBox32.Text.Trim.ToUpper = b(3) Then
                DH.Text = v4.Substring(0, 2)
                DL.Text = v4.Substring(2, 2)
            ElseIf TextBox32.Text.Trim.ToUpper = b(4) Then
                SI.Text = v4
            ElseIf TextBox32.Text.Trim.ToUpper = b(5) Then
                DI.Text = v4
            ElseIf TextBox32.Text.Trim.ToUpper = b(6) Then
                SP.Text = v4
            ElseIf TextBox32.Text.Trim.ToUpper = b(7) Then
                BP.Text = v4
            Else
                MsgBox("Invalid 16 bit drct add register")
            End If
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim subdec1 As Long = hex_to_dec(v3)
            MsgBox(subdec1)
            Dim subdec2 As Long = hex_to_dec(v4)
            MsgBox(subdec2)
            cmpflagsetting(subdec1, subdec2)
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("H"))) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 3 And (v2.ToUpper.Trim.EndsWith("H")))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(0, 2)
            If TextBox30.Text.Trim.ToUpper = c(0) Then
                AH.Text = v3
                AL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                AL.Text = v3
                AH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                BH.Text = v3
                BL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                BL.Text = v3
                BH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                CH.Text = v3
                CL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                CL.Text = v3
                CH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                DH.Text = v3
                DL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                DL.Text = v3
                DH.Text = "00"
            Else
                MsgBox("Invalid 16 bit drct add register")
            End If
            If TextBox32.Text.Trim.ToUpper = c(0) Then
                AH.Text = v4
                AL.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(1) Then
                AL.Text = v4
                AH.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(2) Then
                BH.Text = v4
                BL.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(3) Then
                BL.Text = v4
                BH.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(4) Then
                CH.Text = v4
                CL.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(5) Then
                CL.Text = v4
                CH.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(6) Then
                DH.Text = v4
                DL.Text = "00"
            ElseIf TextBox32.Text.Trim.ToUpper = c(7) Then
                DL.Text = v4
                DH.Text = "00"
            Else
                MsgBox("Invalid 16 bit drct add register")
            End If
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim subdec1 As Long = hex_to_dec(v3)
            MsgBox(subdec1)
            Dim subdec2 As Long = hex_to_dec(v4)
            MsgBox(subdec2)
            cmpflagsetting(subdec1, subdec2)
        Else
            MsgBox("invalid regsiter  sub")
        End If
    End Sub
    Sub MOVdirctAddressing()
        If b.Contains(TextBox30.Text.ToUpper) And TextBox32.Text.Length = 7 Then
            Dim drctval As String = TextBox32.Text.ToUpper.Substring(1, 4)
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(drctval)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + drctval)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim S3 As String = TextBox32.Text
                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                        If S3.Length = 4 Then
                            AH.Text = S3.Substring(0, 2)
                            AL.Text = S3.Substring(2, 2)
                        ElseIf S3.Length = 2 Then
                            AH.Text = S3
                            AL.Text = "00"
                        Else
                            MsgBox("invalid drct ax value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                        If S3.Length = 4 Then
                            BH.Text = S3.Substring(0, 2)
                            BL.Text = S3.Substring(2, 2)
                        ElseIf S3.Length = 2 Then
                            BH.Text = S3.Substring(0, 2)
                            BL.Text = "00"
                        Else
                            MsgBox("invalid drct bx value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                        If S3.Length = 4 Then
                            CH.Text = S3.Substring(0, 2)
                            CL.Text = S3.Substring(2, 2)
                        ElseIf S3.Length = 2 Then
                            CH.Text = S3.Substring(0, 2)
                            CL.Text = "00"
                        Else
                            MsgBox("invalid drct cx value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                        If S3.Length = 4 Then
                            DH.Text = S3.Substring(0, 2)
                            DL.Text = S3.Substring(2, 2)
                        ElseIf S3.Length = 2 Then
                            DH.Text = S3.Substring(0, 2)
                            DL.Text = "00"
                        Else
                            MsgBox("invalid drct dx value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        SI.Text = S3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        DI.Text = S3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        SP.Text = S3
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        BP.Text = S3
                    Else
                        MsgBox("Invalid 16 bit drct add register")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        ElseIf c.Contains(TextBox30.Text.ToUpper) And TextBox32.Text.Length = 5 Then
            Dim drctval As String = TextBox32.Text.ToUpper.Substring(1, 2)
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(drctval)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + drctval)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s3 As String = TextBox32.Text
                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                        If s3.Length = 2 Then
                            AH.Text = s3
                            AL.Text = "00"
                        Else
                            MsgBox("invalid drct ah11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                        If s3.Length = 2 Then
                            AL.Text = s3
                            AH.Text = "00"
                        Else
                            MsgBox("invalid drct al11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                        If s3.Length = 2 Then
                            BH.Text = s3
                            BL.Text = "00"
                        Else
                            MsgBox("invalid drct bh11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                        If s3.Length = 2 Then
                            BL.Text = s3
                            BH.Text = "00"
                        Else
                            MsgBox("invalid drct bl11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                        If s3.Length = 2 Then
                            CH.Text = s3
                            CL.Text = "00"
                        Else
                            MsgBox("invalid drct ch11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                        If s3.Length = 2 Then
                            CL.Text = s3
                            CH.Text = "00"
                        Else
                            MsgBox("invalid drct cl11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                        If s3.Length = 2 Then
                            DH.Text = s3
                            DL.Text = "00"
                        Else
                            MsgBox("invalid drct dh11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                        If s3.Length = 2 Then
                            DL.Text = s3
                            DH.Text = "00"
                        Else
                            MsgBox("invalid drct dl11 value")
                        End If
                    Else
                        MsgBox("Invalid drct 8 bitt")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varmovdrctMode()
        Else
            MsgBox("Invalid mov drct address mode")
        End If
    End Sub
    Sub AddDirectAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        'MsgBox(b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H"))
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)

            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v3)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v3)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim drctadd1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(drctadd1)
                    t5.Text = OverFlow()
                    Dim decdrct1 As Long = hex_to_dec(drctadd1)
                    Dim decdrct2 As Long = hex_to_dec(v2)
                    Dim sumdrct As Long = decdrct1 + decdrct2
                    Dim sumhexdrct As String = Hex(sumdrct)
                    AddFlagSetting(sumhexdrct)
                    Dim sumhexdrct1 As String = sumhexdrct + "H"
                    If TextBox30.Text.Trim.ToUpper = b(0) Then

                        AH.Text = sumhexdrct.Substring(0, 2)
                        AL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then

                        BH.Text = sumhexdrct.Substring(0, 2)
                        BL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then

                        CH.Text = sumhexdrct.Substring(0, 2)
                        CL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then

                        DH.Text = sumhexdrct.Substring(0, 2)
                        DL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        SI.Text = sumhexdrct1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        DI.Text = sumhexdrct1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        SP.Text = sumhexdrct1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        BP.Text = sumhexdrct1
                    Else
                        MsgBox("INvalid destination register")
                    End If

                    Exit For
                Else
                End If
            Next
            'MsgBox(c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H"))
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v3)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v3)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim drctadd1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(drctadd1)
                    t5.Text = OverFlow8()
                    Dim decdrct1 As Long = hex_to_dec(drctadd1)
                    Dim decdrct2 As Long = hex_to_dec(v2)
                    Dim sumdrct As Long = decdrct1 + decdrct2
                    Dim sumhexdrct As String = Hex(sumdrct)
                    addflagsetting8(sumhexdrct)
                    Dim sumhexdrct1 As String = sumhexdrct + "H"
                    If TextBox30.Text.Trim.ToUpper = c(0) Then

                        AH.Text = sumhexdrct
                        AL.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                        AL.Text = sumhexdrct
                        AH.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                        BH.Text = sumhexdrct
                        BL.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                        BL.Text = sumhexdrct
                        BH.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                        CH.Text = sumhexdrct
                        CL.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                        CL.Text = sumhexdrct
                        CH.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                        DH.Text = sumhexdrct
                        DL.Text = "00"

                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                        DL.Text = sumhexdrct
                        DL.Text = "00"

                    Else
                        MsgBox("INvalid destination register")
                    End If

                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varadddrctMode()
        Else
            MsgBox("Inavlid direct add mode")
        End If

    End Sub
    Sub SubDirectAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then

            Dim v2 As String = TextBox32.Text.Trim.ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text.Trim.ToUpper
                    If v3 > s1 Then
                        Dim s2 As Long = hex_to_dec(s1)

                        Dim s3 As Long = hex_to_dec(v3)

                        Dim decsum As Long = s3 - s2

                        Dim dechex As String = hexa(decsum)
                        MsgBox(dechex)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        subflagsetting(dechex)
                        Dim dechex1 As String = dechex + "H"
                        MsgBox(dechex1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If dechex.Length >= 4 Then
                                AH.Text = dechex.ToUpper.Substring(0, 2)
                                AL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If dechex.Length >= 4 Then
                                BH.Text = dechex.ToUpper.Substring(0, 2)
                                BL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If dechex.Length >= 4 Then
                                CH.Text = dechex.ToUpper.Substring(0, 2)
                                DL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If dechex.Length >= 4 Then
                                DH.Text = dechex.ToUpper.Substring(0, 2)
                                DL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = dechex.ToUpper
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If
                    ElseIf v3 <= s1 Then
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim s3 As Long = hex_to_dec(v3)
                        Dim decsum As Long = s3 - s2
                        Dim dechex As String = hexa(decsum)
                        MsgBox(dechex)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        subflagsetting(dechex)
                        Dim dechex1 As String = dechex + "H"
                        MsgBox(dechex1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If dechex.Length >= 4 Then
                                AH.Text = dechex.Substring(dechex.Length - 4, 2)
                                AL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If dechex.Length >= 4 Then
                                BH.Text = dechex.Substring(dechex.Length - 4, 2)
                                BL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If dechex.Length >= 4 Then
                                CH.Text = dechex.Substring(dechex.Length - 4, 2)
                                CL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If dechex.Length >= 4 Then
                                DH.Text = dechex.Substring(dechex.Length - 4, 2)
                                DL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = dechex.ToUpper
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If
                    Else
                        MsgBox("Invalid, substraction cannot be performed")
                    End If
                End If
            Next

        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v2 As String = TextBox32.Text.Trim.ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If


            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(v4).Cells(1).Value = values1

                    TextBox32.Text = values1

                    Dim s1 As String = TextBox32.Text.ToUpper
                    If v3 > s1 Then
                        If s1.Length = 2 Then

                            Dim s2 As Long = hex_to_dec(s1)

                            Dim s3 As Long = hex_to_dec(v3)

                            Dim decsum As Long = s3 - s2

                            Dim dechex As String = hexa(decsum)
                            MsgBox(dechex)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            subflagsetting8(dechex)
                            Dim dechex1 As String = dechex + "H"
                            MsgBox(dechex1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                If dechex1.Length >= 3 Then
                                    AH.Text = dechex.ToUpper
                                    AL.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                If dechex1.Length >= 3 Then
                                    AL.Text = dechex.ToUpper
                                    AH.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                If dechex1.Length >= 3 Then
                                    BH.Text = dechex.ToUpper
                                    BL.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                If dechex1.Length >= 3 Then
                                    BL.Text = dechex.ToUpper
                                    BH.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                If dechex1.Length >= 3 Then
                                    CH.Text = dechex.ToUpper
                                    CL.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                If dechex1.Length >= 3 Then
                                    CL.Text = dechex.ToUpper
                                    CH.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                If dechex1.Length >= 3 Then
                                    DH.Text = dechex.ToUpper
                                    DL.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                If dechex1.Length >= 3 Then
                                    DL.Text = dechex.ToUpper
                                    CH.Text = "00"
                                Else
                                    MsgBox("Invalid value")
                                End If
                            Else
                                MsgBox("Invalid rgstr combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                    ElseIf v3 <= s1 Then
                        If s1.Length = 2 Then

                            Dim s2 As Long = hex_to_dec(s1)

                            Dim s3 As Long = hex_to_dec(v3)

                            Dim decsum As Long = s3 - s2

                            Dim dechex As String = hexa(decsum)
                            MsgBox(dechex)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            subflagsetting16(dechex)
                            Dim dechex1 As String = dechex + "H"
                            MsgBox(dechex1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                If dechex1.Length >= 3 Then
                                    AH.Text = dechex.Substring(dechex.Length - 2, 2)
                                    AL.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                If dechex1.Length >= 3 Then
                                    AL.Text = dechex.Substring(dechex.Length - 2, 2)
                                    AH.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                If dechex1.Length >= 3 Then
                                    BH.Text = dechex.Substring(dechex.Length - 2, 2)
                                    BL.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                If dechex1.Length >= 3 Then
                                    BL.Text = dechex.Substring(dechex.Length - 2, 2)
                                    BH.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                If dechex1.Length >= 3 Then
                                    CH.Text = dechex.Substring(dechex.Length - 2, 2)
                                    CL.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                If dechex1.Length >= 3 Then
                                    CL.Text = dechex.Substring(dechex.Length - 2, 2)
                                    CH.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                If dechex1.Length >= 3 Then
                                    DH.Text = dechex.Substring(dechex.Length - 2, 2)
                                    DL.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                If dechex1.Length >= 3 Then
                                    DL.Text = dechex.Substring(dechex.Length - 2, 2)
                                    CH.Text = "00"
                                Else
                                    MsgBox("In valid value")
                                End If

                            Else
                                MsgBox("Invalid substraction cannot be performed")
                            End If
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If
                    End If
                End If
            Next

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varsubdrct()
        Else
            MsgBox("invalid indirct sub")
        End If
    End Sub
    Sub anddrctMode()

        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            MsgBox(v2)
            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1

                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v2)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hexa(r)

                        andflagsetting(r1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            AH.Text = r1.ToUpper.Substring(0, 2)
                            AL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            BH.Text = r1.ToUpper.Substring(0, 2)
                            BL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            CH.Text = r1.ToUpper.Substring(0, 2)
                            CL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            DH.Text = r1.ToUpper.Substring(0, 2)
                            DL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = r1.ToUpper
                        Else
                            MsgBox("INvalid destination register")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)

            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v2)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hex8(r)

                        andflagsetting8(r1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                            AH.Text = r1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                            AL.Text = r1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                            BH.Text = r1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                            BL.Text = r1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                            CH.Text = r1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                            CL.Text = r1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                            DH.Text = r1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                            DL.Text = r1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("INvalid destination register")
                        End If
                    Else
                        MsgBox("Inavlid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varanddrctMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub ordirctMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v2)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hexa(r)
                        orflagsetting(r1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            AH.Text = r1.ToUpper.Substring(0, 2)
                            AL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            BH.Text = r1.ToUpper.Substring(0, 2)
                            BL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            CH.Text = r1.ToUpper.Substring(0, 2)
                            CL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            DH.Text = r1.ToUpper.Substring(0, 2)
                            DL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = r1.ToUpper
                        Else
                            MsgBox("INvalid destination register")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
          
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v2)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hex8(r)
                        orflagsetting8(r1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                            AH.Text = r1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                            AL.Text = r1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                            BH.Text = r1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                            BL.Text = r1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                            CH.Text = r1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                            CL.Text = r1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                            DH.Text = r1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                            DL.Text = r1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("INvalid destination register")
                        End If
                    Else
                        MsgBox("Inavlid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varordrct()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub adcdrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            MsgBox(v2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)
            MsgBox(v3)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v3)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v3)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim drctadd1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(drctadd1)
                    t5.Text = OverFlow()
                    Dim decdrct1 As Long = hex_to_dec(drctadd1)
                    Dim decdrct2 As Long = hex_to_dec(v2)
                    Dim sumdrct As Long = decdrct1 + decdrct2
                    Dim addhexsum As String = Hex(sumdrct)
                    AddFlagSetting(addhexsum)
                    Dim r1 As String = t16.Text
                    Dim r2 As Long = hex_to_dec(r1)
                    Dim r3 As Long = sumdrct + r2
                    Dim r4 As String = Hex(r3)
                    Dim sumhexdrct As String = r4
                    Dim sumhexdrct1 As String = sumhexdrct + "H"
                    If TextBox30.Text.Trim.ToUpper = b(0) Then

                        AH.Text = sumhexdrct.Substring(0, 2)
                        AL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then

                        BH.Text = sumhexdrct.Substring(0, 2)
                        BL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then

                        CH.Text = sumhexdrct.Substring(0, 2)
                        CL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then

                        DH.Text = sumhexdrct.Substring(0, 2)
                        DL.Text = sumhexdrct.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        SI.Text = sumhexdrct1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        DI.Text = sumhexdrct1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        SP.Text = sumhexdrct1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        BP.Text = sumhexdrct1
                    Else
                        MsgBox("INvalid destination register")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v3)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v3)
                    DataGridView1.Rows(v3).Cells(1).Value = values1
                    TextBox32.Text = values1

                    Dim drctadd1 As String = TextBox32.Text
                    If drctadd1.Length = 2 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(drctadd1)
                        t5.Text = OverFlow8()
                        Dim decdrct1 As Long = hex_to_dec(drctadd1)

                        Dim decdrct2 As Long = hex_to_dec(v2)

                        Dim sumdrct As Long = decdrct1 + decdrct2


                        Dim addhexsum As String = Hex(sumdrct)
                        AddFlagSetting(addhexsum)
                        Dim r1 As String = t16.Text

                        Dim r2 As Long = hex_to_dec(r1)
                        Dim r3 As String = sumdrct + r2

                        Dim r4 As String = Hex(r3)
                        Dim sumhexdrct As String = r4
                        Dim sumhexdrct1 As String = sumhexdrct + "H"
                        MsgBox(sumhexdrct1)

                        If TextBox30.Text.Trim.ToUpper = c(0) Then

                            AH.Text = sumhexdrct
                            AL.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                            AL.Text = sumhexdrct
                            AH.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                            BH.Text = sumhexdrct
                            BL.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                            BL.Text = sumhexdrct
                            BH.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                            CH.Text = sumhexdrct
                            CL.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                            CL.Text = sumhexdrct
                            CH.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                            DH.Text = sumhexdrct
                            DL.Text = "00"

                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                            DL.Text = sumhexdrct
                            DL.Text = "00"

                        Else
                            MsgBox("INvalid destination register")
                        End If
                    Else
                        MsgBox("Invalid length of the enterd value")
                    End If

                    Exit For
                Else

                End If
            Next

        Else
            MsgBox("Inavlid direct add mode")
        End If
    End Sub
    Sub xchgdrctMode()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
        If v1.Length = 5 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = TextBox32.Text.Trim.Substring(1, 5).ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    DataGridView1.Rows.Add(New String() {v4, v3})
                    TextBox32.Text = values1
                    Dim v6 As String = TextBox32.Text
                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                        If v6.Length = 4 Then
                            AH.Text = v6.Substring(0, 2)
                            AL.Text = v6.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            AH.Text = v7.Substring(0, 2)
                            AL.Text = v7.Substring(2, 2)
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                        If v6.Length = 4 Then
                            BH.Text = v6.Substring(0, 2)
                            BL.Text = v6.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            BH.Text = v7.Substring(0, 2)
                            BL.Text = v7.Substring(2, 2)
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                        If v6.Length = 4 Then
                            CH.Text = v6.Substring(0, 2)
                            CL.Text = v6.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            CH.Text = v7.Substring(0, 2)
                            CL.Text = v7.Substring(2, 2)
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                        If v6.Length = 4 Then
                            DH.Text = v6.Substring(0, 2)
                            DL.Text = v6.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            DH.Text = v7.Substring(0, 2)
                            DL.Text = v7.Substring(2, 2)
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                        If v6.Length = 4 Then
                            SI.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            SI.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                        If v6.Length = 4 Then
                            DI.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            DI.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                        If v6.Length = 4 Then
                            SP.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            BP.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                        If v6.Length = 4 Then
                            BP.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            BP.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid 16 bit regstr")
                        End If
                    Else
                        MsgBox("Invalid combination of register")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf v1.Length = 3 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = TextBox32.Text.Trim.Substring(1, 3).ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    DataGridView1.Rows.Add(New String() {v4, v3})
                    TextBox32.Text = values1
                    Dim v6 As String = TextBox32.Text
                    If v6.Length = 2 Then
                        Dim v7 As String = v6 + "H"
                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                            AH.Text = v6.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                            AL.Text = v6.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                            BH.Text = v6.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                            BL.Text = v6.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                            CH.Text = v6.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                            CL.Text = v6.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                            DH.Text = v6.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                            DL.Text = v6.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("Invalid combination")
                        End If
                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        Else
            MsgBox("Invalid combination")
        End If
    End Sub
    Sub testdrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)

            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        Dim s1 As String = hex_to_bin(v2)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        MsgBox(r)
                        Dim r1 As String = hexa(r)
                        MsgBox(r1)
                        testflagsetting(r1)

                    ElseIf u1.Length = 2 Then
                        Dim u2 As String = "00" + u1
                        Dim s1 As String = hex_to_bin(v2)

                        Dim s2 As String = hex_to_bin(u2)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hexa(r)

                        testflagsetting(r1)

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            MsgBox(v2)
            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        Dim s1 As String = hex_to_bin(v2)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        MsgBox(r)
                        Dim r1 As String = hex8(r)
                        MsgBox(r1)
                        testflagsetting8(r1)
                    Else
                        MsgBox("Inavlid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varanddrctMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub sbbdrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then

            Dim v2 As String = TextBox32.Text.Trim.ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v3 > v4 Then
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v4)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v4)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text.ToUpper
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim s3 As Long = hex_to_dec(v3)
                        Dim decsum As Long = s3 - s2
                        Dim subhex2 As String = Hex(decsum)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        subflagsetting(subhex2)
                        Dim p As String = t16.Text
                        Dim p1 As Long = hex_to_dec(p)
                        Dim p2 As Long = decsum - p1
                        Dim dechex As String = Hex(p2)
                        Dim dechex1 As String = dechex + "H"

                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If dechex.Length = 4 Then
                                AH.Text = dechex.ToUpper.Substring(0, 2)
                                AL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If dechex.Length = 4 Then
                                BH.Text = dechex.ToUpper.Substring(0, 2)
                                BL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If dechex.Length = 4 Then
                                CH.Text = dechex.ToUpper.Substring(0, 2)
                                DL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If dechex.Length = 4 Then
                                DH.Text = dechex.ToUpper.Substring(0, 2)
                                DL.Text = dechex.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = dechex.ToUpper
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If

                        Exit For
                    Else
                    End If
                Next
            ElseIf v3 <= v4 Then
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v4)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v4)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text.ToUpper
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim s3 As Long = hex_to_dec(v3)
                        Dim decsum As Long = s3 - s2
                        Dim subhex2 As String = Hex(decsum)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        subflagsetting64(subhex2)
                        Dim p As String = t16.Text
                        Dim p1 As Long = hex_to_dec(p)
                        Dim p2 As Long = decsum - p1
                        Dim dechex As String = Hex(p2)
                        Dim dechex1 As String = dechex + "H"

                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If dechex.Length >= 4 Then
                                AH.Text = dechex.Substring(dechex.Length - 4, 2)
                                AL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If dechex.Length >= 4 Then
                                BH.Text = dechex.Substring(dechex.Length - 4, 2)
                                BL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If dechex.Length >= 4 Then
                                CH.Text = dechex.Substring(dechex.Length - 4, 2)
                                CL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If dechex.Length >= 4 Then
                                DH.Text = dechex.Substring(dechex.Length - 4, 2)
                                DL.Text = dechex.Substring(dechex.Length - 2, 2)
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = dechex.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = dechex.ToUpper
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If
                        Exit For
                    Else
                    End If
                Next
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v2 As String = TextBox32.Text.Trim.ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v3 > v4 Then
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v4)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v4)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text.ToUpper
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim s3 As Long = hex_to_dec(v3)
                        Dim decsum As Long = s3 - s2
                        Dim subhex2 As String = Hex(decsum)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow8()
                        subflagsetting8(subhex2)
                        Dim p As String = t16.Text
                        Dim p1 As Long = hex_to_dec(p)
                        Dim p2 As Long = decsum - p1
                        Dim dechex As String = Hex(p2)
                        Dim dechex1 As String = dechex + "H"

                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                            If dechex1.Length = 3 Then
                                AH.Text = dechex1.ToUpper
                                AL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                            If dechex1.Length = 3 Then
                                AL.Text = dechex1.ToUpper
                                AH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                            If dechex1.Length = 3 Then
                                BH.Text = dechex1.ToUpper
                                BL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                            If dechex1.Length = 3 Then
                                BL.Text = dechex1.ToUpper
                                BH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                            If dechex1.Length = 3 Then
                                CH.Text = dechex1.ToUpper
                                CL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                            If dechex1.Length = 3 Then
                                CL.Text = dechex1.ToUpper
                                CH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                            If dechex1.Length = 3 Then
                                DH.Text = dechex1.ToUpper
                                DL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                            If dechex1.Length = 3 Then
                                DL.Text = dechex1.ToUpper
                                CH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If
                        Exit For
                    Else
                    End If
                Next
            ElseIf v3 <= v4 Then
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v4)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v4)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text.ToUpper
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim s3 As Long = hex_to_dec(v3)
                        Dim decsum As Long = s3 - s2
                        Dim subhex2 As String = Hex(decsum)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow8()
                        subflagsetting16(subhex2)
                        Dim p As String = t16.Text
                        Dim p1 As Long = hex_to_dec(p)
                        Dim p2 As Long = decsum - p1
                        Dim dechex As String = Hex(p2)
                        Dim dechex1 As String = dechex + "H"

                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                            If dechex1.Length = 3 Then
                                AH.Text = dechex.Substring(dechex.Length - 2, 2)
                                AL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                            If dechex1.Length = 3 Then
                                AL.Text = dechex.Substring(dechex.Length - 2, 2)
                                AH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                            If dechex1.Length = 3 Then
                                BH.Text = dechex.Substring(dechex.Length - 2, 2)
                                BL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                            If dechex1.Length = 3 Then
                                BL.Text = dechex.Substring(dechex.Length - 2, 2)
                                BH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                            If dechex1.Length = 3 Then
                                CH.Text = dechex.Substring(dechex.Length - 2, 2)
                                CL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                            If dechex1.Length = 3 Then
                                CL.Text = dechex.Substring(dechex.Length - 2, 2)
                                CH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                            If dechex1.Length = 3 Then
                                DH.Text = dechex.Substring(dechex.Length - 2, 2)
                                DL.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                            If dechex1.Length = 3 Then
                                DL.Text = dechex.Substring(dechex.Length - 2, 2)
                                DH.Text = "00"
                            Else
                                MsgBox("In valid value")
                            End If
                        Else
                            MsgBox("Invalid rgstr combination")
                        End If

                        Exit For
                    Else

                    End If
                Next
            Else
                MsgBox("invalid indirct sub")
            End If
        End If
    End Sub
    Sub cmpdrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v2 As String = TextBox32.Text.Trim.ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    DataGridView1.Rows.Add(New String() {v5, values1})
                    TextBox32.Text = values1

                    Dim s1 As String = TextBox32.Text.ToUpper

                    Dim s2 As Long = hex_to_dec(s1)

                    Dim s3 As Long = hex_to_dec(v3)
                    MsgBox(s3)
                    cmpflagsetting(s3, s2)
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next

        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v2 As String = TextBox32.Text.Trim.ToUpper

            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v5)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    DataGridView1.Rows.Add(New String() {v5, values1})
                    TextBox32.Text = values1

                    Dim s1 As String = TextBox32.Text.ToUpper

                    Dim s2 As Long = hex_to_dec(s1)

                    Dim s3 As Long = hex_to_dec(v3)
                    MsgBox(s3)
                    cmpflagsetting(s3, s2)
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next

        Else
            MsgBox("invalid indirct sub")
        End If
    End Sub
    Sub MOVregisterIndirect()
        Dim values As String = InputBox("enter the value" + TextBox32.Text)

        Dim invalues As String = values.Trim.ToUpper

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (invalues.Length = 7)) And (invalues.StartsWith("[") Or invalues.EndsWith("]")) And (invalues.ElementAt(5) = "h" Or invalues.ElementAt(5) = "H") Then
            Dim value1 As String = invalues.Trim.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To value1.Trim.Length - 1

                If f1.Contains(value1.ToUpper.Trim.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = value1.Trim.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(value1)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + value1)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim s3 As String = TextBox32.Text.ToUpper

                    If s3.Length = 4 Then
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            AH.Text = s3.Substring(0, 2)
                            AL.Text = s3.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            BH.Text = s3.Substring(0, 2)
                            BL.Text = s3.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            CH.Text = s3.Substring(0, 2)
                            CL.Text = s3.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            DH.Text = s3.Substring(0, 2)
                            DL.Text = s3.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = s3
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = s3
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = s3
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (value1.Trim.ToUpper.Substring(1, 2) = "BX") Or (value1.Trim.ToUpper.Substring(1, 2) = "SI") Or (value1.Trim.ToUpper.Substring(1, 2) = "DI") Or (value1.Trim.ToUpper.Substring(1, 2) = "SP") Or (value1.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = s3
                        Else
                            MsgBox("Inavlid register combination in register indirect addressing mode")

                        End If
                    Else
                        MsgBox("Invalid hexadecimal number")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (invalues.Length = 5)) And (invalues.StartsWith("[") Or invalues.EndsWith("]")) And (invalues.ElementAt(3) = "h" Or invalues.ElementAt(3) = "H") Then
            Dim value1 As String = invalues.Trim.ToUpper.Substring(0, 2)
            MsgBox(value1)
            Dim count As Integer = 0
            For i As Integer = 0 To value1.Trim.Length - 1

                If f1.Contains(value1.ToUpper.Trim.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = value1.Trim.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(value1)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + value1)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s3 As String = TextBox32.Text.ToUpper

                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                        If s3.Length = 2 Then
                            AH.Text = s3
                            AL.Text = "00"
                        Else
                            MsgBox("invalid drct ah11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                        If s3.Length = 2 Then
                            AL.Text = s3
                            AH.Text = "00"
                        Else
                            MsgBox("invalid drct al11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                        If s3.Length = 2 Then
                            BH.Text = s3
                            BL.Text = "00"
                        Else
                            MsgBox("invalid drct bh11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                        If s3.Length = 2 Then
                            BL.Text = s3
                            BH.Text = "00"
                        Else
                            MsgBox("invalid drct bl11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                        If s3.Length = 2 Then
                            CH.Text = s3
                            CL.Text = "00"
                        Else
                            MsgBox("invalid drct ch11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                        If s3.Length = 2 Then
                            CL.Text = s3
                            CH.Text = "00"
                        Else
                            MsgBox("invalid drct cl11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                        If s3.Length = 2 Then
                            DH.Text = s3
                            DL.Text = "00"
                        Else
                            MsgBox("invalid drct dh11 value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                        If s3.Length = 2 Then
                            DL.Text = s3
                            DH.Text = "00"
                        Else
                            MsgBox("invalid drct dl11 value")
                        End If
                    Else
                        MsgBox("Invalid drct 8 bitt")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varmovrgstrindrctMode()
        Else
            MsgBox("Invalid hexadecimal number")
        End If
    End Sub
    Sub AddRegisterIndirectAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox(v2)
        MsgBox(b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H"))
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(s1)
                    t5.Text = OverFlow()
                    Dim decs1 As Long = hex_to_dec(s1)
                    MsgBox(decs1)
                    Dim decs2 As Long = hex_to_dec(v3)
                    MsgBox(decs2)
                    Dim sumdec As String = decs1 + decs2
                    MsgBox(sumdec)

                    Dim sumhex As String = Hex(sumdec)
                    MsgBox(sumhex)
                    AddFlagSetting(sumhex)
                    Dim sumhex1 As String = sumhex + "H"
                    MsgBox(sumhex1)
                    If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        AH.Text = sumhex.Substring(0, 2)
                        AL.Text = sumhex.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        BH.Text = sumhex.Substring(0, 2)
                        BL.Text = sumhex.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        CH.Text = sumhex.Substring(0, 2)
                        CL.Text = sumhex.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        DH.Text = sumhex.Substring(0, 2)
                        DL.Text = sumhex.Substring(2, 2)

                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        SI.Text = sumhex1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        DI.Text = sumhex1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        SP.Text = sumhex1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        BP.Text = sumhex1
                    Else
                        MsgBox("Invalid reg combination")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text
                    If s1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow8()
                        Dim decs1 As Long = hex_to_dec(s1)
                        MsgBox(decs1)
                        Dim decs2 As Long = hex_to_dec(v3)
                        MsgBox(decs2)
                        Dim sumdec As String = decs1 + decs2
                        MsgBox(sumdec)
                        Dim sumhex As String = Hex(sumdec)
                        MsgBox(sumhex)
                        addflagsetting8(sumhex)
                        Dim sumhex1 As String = sumhex + "H"
                        MsgBox(sumhex1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            AH.Text = sumhex1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            AL.Text = sumhex1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            BH.Text = sumhex1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            BL.Text = sumhex1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            CH.Text = sumhex1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            CL.Text = sumhex1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            DH.Text = sumhex1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                            DL.Text = sumhex1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("Invalid combination")
                        End If
                    Else
                        MsgBox("Invalid hexadecimal")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddregindctMode()
        Else
            MsgBox("INvalid  register indirect add mode")
        End If
    End Sub
    Sub SubRegisterIndirectAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim k1 As String = TextBox32.Text.ToUpper

                    Dim k2 As Long = hex_to_dec(v3)

                    Dim k3 As Long = hex_to_dec(k1)

                    If k2 > k3 Then
                        Dim deff As Long = k2 - k3

                        Dim sumh As String = hexa(deff)
                        MsgBox(sumh)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        subflagsetting(sumh)
                        Dim sumh1 As String = sumh + "H"
                        MsgBox(sumh1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                AH.Text = sumh.Substring(0, 2)
                                AL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                BH.Text = sumh.Substring(0, 2)
                                BL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                CH.Text = sumh.Substring(0, 2)
                                CL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                DH.Text = sumh.Substring(0, 2)
                                DL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = sumh1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = sumh1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = sumh1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = sumh1
                        Else
                            MsgBox("Inavlid register combination in register indirect addressing mode")
                        End If
                    ElseIf k2 <= k3 Then
                        Dim deff As Long = k2 - k3

                        Dim sumh As String = hexa(deff)
                        MsgBox(sumh)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        subflagsetting(sumh)
                        Dim sumh1 As String = sumh + "H"
                        MsgBox(sumh1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                AH.Text = sumh.Substring(sumh.Length - 4, 2)
                                AL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                BH.Text = sumh.Substring(sumh.Length - 4, 2)
                                BL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                CH.Text = sumh.Substring(sumh.Length - 4, 2)
                                CL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                DH.Text = sumh.Substring(sumh.Length - 4, 2)
                                DL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = sumh
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = sumh
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = sumh
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = sumh
                        Else
                            MsgBox("Inavlid register combination in register indirect addressing mode")
                        End If
                    Else
                        MsgBox("sub cannot be performed")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(v4).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim k1 As String = TextBox32.Text.ToUpper
                    If k1.Length = 2 Then

                        Dim k2 As Long = hex_to_dec(v3)

                        Dim k3 As Long = hex_to_dec(k1)

                        If k2 > k3 Then
                            Dim deff As Long = k2 - k3

                            Dim sumh As String = hexa(deff)
                            MsgBox(sumh)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            subflagsetting8(sumh)
                            Dim sumh1 As String = sumh + "H"
                            MsgBox(sumh1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    AH.Text = sumh.ToUpper
                                    AL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    AL.Text = sumh.ToUpper
                                    AH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    BH.Text = sumh.ToUpper
                                    BL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    BL.Text = sumh.ToUpper
                                    BH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    CH.Text = sumh.ToUpper
                                    CL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    CL.Text = sumh.ToUpper
                                    CH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    DH.Text = sumh.ToUpper
                                    DL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    DL.Text = sumh.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            Else
                                MsgBox("Inavlid register combination in register indirect addressing mode")
                            End If
                        ElseIf k2 <= k3 Then
                            Dim deff As Long = k2 - k3
                            Dim sumh As String = hexa(deff)
                            MsgBox(sumh)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            subflagsetting16(sumh)
                            Dim sumh1 As String = sumh + "H"
                            MsgBox(sumh1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    AH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    AL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    AL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    AH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    BH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    BL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    BL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    BH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    CH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    CL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    CL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    CH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    DH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    DL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    DL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    DH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            Else
                                MsgBox("Inavlid register combination in register indirect addressing mode")
                            End If
                        Else
                            MsgBox("Sub cannot be performed")
                        End If

                    Else
                        MsgBox("Enterd value is not valid")
                    End If

                    Exit For
                Else

                End If
            Next

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubregindrctMode()
        Else
            MsgBox("Invalid sub register indirect")
        End If

    End Sub
    Sub andrgindctMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hexa(r)
                        andflagsetting(r1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = r1.ToUpper.Substring(0, 2)
                            AL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = r1.ToUpper.Substring(0, 2)
                            BL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = r1.ToUpper.Substring(0, 2)
                            CL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = r1.ToUpper.Substring(0, 2)
                            DL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = r1.ToUpper
                        Else
                            MsgBox("Invalid reg combination")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal number")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
        Dim v3 As String = v1.ToUpper.Substring(0, 2)

        Dim v4 As String = v2.ToUpper.Substring(1, 2)

        Dim count As Integer = 0
        For i As Integer = 0 To v3.Length - 1

            If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                count = count + 1

            End If
        Next
        Dim count1 As Integer = 0
        For i As Integer = 0 To v4.Length - 1

            If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                count1 = count1 + 1
            End If
        Next

        If count = v3.Length And count1 = v4.Length Then
            MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
        Else
            MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            Exit Sub
        End If
        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hex8(r)

                        andflagsetting8(r1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = r1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AL.Text = r1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = r1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BL.Text = r1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = r1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CL.Text = r1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = r1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DL.Text = r1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("Invalid combination")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
        Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandrgstrindrct()
        Else
        MsgBox("Invalid combination register")
        End If
    End Sub
    Sub orregindctMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hexa(r)
                        orflagsetting(r1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = r1.ToUpper.Substring(0, 2)
                            AL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = r1.ToUpper.Substring(0, 2)
                            BL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = r1.ToUpper.Substring(0, 2)
                            CL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = r1.ToUpper.Substring(0, 2)
                            DL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = r1.ToUpper
                        Else
                            MsgBox("Invalid reg combination")
                        End If
                    Else
                        MsgBox("Invalid hexadecimal number")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) Or (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
        Dim v3 As String = v1.ToUpper.Substring(0, 2)
        Dim v4 As String = v2.ToUpper.Substring(1, 2)
        Dim count As Integer = 0
        For i As Integer = 0 To v3.Length - 1

            If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                count = count + 1

            End If
        Next
        Dim count1 As Integer = 0
        For i As Integer = 0 To v4.Length - 1

            If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                count1 = count1 + 1
            End If
        Next

        If count = v3.Length And count1 = v4.Length Then
            MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
        Else
            MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            Exit Sub
        End If
        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hex8(r)
                        orflagsetting8(r1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = r1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AL.Text = r1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = r1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BL.Text = r1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = r1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CL.Text = r1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = r1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DL.Text = r1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("Invalid combination")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
        Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varoregindrct()
        Else
        MsgBox("Invalid combination register")
        End If
    End Sub
    Sub adcrggtrindcr()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)


        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(s1)
                    t5.Text = OverFlow()
                    Dim decs1 As Long = hex_to_dec(s1)

                    Dim decs2 As Long = hex_to_dec(v3)

                    Dim sumdec As Long = decs1 + decs2

                    Dim sumhex2 As String = Hex(sumdec)

                    AddFlagSetting(sumhex2)
                    Dim p1 As String = t16.Text
                    Dim p2 As Long = hex_to_dec(p1)
                    Dim p3 As Long = sumdec + p2
                    Dim sumhex As String = Hex(p3)
                    Dim sumhex1 As String = sumhex + "H"

                    If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If sumhex.Length = 4 Then
                            AH.Text = sumhex.Substring(0, 2)
                            AL.Text = sumhex.Substring(2, 2)
                        ElseIf sumhex.Length = 2 Then
                            AH.Text = sumhex
                            AL.Text = "00"
                        Else
                            MsgBox("Invalid")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If sumhex.Length = 4 Then
                            BH.Text = sumhex.Substring(0, 2)
                            BL.Text = sumhex.Substring(2, 2)
                        ElseIf sumhex.Length = 2 Then
                            BH.Text = sumhex
                            BL.Text = "00"
                        Else
                            MsgBox("Invalid")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If sumhex.Length = 4 Then
                            CH.Text = sumhex.Substring(0, 2)
                            CL.Text = sumhex.Substring(2, 2)
                        ElseIf sumhex.Length = 2 Then
                            CH.Text = sumhex
                            CL.Text = "00"
                        Else
                            MsgBox("Invalid")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If sumhex.Length = 4 Then
                            DH.Text = sumhex.Substring(0, 2)
                            DL.Text = sumhex.Substring(2, 2)
                        ElseIf sumhex.Length = 2 Then
                            DH.Text = sumhex
                            DL.Text = "00"
                        Else
                            MsgBox("Invalid")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        SI.Text = sumhex1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        DI.Text = sumhex1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        SP.Text = sumhex1
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        BP.Text = sumhex1
                    Else
                        MsgBox("Invalid reg combination")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
        Dim v3 As String = v1.ToUpper.Substring(0, 2)

        Dim v4 As String = v2.ToUpper.Substring(1, 4)

        Dim count As Integer = 0
        For i As Integer = 0 To v3.Length - 1

            If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                count = count + 1

            End If
        Next
        Dim count1 As Integer = 0
        For i As Integer = 0 To v4.Length - 1

            If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                count1 = count1 + 1
            End If
        Next

        If count = v3.Length And count1 = v4.Length Then
            MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
        Else
            MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            Exit Sub
        End If
        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text
                    If s1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow8()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim decs1 As Long = hex_to_dec(s1)
                        Dim decs2 As Long = hex_to_dec(v3)
                        Dim sumdec As String = decs1 + decs2
                        Dim sumhex2 As String = Hex(sumdec)
                        addflagsetting8(sumhex2)
                        Dim p1 As String = t16.Text
                        Dim p2 As Long = hex_to_dec(p1)
                        Dim p3 As Long = sumdec + p2
                        Dim sumhex As String = Hex(p3)
                        Dim sumhex1 As String = sumhex + "H"
                        If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                AH.Text = sumhex1.ToUpper
                                AL.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                AL.Text = sumhex1.ToUpper
                                AH.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                BH.Text = sumhex1.ToUpper
                                BL.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                BL.Text = sumhex1.ToUpper
                                BH.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                CH.Text = sumhex1.ToUpper
                                CL.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                CL.Text = sumhex1.ToUpper
                                CH.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                DH.Text = sumhex1.ToUpper
                                DL.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumhex1.Length = 3 Then
                                DL.Text = sumhex1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("invalid length of the hexadecimal value")
                            End If
                        Else
                            MsgBox("Invalid combination")
                        End If
                    Else
                        MsgBox("Invalid hexadecimal")
                    End If

                    Exit For
                Else

                End If
        Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddregindctMode()
        Else
        MsgBox("INvalid  register indirect add mode")
        End If
    End Sub
    Sub xchgregindctMode()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("Enter the value" + TextBox32.Text.Trim.ToUpper)
        MsgBox(v1.Length = 5 And v2.Length = 7 And v2.ToUpper.ElementAt(5) = "H")
        If v1.Length = 5 And v2.Length = 7 And v1.ToUpper.EndsWith("H") And v2.ToUpper.ElementAt(5) = "H" Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
           
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    DataGridView1.Rows.Add(New String() {v4, v3})
                    TextBox32.Text = values1

                    Dim v6 As String = TextBox32.Text

                    MsgBox(v6)

                    If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        If v6.Length = 4 Then
                            AH.Text = v6.ToUpper.Substring(0, 2)
                            AL.Text = v6.ToUpper.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            AH.Text = v7.ToUpper.Substring(0, 2)
                            AL.Text = v7.ToUpper.Substring(2, 2)
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        If v6.Length = 4 Then
                            BH.Text = v6.ToUpper.Substring(0, 2)
                            BL.Text = v6.ToUpper.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            BH.Text = v7.ToUpper.Substring(0, 2)
                            BL.Text = v7.ToUpper.Substring(2, 2)
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        If v6.Length = 4 Then
                            CH.Text = v6.ToUpper.Substring(0, 2)
                            CL.Text = v6.ToUpper.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            CH.Text = v7.ToUpper.Substring(0, 2)
                            CL.Text = v7.ToUpper.Substring(2, 2)
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then

                        If v6.Length = 4 Then
                            DH.Text = v6.ToUpper.Substring(0, 2)
                            DL.Text = v6.ToUpper.Substring(2, 2)
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            DH.Text = v7.ToUpper.Substring(0, 2)
                            DL.Text = v7.ToUpper.Substring(2, 2)
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If v6.Length = 4 Then
                            SI.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            SI.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If v6.Length = 4 Then
                            DI.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            DI.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If v6.Length = 4 Then
                            SP.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            SP.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                        If v6.Length = 4 Then
                            BP.Text = v6.ToUpper
                        ElseIf v6.Length = 2 Then
                            Dim v7 As String = "00" + v6
                            BP.Text = v7.ToUpper
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If

                    Else
                        MsgBox("Invalid registerrr combination")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf v1.Length = 3 And v2.Length = 5 And v1.ToUpper.EndsWith("H") And v2.ToUpper.ElementAt(5) = "H" Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    DataGridView1.Rows.Add(New String() {v4, v3})
                    TextBox32.Text = values1

                    Dim v6 As String = TextBox32.Text
                    If v6.Length = 2 Then
                        Dim v7 As String = v6 + "H"
                        If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = v7.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AL.Text = v7.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = v7.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BL.Text = v7.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = v7.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CL.Text = v7.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = v7.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DL.Text = v7.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("Invalid register combination")
                        End If
                    Else
                        MsgBox("Invalid Hexadcimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub testrgindrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox(v2)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        Dim s1 As String = hex_to_bin(v3)
                        MsgBox(s1)
                        Dim s2 As String = hex_to_bin(u1)
                        MsgBox(s2)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        MsgBox(r)
                        Dim r1 As String = hexa(r)
                        MsgBox(r1)
                        testflagsetting(r1)
                    ElseIf u1.Length = 2 Then
                        Dim u2 As String = "00" + u1
                        Dim s1 As String = hex_to_bin(v3)
                        MsgBox(s1)
                        Dim s2 As String = hex_to_bin(u2)
                        MsgBox(s2)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        MsgBox(r)
                        Dim r1 As String = hexa(r)
                        MsgBox(r1)
                        andflagsetting(r1)
                        testflagsetting(r1)
                    Else
                        MsgBox("Invalid hexadecimal number")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 2)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        Dim s1 As String = hex_to_bin(v3)
                        MsgBox(s1)
                        Dim s2 As String = hex_to_bin(u1)
                        MsgBox(s2)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        MsgBox(r)
                        Dim r1 As String = hex8(r)
                        MsgBox(r1)
                        testflagsetting8(r1)

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
           
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandrgstrindrct()
        Else
            MsgBox("Invalid combination register")
        End If
    End Sub
    Sub sbbrgstrindrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim k1 As String = TextBox32.Text.ToUpper
                    Dim k2 As Long = hex_to_dec(v3)
                    Dim k3 As Long = hex_to_dec(k1)
                    If k2 > k3 Then
                        Dim deff As Long = k2 - k3
                        Dim subhex2 As String = Hex(deff)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        subflagsetting(subhex2)
                        Dim p As String = t16.Text
                        Dim p1 As Long = hex_to_dec(p)
                        Dim p2 As Long = deff - p1
                        Dim sumh As String = Hex(p2)
                        Dim sumh1 As String = sumh + "H"

                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length = 4 Then
                                AH.Text = sumh.Substring(0, 2)
                                AL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length = 4 Then
                                BH.Text = sumh.Substring(0, 2)
                                BL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length = 4 Then
                                CH.Text = sumh.Substring(0, 2)
                                CL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length = 4 Then
                                DH.Text = sumh.Substring(0, 2)
                                DL.Text = sumh.Substring(2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = sumh1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = sumh1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = sumh1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = sumh1
                        Else
                            MsgBox("Inavlid register combination in register indirect addressing mode")
                        End If
                    ElseIf k2 <= k3 Then
                        Dim deff As Long = k2 - k3
                        Dim subhex2 As String = Hex(deff)
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        subflagsetting64(subhex2)
                        Dim p As String = t16.Text
                        Dim p1 As Long = hex_to_dec(p)
                        Dim p2 As Long = deff - p1
                        Dim sumh As String = Hex(p2)
                        Dim sumh1 As String = sumh + "H"
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                AH.Text = sumh.Substring(sumh.Length - 4, 2)
                                AL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                BH.Text = sumh.Substring(sumh.Length - 4, 2)
                                BL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                CH.Text = sumh.Substring(sumh.Length - 4, 2)
                                CL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            If sumh.Length >= 4 Then
                                CH.Text = sumh.Substring(sumh.Length - 4, 2)
                                CL.Text = sumh.Substring(sumh.Length - 2, 2)
                            Else
                                MsgBox("Invalid")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = sumh
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = sumh
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = sumh
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = sumh
                        Else
                            MsgBox("Inavlid register combination in register indirect addressing mode")
                        End If
                    Else
                        MsgBox("sub cannot be performed")
                    End If

                    Exit For
                Else
                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim k1 As String = TextBox32.Text.ToUpper
                    If k1.Length = 2 Then
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        If k2 > k3 Then
                            Dim deff As Long = k2 - k3
                            Dim subhex2 As String = Hex(deff)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            subflagsetting8(subhex2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = deff - p1
                            Dim sumh As String = Hex(p2)
                            Dim sumh1 As String = sumh + "H"

                            If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    AH.Text = sumh1.ToUpper
                                    AL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    AL.Text = sumh1.ToUpper
                                    AH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    BH.Text = sumh1.ToUpper
                                    BL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    BL.Text = sumh1.ToUpper
                                    BH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    CH.Text = sumh1.ToUpper
                                    CL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    CL.Text = sumh1.ToUpper
                                    CH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    DH.Text = sumh1.ToUpper
                                    DL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length = 3 Then
                                    DL.Text = sumh1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            Else
                                MsgBox("Inavlid register combination in register indirect addressing mode")
                            End If
                        ElseIf k2 <= k3 Then
                            Dim deff As Long = k2 - k3
                            Dim subhex2 As String = Hex(deff)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            subflagsetting16(subhex2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = deff - p1
                            Dim sumh As String = Hex(p2)
                            Dim sumh1 As String = sumh + "H"
                            If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    AH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    AL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    AL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    AH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    BH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    BL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    BL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    BH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    CH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    CL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    CL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    CH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    DH.Text = sumh.Substring(sumh.Length - 2, 2)
                                    DL.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                If sumh1.Length >= 3 Then
                                    DL.Text = sumh.Substring(sumh.Length - 2, 2)
                                    DH.Text = "00"
                                Else
                                    MsgBox("Inavlid hex")
                                End If
                            Else
                                MsgBox("Inavlid register combination in register indirect addressing mode")
                            End If
                        Else
                            MsgBox("Sub cannot be performed")
                        End If

                    Else
                        MsgBox("Enterd value is not valid")
                    End If

                    Exit For
                Else
                End If
            Next      
        Else
            MsgBox("Invalid sub register indirect")
        End If
    End Sub
    Sub cmprgstrindrct()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim sumd As String = v4 + "H"

            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                    Dim values1 As String = InputBox("enter the value for" + sumd)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    DataGridView1.Rows.Add(New String() {sumd, values1})
                    TextBox32.Text = values1
                    Dim k1 As String = TextBox32.Text.ToUpper
                    Dim k2 As Long = hex_to_dec(v3)

                    Dim k3 As Long = hex_to_dec(k1)

                    cmpflagsetting(k2, k3)
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next


        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1
                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim sumd As String = v4 + "H"
            MsgBox(sumd)
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                    Dim values1 As String = InputBox("enter the value for" + sumd)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    DataGridView1.Rows.Add(New String() {sumd, values1})
                    TextBox32.Text = values1
                    Dim k1 As String = TextBox32.Text.ToUpper
                    If k1.Length = 2 Then
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        cmpflagsetting(k2, k3)
                    Else
                        MsgBox("Enterd value is not valid")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
            
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubregindrctMode()
        Else
            MsgBox("Invalid sub register indirect")
        End If
    End Sub
    Sub MOVBaseIndexAddressing()
        Dim v1 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If b.Contains(TextBox30.Text.Trim.ToUpper) And v1.Trim.ElementAt(6) = "+" Or v1.Trim.ElementAt(6) = "-" And v1.Length = 13 Then

            Dim s1 As String = v1.Substring(1, 4)

            Dim s2 As String = v1.Substring(7, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To s1.Length - 1

                If f1.Contains(s1.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To s2.Length - 1

                If f1.Contains(s2.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = s1.Length And count1 = s2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v1.Trim.ElementAt(6) = "+" Then
                Dim decval As Long = hex_to_dec(s1)
                Dim decval1 As Long = hex_to_dec(s2)
                Dim sum As Long = decval + decval1
                Dim hexaval As String = Hex(sum)

                Dim strhexval As String
                strhexval = hexaval + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexaval)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + strhexval)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim s3 As String = TextBox32.Text
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If s3.Length = 4 Then
                                AH.Text = s3.Substring(0, 2)
                                AL.Text = s3.Substring(2, 2)
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If s3.Length = 4 Then
                                BH.Text = s3.Substring(0, 2)
                                BL.Text = s3.Substring(2, 2)

                            Else
                                MsgBox("invalid based index bx value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If s3.Length = 4 Then
                                CH.Text = s3.Substring(0, 2)
                                CL.Text = s3.Substring(2, 2)
                            Else
                                MsgBox("invalid based index cx value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If s3.Length = 4 Then
                                DH.Text = s3.Substring(0, 2)
                                DL.Text = s3.Substring(2, 2)
                            Else
                                MsgBox("invalid based index dx value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = s3
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = s3
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = s3
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = s3
                        Else
                            MsgBox("Invalid 16 bit based index register")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v1.Trim.ElementAt(6) = "-" Then
                Dim decval As Long = hex_to_dec(s1)
                Dim decval1 As Long = hex_to_dec(s2)
                If decval > decval1 Then
                    Dim sum As Long = decval - decval1
                    Dim hexaval As String = Hex(sum)
                    Dim strhexval As String
                    strhexval = hexaval + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexaval)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + strhexval)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1

                            Dim s3 As String = TextBox32.Text
                            Dim sumh1 As String = s3 + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If s3.Length = 4 Then
                                    AH.Text = s3.Substring(0, 2)
                                    AL.Text = s3.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If s3.Length = 4 Then
                                    BH.Text = s3.ToUpper.Substring(0, 2)
                                    BL.Text = s3.ToUpper.Substring(2, 2)

                                Else
                                    MsgBox("invalid based index bx value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If s3.Length = 4 Then
                                    CH.Text = s3.ToUpper.Substring(0, 2)
                                    CL.Text = s3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index cx value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If s3.Length = 4 Then
                                    DH.Text = s3.ToUpper.Substring(0, 2)
                                    DL.Text = s3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index dx value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = sumh1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = sumh1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = sumh1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = sumh1.ToUpper
                            Else
                                MsgBox("Invalid 16 bit based index register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid,!st opcde is less than second so substraction canoot be possible")
                End If
            Else
                MsgBox("Invalid,Sign operation cannot be done")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v1.Trim.ElementAt(6) = "+" Or v1.Trim.ElementAt(6) = "-" And v1.Length = 13 Then
            Dim s1 As String = v1.Substring(1, 4)

            Dim s2 As String = v1.Substring(7, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To s1.Length - 1

                If f1.Contains(s1.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To s2.Length - 1

                If f1.Contains(s2.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = s1.Length And count1 = s2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            If v1.Trim.ElementAt(6) = "+" Then
                Dim decval As Long = hex_to_dec(s1)
                Dim decval1 As Long = hex_to_dec(s2)
                Dim sum As Long = decval + decval1
                Dim hexaval As String = Hex(sum)
                Dim strhexval As String
                strhexval = hexaval + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexaval)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + strhexval)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim s3 As String = TextBox32.Text
                        If s3.Length = 2 Then
                            Dim sumh1 As String = s3 + "H"
                            MsgBox(sumh1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                If sumh1.Length = 3 Then
                                    AH.Text = sumh1.ToUpper
                                    AL.Text = "00"

                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                If sumh1.Length = 3 Then
                                    AL.Text = sumh1.ToUpper
                                    AH.Text = "00"

                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                If sumh1.Length = 3 Then
                                    BH.Text = sumh1.ToUpper
                                    BL.Text = "00"

                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                If sumh1.Length = 3 Then
                                    BL.Text = sumh1.ToUpper
                                    BH.Text = "00"

                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                If sumh1.Length = 3 Then
                                    CH.Text = sumh1.ToUpper
                                    CL.Text = "00"

                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                If sumh1.Length = 3 Then
                                    CL.Text = sumh1.ToUpper
                                    CH.Text = "00"
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                If sumh1.Length = 3 Then
                                    DH.Text = sumh1.ToUpper
                                    DL.Text = "00"
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                If sumh1.Length = 3 Then
                                    DL.Text = sumh1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            Else
                                MsgBox("Invlaid regster combnation")
                            End If
                        Else
                            MsgBox("Invalid enterd value is not valid value for the registr")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v1.Trim.ElementAt(6) = "-" Then
                Dim decval As Long = hex_to_dec(s1)
                Dim decval1 As Long = hex_to_dec(s2)
                If decval > decval1 Then
                    Dim sum As Long = decval - decval1
                    Dim hexaval As String = Hex(sum)
                    Dim strhexval As String
                    strhexval = hexaval + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexaval)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + strhexval)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim s3 As String = TextBox32.Text
                            If s3.Length = 2 Then
                                Dim sumh1 As String = s3 + "H"
                                MsgBox(sumh1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh1.Length = 3 Then
                                        AH.Text = sumh1.ToUpper
                                        AL.Text = "00"

                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh1.Length = 3 Then
                                        AL.Text = sumh1.ToUpper
                                        AH.Text = "00"

                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh1.Length = 3 Then
                                        BH.Text = sumh1.ToUpper
                                        BL.Text = "00"

                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh1.Length = 3 Then
                                        BL.Text = sumh1.ToUpper
                                        BH.Text = "00"

                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh1.Length = 3 Then
                                        CH.Text = sumh1.ToUpper
                                        CL.Text = "00"

                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh1.Length = 3 Then
                                        CL.Text = sumh1.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh1.Length = 3 Then
                                        DH.Text = sumh1.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh1.Length = 3 Then
                                        DL.Text = sumh1.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                Else
                                    MsgBox("Invlaid regster combnation")
                                End If
                            Else
                                MsgBox("Invalid enterd value is not valid value for the registr")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Invalid,Sign operation cannot be done")
                End If
            ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
                varmovbaseindxMode()
            Else
                MsgBox("Invalid base index addressing mode")
            End If
        End If

    End Sub
    Sub AddBaseIndexAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And v2.Trim.ToUpper.ElementAt(5) = "H" And v2.Trim.ToUpper.ElementAt(11) = "H" And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1
                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase)
                Dim sumb As String
                sumb = sumbase1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim total As String = TextBox32.Text.ToUpper
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(total)
                        t5.Text = OverFlow()
                        Dim total1 As Long = hex_to_dec(total)
                        Dim totalsum As Long = baseadd1 + total1
                        Dim totaladdsum As String = Hex(totalsum)
                        AddFlagSetting(totaladdsum)
                        Dim totaladdsum1 As String = totaladdsum + "H"
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            AH.Text = totaladdsum.Substring(0, 2)
                            AL.Text = totaladdsum.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            BH.Text = totaladdsum.Substring(0, 2)
                            BL.Text = totaladdsum.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            CH.Text = totaladdsum.Substring(0, 2)
                            CL.Text = totaladdsum.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            DH.Text = totaladdsum.Substring(0, 2)
                            DL.Text = totaladdsum.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = totaladdsum1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = totaladdsum1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = totaladdsum1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = totaladdsum1
                        Else
                            MsgBox("INvalid destination register")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim sumb As String
                    sumb = sumbase1 + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            Dim total As String = TextBox32.Text.ToUpper
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(total)
                            t5.Text = OverFlow()
                            Dim total1 As Long = hex_to_dec(total)
                            Dim totalsum As Long = baseadd1 + total1
                            AddFlagSetting(totalsum)
                            Dim totaladdsum As String = Hex(totalsum)
                            Dim totaladdsum1 As String = totaladdsum + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then

                                AH.Text = totaladdsum.Substring(0, 2)
                                AL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then

                                BH.Text = totaladdsum.Substring(0, 2)
                                BL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then

                                CH.Text = totaladdsum.Substring(0, 2)
                                CL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then

                                DH.Text = totaladdsum.Substring(0, 2)
                                DL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = totaladdsum1
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = totaladdsum1
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = totaladdsum1
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = totaladdsum1
                            Else
                                MsgBox("INvalid destination register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If

                    Next
                End If
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)

                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim total As String = TextBox32.Text.ToUpper
                        MsgBox(total)
                        If total.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(total)
                            t5.Text = OverFlow8()
                            Dim total1 As Long = hex_to_dec(total)
                            Dim totalsum As Long = baseadd1 + total1
                            MsgBox(totalsum)
                            AddFlagSetting(totalsum)
                            Dim totaladdsum As String = Hex(totalsum)
                            MsgBox(totaladdsum)
                            addflagsetting8(totalsum)
                            Dim totaladdsum1 As String = totaladdsum + "H"
                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = totaladdsum1.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                AL.Text = totaladdsum1.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = totaladdsum1.ToUpper
                                BL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                BL.Text = totaladdsum1.ToUpper
                                BH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                CH.Text = totaladdsum1.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = totaladdsum1.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = totaladdsum1.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = totaladdsum1.ToUpper
                                DH.Text = "00"

                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal entry")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If

                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim total As String = TextBox32.Text.ToUpper
                            MsgBox(total)
                            If total.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(total)
                                t5.Text = OverFlow8()
                                Dim total1 As Long = hex_to_dec(total)

                                Dim totalsum As Long = baseadd1 + total1

                                addflagsetting8(totalsum)
                                Dim totaladdsum As String = Hex(totalsum)

                                Dim totaladdsum1 As String = totaladdsum + "H"
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = totaladdsum1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = totaladdsum1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = totaladdsum1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = totaladdsum1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = totaladdsum1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = totaladdsum1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = totaladdsum1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = totaladdsum1.ToUpper
                                    DH.Text = "00"

                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal entry")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                End If
            End If

        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddbaseMode()
        Else
            MsgBox("Invalid combination")
        End If

    End Sub
    Sub SubBaseInderAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim sum As Long = s1 + s2
                Dim hexsum As String = Hex(sum)
                Dim hexsum1 As String = hexsum + "H"


                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        Dim k2 As Long = hex_to_dec(v3)

                        Dim k3 As Long = hex_to_dec(k1)
                       
                        If k2 > k3 Then
                            Dim bsum As Long = v3 - k1
                            Dim hexbsum As String = Hex(bsum)
                            MsgBox(hexbsum)
                            subflagsetting(hexbsum)
                            Dim hexbsum1 As String = hexbsum + "H"
                            MsgBox(hexbsum1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If hexbsum.Length <= 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length = 4 Then
                                    AH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    AL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If hexbsum.Length = 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    BH.Text = hexbm.ToUpper.Substring(0, 2)
                                    BL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length = 4 Then
                                    BH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    BL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If hexbsum.Length = 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    CH.Text = hexbm.ToUpper.Substring(0, 2)
                                    CL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length = 4 Then
                                    CH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    CL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If hexbsum.Length = 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    DH.Text = hexbm.ToUpper.Substring(0, 2)
                                    DL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length = 4 Then
                                    DH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    DL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = hexbsum1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = hexbsum1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = hexbsum1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = hexbsum1.ToUpper
                            Else
                                MsgBox("Invalid reg combtn")
                            End If
                        ElseIf k2 = k3 Or k2 <= k3 Then
                            Dim bsum As Long = v3 - k1
                            Dim hexbsum As String = Hex(bsum)
                            subflagsetting64(hexbsum)
                            Dim hexbsum1 As String = hexbsum + "H"
                            MsgBox(hexbsum1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If hexbsum.Length <= 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length >= 4 Then
                                    AH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If hexbsum.Length <= 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    BH.Text = hexbm.ToUpper.Substring(0, 2)
                                    BL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length >= 4 Then
                                    BH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If hexbsum.Length <= 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    CH.Text = hexbm.ToUpper.Substring(0, 2)
                                    CL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length >= 4 Then
                                    CH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If hexbsum.Length <= 3 Then
                                    Dim hexbm As String = "0" + hexbsum
                                    DH.Text = hexbm.ToUpper.Substring(0, 2)
                                    DL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf hexbsum.Length >= 4 Then
                                    DH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = hexbsum.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = hexbsum.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = hexbsum.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = hexbsum.ToUpper
                            Else
                                MsgBox("Invalid reg combtn")
                            End If
                        Else
                            MsgBox("Invald hexadecimal value")
                        End If

                        Exit For
                    Else

                    End If
                Next
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                If s1 > s2 Then
                    Dim sum As Long = s1 - s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"


                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(hexsum)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(hexsum)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 > k3 Then
                                Dim bsum As Long = k2 - k3
                                MsgBox(bsum)
                                Dim hexbsum As String = Hex(bsum)
                               
                                subflagsetting(hexbsum)
                                Dim hexbsum1 As String = hexbsum + "H"
                                MsgBox(hexbsum1)
                               
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        AH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        AL.Text = hexbsum.ToUpper.Substring(2, 2)

                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        BH.Text = hexbm.ToUpper.Substring(0, 2)
                                        BL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        BH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        BL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        CH.Text = hexbm.ToUpper.Substring(0, 2)
                                        CL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        CH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        CL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        DH.Text = hexbm.ToUpper.Substring(0, 2)
                                        DL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        DH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        DL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = hexbsum.ToUpper
                                Else
                                    MsgBox("Invalid reg combtn")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim bsum As Long = v3 - k1
                                Dim hexbsum As String = Hex(bsum)
                                subflagsetting64(hexbsum)
                                Dim hexbsum1 As String = hexbsum + "H"
                                MsgBox(hexbsum1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        AH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        BH.Text = hexbm.ToUpper.Substring(0, 2)
                                        BL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        BH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        CH.Text = hexbm.ToUpper.Substring(0, 2)
                                        CL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        CH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If hexbsum.Length <= 3 Then
                                        Dim hexbm As String = "0" + hexbsum
                                        DH.Text = hexbm.ToUpper.Substring(0, 2)
                                        DL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf hexbsum.Length >= 4 Then
                                        DH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = hexbsum.ToUpper
                                Else
                                    MsgBox("Invalid reg combtn")
                                End If
                            Else
                                MsgBox("Invald hexadecimal value")
                            End If

                            Exit For
                        Else

                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)
                Dim sum As Long = s1 + s2
                Dim hexsum As String = Hex(sum)

                Dim hexsum1 As String = hexsum + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            Dim k2 As Long = hex_to_dec(v3)
                            MsgBox(k2)
                            Dim k3 As Long = hex_to_dec(k1)
                            MsgBox(k3)
                            
                            If k2 > k3 Then
                                Dim bsum As Long = v3 - k1
                                Dim hexbsum As String = Hex(bsum)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(hexsum)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(hexsum)
                                t5.Text = OverFlow8()
                                subflagsetting8(hexbsum)
                                Dim hexbsum1 As String = hexbsum + "H"
                                MsgBox(hexbsum1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If hexbsum1.Length >= 3 Then
                                        AH.Text = hexbsum.ToUpper
                                        AL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If hexbsum1.Length >= 3 Then
                                        AL.Text = hexbsum1.ToUpper
                                        AH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If hexbsum1.Length >= 3 Then
                                        BH.Text = hexbsum1.ToUpper
                                        BL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If hexbsum1.Length >= 3 Then
                                        BL.Text = hexbsum1.ToUpper
                                        BH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If hexbsum1.Length >= 3 Then
                                        CH.Text = hexbsum1.ToUpper
                                        CL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If hexbsum1.Length >= 3 Then
                                        CL.Text = hexbsum1.ToUpper
                                        CH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If hexbsum1.Length >= 3 Then
                                        DH.Text = hexbsum1.ToUpper
                                        DL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If hexbsum1.Length >= 3 Then
                                        DL.Text = hexbsum1.ToUpper
                                        DH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                Else
                                    MsgBox("Invalid Combination")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim bsum As Long = v3 - k1
                                Dim hexbsum As String = Hex(bsum)
                                subflagsetting16(hexbsum)
                                Dim hexbsum1 As String = hexbsum + "H"
                                MsgBox(hexbsum1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If hexbsum1.Length >= 3 Then
                                        AH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        AL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If hexbsum1.Length >= 3 Then
                                        AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        AH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If hexbsum1.Length >= 3 Then
                                        BH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        BL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If hexbsum1.Length >= 3 Then
                                        BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        BH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If hexbsum1.Length >= 3 Then
                                        CH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        CL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If hexbsum1.Length >= 3 Then
                                        CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        CH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If hexbsum1.Length >= 3 Then
                                        DH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        DL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If hexbsum1.Length >= 3 Then
                                        DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        DH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                Else
                                    MsgBox("Invalid, Substraction Cannot be processed")
                                End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)
                If s1 > s2 Then
                    Dim sum As Long = s1 - s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim bsum As Long = v3 - k1

                                    Dim hexbsum As String = hexa(bsum)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(hexbsum)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(hexbsum)
                                    t5.Text = OverFlow8()
                                    subflagsetting8(hexbsum)
                                    Dim hexbsum1 As String = hexbsum + "H"
                                    MsgBox(hexbsum1)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If hexbsum1.Length >= 3 Then
                                            AH.Text = hexbsum.ToUpper
                                            BL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If hexbsum1.Length >= 3 Then
                                            AL.Text = hexbsum.ToUpper
                                            AH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else

                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If hexbsum1.Length >= 3 Then
                                            BH.Text = hexbsum.ToUpper
                                            BL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If hexbsum1.Length >= 3 Then
                                            BL.Text = hexbsum.ToUpper
                                            BH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If hexbsum1.Length >= 3 Then
                                            CH.Text = hexbsum.ToUpper
                                            CL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If hexbsum1.Length >= 3 Then
                                            CL.Text = hexbsum.ToUpper
                                            CH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If hexbsum1.Length >= 3 Then
                                            DH.Text = hexbsum.ToUpper
                                            DL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If hexbsum1.Length >= 3 Then
                                            DL.Text = hexbsum.ToUpper
                                            DH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                ElseIf k2 = k3 Or k2 <= k3 Then
                                    Dim bsum As Long = v3 - k1
                                    Dim hexbsum As String = Hex(bsum)
                                    subflagsetting16(hexbsum)
                                    Dim hexbsum1 As String = hexbsum + "H"
                                    MsgBox(hexbsum1)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If hexbsum1.Length >= 3 Then
                                            AH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If hexbsum1.Length >= 3 Then
                                            AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            AH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else

                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If hexbsum1.Length >= 3 Then
                                            BH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If hexbsum1.Length >= 3 Then
                                            BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            BH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If hexbsum1.Length >= 3 Then
                                            CH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            CL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If hexbsum1.Length >= 3 Then
                                            CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            CH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If hexbsum1.Length >= 3 Then
                                            DH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            DL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If hexbsum1.Length >= 3 Then
                                            DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            DH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                Else
                                    MsgBox("Invalid, Substraction Cannot be processed")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubbaseindxMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub andbaseindexMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("INvalid destination register")
                            End If

                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hexa(r)

                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("INvalid destination register")
                                End If

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be possibl")
                End If
            Else
                MsgBox("Invalid sign Opeartion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)

                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hex8(r)

                            andflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = r1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = r1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = r1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = r1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hex8(r)

                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox(" substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")

            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandbaseindxMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub orbaseindexMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hexa(r)
                            MsgBox(r1)
                            orflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("INvalid destination register")
                            End If

                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                orflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("INvalid destination register")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be possibl")
                End If
            Else
                MsgBox("Invalid sign Opeartion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)

                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hex8(r)
                            orflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = r1.ToUpper
                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hex8(r)
                                orflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox(" substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varorbaseindx()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub adcbaseindex()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim total As String = TextBox32.Text.ToUpper
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(total)
                        t5.Text = OverFlow()
                        Dim total1 As Long = hex_to_dec(total)
                        Dim totalsum As Long = baseadd1 + total1
                        Dim totaladdsum2 As String = Hex(totalsum)
                        AddFlagSetting(totaladdsum2)
                        Dim p1 As String = t16.Text
                        Dim p2 As Long = hex_to_dec(p1)
                        Dim p3 As Long = totalsum + p2
                        Dim totaladdsum As String = Hex(p3)
                        Dim totaladdsum1 As String = totaladdsum + "H"
                        If TextBox30.Text.Trim.ToUpper = b(0) Then

                            AH.Text = totaladdsum.Substring(0, 2)
                            AL.Text = totaladdsum.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then

                            BH.Text = totaladdsum.Substring(0, 2)
                            BL.Text = totaladdsum.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then

                            CH.Text = totaladdsum.Substring(0, 2)
                            CL.Text = totaladdsum.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then

                            DH.Text = totaladdsum.Substring(0, 2)
                            DL.Text = totaladdsum.Substring(2, 2)

                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = totaladdsum1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = totaladdsum1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = totaladdsum1
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = totaladdsum1
                        Else
                            MsgBox("INvalid destination register")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim total As String = TextBox32.Text.ToUpper
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(total)
                            t5.Text = OverFlow()
                            Dim total1 As Long = hex_to_dec(total)
                            Dim totalsum As Long = baseadd1 + total1
                            Dim totalsum2 As String = Hex(totalsum)
                            AddFlagSetting(totalsum2)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = totalsum + p2
                            Dim totaladdsum As String = Hex(p3)
                            Dim totaladdsum1 As String = totaladdsum + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then

                                AH.Text = totaladdsum.Substring(0, 2)
                                AL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then

                                BH.Text = totaladdsum.Substring(0, 2)
                                BL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then

                                CH.Text = totaladdsum.Substring(0, 2)
                                CL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then

                                DH.Text = totaladdsum.Substring(0, 2)
                                DL.Text = totaladdsum.Substring(2, 2)

                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = totaladdsum1
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = totaladdsum1
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = totaladdsum1
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = totaladdsum1
                            Else
                                MsgBox("INvalid destination register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction cannot performed")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim total As String = TextBox32.Text.ToUpper
                        If total.Length = 2 Then
                            Dim total1 As Long = hex_to_dec(total)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(total1)
                            t5.Text = OverFlow8()
                            Dim totalsum As Long = baseadd1 + total1
                            Dim totalsum2 As String = Hex(totalsum)
                            addflagsetting8(totalsum2)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = totalsum + p2
                            Dim totaladdsum As String = Hex(p3)
                            Dim totaladdsum1 As String = totaladdsum + "H"
                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = totaladdsum1.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                AL.Text = totaladdsum1.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                BH.Text = totaladdsum1.ToUpper
                                BL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                BL.Text = totaladdsum1.ToUpper
                                BH.Text = "00"
                                CH.Text = totaladdsum1.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = totaladdsum1.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = totaladdsum1.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = totaladdsum1.ToUpper
                                DH.Text = "00"

                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal entry")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then

                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim total As String = TextBox32.Text.ToUpper

                            If total.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(total)
                                t5.Text = OverFlow8()
                                Dim total1 As Long = hex_to_dec(total)
                                Dim totalsum As Long = baseadd1 + total1
                                Dim totalsum2 As String = Hex(totalsum)
                                addflagsetting8(totalsum2)
                                Dim p1 As String = t16.Text
                                Dim p2 As Long = hex_to_dec(p1)
                                Dim p3 As Long = totalsum + p2
                                Dim totaladdsum As String = Hex(p3)
                                Dim totaladdsum1 As String = totaladdsum + "H"
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = totaladdsum1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = totaladdsum1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = totaladdsum1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = totaladdsum1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = totaladdsum1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = totaladdsum1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = totaladdsum1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = totaladdsum1.ToUpper
                                    DH.Text = "00"

                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal entry")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If

        Else
            MsgBox("Invalid combination")
        End If
    End Sub
    Sub xchgbaseindxMode()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 13 And v1.ToUpper.EndsWith("H") And v2.ToUpper.ElementAt(5) = "H" And v2.ToUpper.ElementAt(11) = "H" Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)
                Dim sum As Long = s1 + s2
                MsgBox(sum)
                Dim hexsum As String = Hex(sum)
                MsgBox(hexsum)
                Dim hexsum1 As String = hexsum + "H"
                MsgBox(hexsum1)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If k1.Length = 4 Then
                                AH.Text = k1.ToUpper.Substring(0, 2)
                                AL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                AH.Text = k2.ToUpper.Substring(0, 2)
                                AL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If k1.Length = 4 Then
                                BH.Text = k1.ToUpper.Substring(0, 2)
                                BL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                BH.Text = k2.ToUpper.Substring(0, 2)
                                BL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If k1.Length = 4 Then
                                CH.Text = k1.ToUpper.Substring(0, 2)
                                CL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                CH.Text = k2.ToUpper.Substring(0, 2)
                                CL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If k1.Length = 4 Then
                                DH.Text = k1.ToUpper.Substring(0, 2)
                                DL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                DH.Text = k2.ToUpper.Substring(0, 2)
                                DL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            If k1.Length = 4 Then
                                SI.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                SI.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            If k1.Length = 4 Then
                                DI.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                DI.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            If k1.Length = 4 Then
                                SP.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                SP.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            If k1.Length = 4 Then
                                BP.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                BP.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                            End If
                        Else
                            MsgBox("Invalid reg combtn")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)
                If s1 > s2 Then
                    Dim sum As Long = s1 - s2
                    MsgBox(sum)
                    Dim hexsum As String = Hex(sum)
                    MsgBox(hexsum)
                    Dim hexsum1 As String = hexsum + "H"
                    MsgBox(hexsum1)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If k1.Length = 4 Then
                                    AH.Text = k1.ToUpper.Substring(0, 2)
                                    AL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If k1.Length = 4 Then
                                    BH.Text = k1.ToUpper.Substring(0, 2)
                                    BL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    BH.Text = k2.ToUpper.Substring(0, 2)
                                    BL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If k1.Length = 4 Then
                                    CH.Text = k1.ToUpper.Substring(0, 2)
                                    CL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    CH.Text = k2.ToUpper.Substring(0, 2)
                                    CL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If k1.Length = 4 Then
                                    DH.Text = k1.ToUpper.Substring(0, 2)
                                    DL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    DH.Text = k2.ToUpper.Substring(0, 2)
                                    DL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If k1.Length = 4 Then
                                    SI.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    SI.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If k1.Length = 4 Then
                                    DI.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    DI.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If k1.Length = 4 Then
                                    SP.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    SP.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If k1.Length = 4 Then
                                    BP.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    BP.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            Else
                                MsgBox("Invalid reg combtn")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be performed")
                End If


            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf v1.Length = 3 And v2.Length = 13 And v1.ToUpper.EndsWith("H") And v2.ToUpper.ElementAt(5) = "H" And v2.ToUpper.ElementAt(11) = "H" Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim sum As Long = s1 + s2

                Dim hexsum As String = Hex(sum)

                Dim hexsum1 As String = hexsum + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                       
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            Dim k2 As String = k1 + "H"
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                If k2.Length = 3 Then
                                    AH.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                If k2.Length = 3 Then
                                    AL.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                If k2.Length = 3 Then
                                    BH.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                If k2.Length = 3 Then
                                    BL.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                If k2.Length = 3 Then
                                    CH.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                If k2.Length = 3 Then
                                    CL.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                If k2.Length = 3 Then
                                    DH.Text = k2.ToUpper
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                If k2.Length = 3 Then
                                    DL.Text = k2.ToUpper
                                End If
                            Else
                                MsgBox("Invalid register combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                If s1 > s2 Then
                    Dim sum As Long = s1 - s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                           
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim k2 As String = k1 + "H"
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If k2.Length = 3 Then
                                        AH.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If k2.Length = 3 Then
                                        AL.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If k2.Length = 3 Then
                                        BH.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If k2.Length = 3 Then
                                        BL.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If k2.Length = 3 Then
                                        CH.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If k2.Length = 3 Then
                                        CL.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If k2.Length = 3 Then
                                        DH.Text = k2.ToUpper
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If k2.Length = 3 Then
                                        DL.Text = k2.ToUpper
                                    End If
                                Else
                                    MsgBox("Invalid register combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next   
                Else
                    MsgBox("Substraction Canoot be performed")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Inavlid register combination")
        End If
    End Sub
    Sub testbaseindex()

        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hexa(r)
                            MsgBox(r1)
                            testflagsetting(r1)
                        ElseIf u1.Length = 2 Then
                            Dim u2 As String = "00" + u1
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u2)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hexa(r)
                            MsgBox(r1)
                            testflagsetting(r1)

                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                testflagsetting(r1)

                            ElseIf u1.Length = 2 Then
                                Dim u2 As String = "00" + u1
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u2)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                testflagsetting(r1)

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be possibl")
                End If
            Else
                MsgBox("Invalid sign Opeartion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then

                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                       
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hex8(r)
                            MsgBox(r1)
                            testflagsetting8(r1)

                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hex8(r)
                                MsgBox(r1)
                                testflagsetting8(r1)

                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox(" substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")

            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandbaseindxMode()

        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub sbbbasedindex()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim sum As Long = s1 + s2
                Dim hexsum As String = Hex(sum)
                Dim hexsum1 As String = hexsum + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        If k2 > k3 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim bsum As Long = v3 - k1
                            Dim hexbsum2 As String = Hex(bsum)
                            subflagsetting(hexbsum2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = bsum - p1
                            Dim hexbsum As String = Hex(p2)
                            Dim hexbsum1 As String = hexbsum + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If hexbsum.Length = 4 Then
                                    AH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    AL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If hexbsum.Length = 4 Then
                                    BH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    BL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If hexbsum.Length = 4 Then
                                    CH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    CL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If hexbsum.Length = 4 Then
                                    DH.Text = hexbsum.ToUpper.Substring(0, 2)
                                    DL.Text = hexbsum.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = hexbsum1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = hexbsum1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = hexbsum1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = hexbsum1.ToUpper
                            Else
                                MsgBox("Invalid reg combtn")
                            End If
                        ElseIf k2 <= k3 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim bsum As Long = v3 - k1
                            Dim hexbsum2 As String = Hex(bsum)
                            subflagsetting64(hexbsum2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = bsum - p1
                            Dim hexbsum As String = Hex(p2)
                            Dim hexbsum1 As String = hexbsum + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If hexbsum.Length >= 4 Then
                                    AH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If hexbsum.Length >= 4 Then
                                    BH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If hexbsum.Length >= 4 Then
                                    CH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If hexbsum.Length >= 4 Then
                                    DH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                    DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                Else
                                    MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = hexbsum.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = hexbsum.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = hexbsum.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = hexbsum.ToUpper
                            Else
                                MsgBox("Invalid reg combtn")
                            End If
                        Else
                            MsgBox("Invald hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next             
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                If s1 > s2 Then
                    Dim sum As Long = s1 - s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim bsum As Long = k2 - k3
                                Dim hexbsum2 As String = Hex(bsum)
                                subflagsetting(hexbsum2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsum - p1
                                Dim hexbsum As String = Hex(p2)
                                Dim hexbsum1 As String = hexbsum + "H"
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If hexbsum.Length = 4 Then
                                        AH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        AL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If hexbsum.Length = 4 Then
                                        BH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        BL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If hexbsum.Length = 4 Then
                                        CH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        CL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If hexbsum.Length = 4 Then
                                        DH.Text = hexbsum.ToUpper.Substring(0, 2)
                                        DL.Text = hexbsum.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = hexbsum1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = hexbsum1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = hexbsum1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = hexbsum1.ToUpper
                                Else
                                    MsgBox("Invalid reg combtn")
                                End If
                            ElseIf k2 <= k3 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim bsum As Long = k2 - k3
                                Dim hexbsum2 As String = Hex(bsum)
                                subflagsetting64(hexbsum2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsum - p1
                                Dim hexbsum As String = Hex(p2)
                                Dim hexbsum1 As String = hexbsum + "H"
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If hexbsum.Length >= 4 Then
                                        AH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If hexbsum.Length >= 4 Then
                                        BH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If hexbsum.Length >= 4 Then
                                        CH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If hexbsum.Length >= 4 Then
                                        DH.Text = hexbsum.Substring(hexbsum.Length - 4, 2)
                                        DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = hexbsum.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = hexbsum.ToUpper
                                Else
                                    MsgBox("Invalid reg combtn")
                                End If

                            Else
                                MsgBox("Invald hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be possible")
                End If

            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)


                Dim sum As Long = s1 + s2

                Dim hexsum As String = Hex(sum)

                Dim hexsum1 As String = hexsum + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim bsum As Long = v3 - k1
                                Dim hexbsum2 As String = Hex(bsum)
                                subflagsetting8(hexbsum2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsum - p1
                                Dim hexbsum As String = Hex(p2)
                                Dim hexbsum1 As String = hexbsum + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If hexbsum1.Length = 3 Then
                                        AH.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        AH.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If hexbsum1.Length = 3 Then
                                        AL.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        AL.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If hexbsum1.Length = 3 Then
                                        BH.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        BH.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If hexbsum1.Length = 3 Then
                                        BL.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        BL.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If hexbsum1.Length = 3 Then
                                        CH.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        CH.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If hexbsum1.Length = 3 Then
                                        CL.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        CL.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If hexbsum1.Length = 3 Then
                                        DH.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        DH.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If hexbsum1.Length = 3 Then
                                        DL.Text = hexbsum1.ToUpper
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum1.ToUpper
                                        DL.Text = sb.ToUpper
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                Else
                                    MsgBox("Invalid Combination")
                                End If
                            ElseIf k2 <= k3 Then
                                Dim bsum As Long = v3 - k1
                                Dim hexbsum2 As String = Hex(bsum)
                                subflagsetting16(hexbsum2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsum - p1
                                Dim hexbsum As String = Hex(p2)
                                Dim hexbsum1 As String = hexbsum + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If hexbsum1.Length >= 3 Then
                                        AH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        AL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If hexbsum1.Length >= 3 Then
                                        AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        AH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If hexbsum1.Length >= 3 Then
                                        BH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        BL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If hexbsum1.Length >= 3 Then
                                        BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        BH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If hexbsum1.Length >= 3 Then
                                        CH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        CL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If hexbsum1.Length >= 3 Then
                                        CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        CH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If hexbsum1.Length >= 3 Then
                                        DH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        DL.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If hexbsum1.Length >= 3 Then
                                        DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                        DH.Text = "00"
                                    ElseIf hexbsum1.Length = 2 Then
                                        Dim sb As String = "0" + hexbsum.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                Else
                                    MsgBox("Invalid Combination")
                                End If
                            Else
                                MsgBox("Invalid, Substraction Cannot be processed")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If

                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)
                If s1 > s2 Then
                    Dim sum As Long = s1 - s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                If k2 > k3 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim bsum As Long = v3 - k1
                                    Dim hexbsum2 As String = Hex(bsum)
                                    subflagsetting8(hexbsum2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = bsum - p1
                                    Dim hexbsum As String = Hex(p2)
                                    Dim hexbsum1 As String = hexbsum + "H"

                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If hexbsum1.Length = 3 Then
                                            AH.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If hexbsum1.Length = 3 Then
                                            AL.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If hexbsum1.Length = 3 Then
                                            BH.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If hexbsum1.Length = 3 Then
                                            BL.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If hexbsum1.Length = 3 Then
                                            CH.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If hexbsum1.Length = 3 Then
                                            CL.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If hexbsum1.Length = 3 Then
                                            DH.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If hexbsum1.Length = 3 Then
                                            DL.Text = hexbsum1.ToUpper
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                ElseIf k2 <= k3 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim bsum As Long = v3 - k1
                                    Dim hexbsum2 As String = Hex(bsum)
                                    subflagsetting16(hexbsum2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = bsum - p1
                                    Dim hexbsum As String = Hex(p2)
                                    Dim hexbsum1 As String = hexbsum + "H"

                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If hexbsum1.Length >= 3 Then
                                            AH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            AL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If hexbsum1.Length >= 3 Then
                                            AL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            AH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If hexbsum1.Length >= 3 Then
                                            BH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If hexbsum1.Length >= 3 Then
                                            BL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            BH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If hexbsum1.Length >= 3 Then
                                            CH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            CL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If hexbsum1.Length >= 3 Then
                                            CL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            CH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If hexbsum1.Length >= 3 Then
                                            DH.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            DL.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If hexbsum1.Length >= 3 Then
                                            DL.Text = hexbsum.Substring(hexbsum.Length - 2, 2)
                                            DH.Text = "00"
                                        ElseIf hexbsum1.Length = 2 Then
                                            Dim sb As String = "0" + hexbsum.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                Else
                                    MsgBox("Invalid, Substraction Cannot be processed")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub cmpbaseindx()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox(v2)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            MsgBox(v5)
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim sum As Long = s1 + s2
                Dim hexsum As String = Hex(sum)
                Dim hexsum1 As String = hexsum + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        DataGridView1.Rows.Add(New String() {hexsum1, values1})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        Dim k2 As Long = hex_to_dec(v3)
                        MsgBox(k2)
                        Dim k3 As Long = hex_to_dec(k1)
                        MsgBox(k3)
                        cmpflagsetting(k2, k3)
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1
                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1
                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)
                If s1 > s2 Then
                    Dim sum As Long = s1 - s2
                    MsgBox(sum)
                    Dim hexsum As String = Hex(sum)
                    MsgBox(hexsum)
                    Dim hexsum1 As String = hexsum + "H"
                    MsgBox(hexsum1)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {hexsum1, values1})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)
                            MsgBox(k2)
                            Dim k3 As Long = hex_to_dec(k1)
                            MsgBox(k3)
                            cmpflagsetting(k2, k3)
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            MsgBox(v5)
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)

                Dim sum As Long = s1 + s2
                MsgBox(sum)
                Dim hexsum As String = Hex(sum)
                MsgBox(hexsum)
                Dim hexsum1 As String = hexsum + "H"
                MsgBox(hexsum1)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim values1 As String = InputBox("enter the value for" + hexsum1)

                        DataGridView1.Rows(f).Cells(1).Value = values1
                        DataGridView1.Rows.Add(New String() {hexsum1, values1})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            Dim k2 As Long = hex_to_dec(v3)
                            MsgBox(k2)
                            Dim k3 As Long = hex_to_dec(k1)
                            MsgBox(k3)
                            cmpflagsetting(k2, k3)
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If

                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v5)
                MsgBox(s2)
                If s1 > s2 Then
                    Dim sum As Long = s1 - s2
                    MsgBox(sum)
                    Dim hexsum As String = Hex(sum)
                    MsgBox(hexsum)
                    Dim hexsum1 As String = hexsum + "H"
                    MsgBox(hexsum1)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            'File.AppendAllText(Application.StartupPath + "\datagridValue.txt", "%" + hexsum1 + "?" + values1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {hexsum1, values1})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)
                                MsgBox(k2)
                                Dim k3 As Long = hex_to_dec(k1)
                                MsgBox(k3)
                                cmpflagsetting(k2, k3)
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub MOVregisterRelativeAddressing()
        Dim v1 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (TextBox32.Text.Length > 7 And TextBox32.Text.Length <= 13) Then
            Dim v2 As String = v1.ToUpper.Substring(1, 4)
            If v1.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v1.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v3 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim rltvdec As Long = hex_to_dec(v2)
                Dim rltvdec1 As Long = hex_to_dec(v3)
                Dim rltvsum As Long = rltvdec + rltvdec1
                Dim rltvhexsum As String = Hex(rltvsum)
                Dim strhexval As String
                strhexval = rltvhexsum + "H"
                MsgBox(strhexval)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(rltvhexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + strhexval)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s4 As String = TextBox32.Text
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If s4.Length = 4 Then
                                AH.Text = s4.Substring(0, 2)
                                AL.Text = s4.Substring(2, 2)
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                AH.Text = s5.Substring(0, 2)
                                AL.Text = s5.Substring(2, 2)
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If s4.Length = 4 Then
                                BH.Text = s4.Substring(0, 2)
                                BL.Text = s4.Substring(2, 2)
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                BH.Text = s5.Substring(0, 2)
                                BL.Text = s5.Substring(2, 2)
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If s4.Length = 4 Then
                                CH.Text = s4.Substring(0, 2)
                                CL.Text = s4.Substring(2, 2)
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                CH.Text = s5.Substring(0, 2)
                                CL.Text = s5.Substring(2, 2)
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If s4.Length = 4 Then
                                DH.Text = s4.Substring(0, 2)
                                DL.Text = s4.Substring(2, 2)
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                DH.Text = s5.Substring(0, 2)
                                DL.Text = s5.Substring(2, 2)
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            If s4.Length = 4 Then
                                SI.Text = s4.ToUpper
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                SI.Text = s5.ToUpper
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            If s4.Length = 4 Then
                                DI.Text = s4.ToUpper
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                DI.Text = s5.ToUpper
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            If s4.Length = 4 Then
                                SP.Text = s4.ToUpper
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                SP.Text = s5.ToUpper
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            If s4.Length = 4 Then
                                BP.Text = s4.ToUpper
                            ElseIf s4.Length = 2 Then
                                Dim s5 As String = "00" + s4
                                BP.Text = s5.ToUpper
                            Else
                                MsgBox("invalid based index ax value")
                            End If
                        Else
                            MsgBox("Invalid 16 bit based index register")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v1.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v1.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v3 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim rltvdec As Long = hex_to_dec(v2)
                MsgBox(rltvdec)
                Dim rltvdec1 As Long = hex_to_dec(v3)
                MsgBox(rltvdec1)
                If rltvdec > rltvdec1 Then
                    Dim rltvsum As Long = rltvdec - rltvdec1
                    Dim rltvhexsum As String = Hex(rltvsum)
                    Dim strhexval As String
                    strhexval = rltvhexsum + "H"
                    MsgBox(strhexval)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(rltvhexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + strhexval)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim s4 As String = TextBox32.Text
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If s4.Length = 4 Then
                                    AH.Text = s4.Substring(0, 2)
                                    AL.Text = s4.Substring(2, 2)
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    AH.Text = s5.Substring(0, 2)
                                    AL.Text = s5.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If s4.Length = 4 Then
                                    BH.Text = s4.Substring(0, 2)
                                    BL.Text = s4.Substring(2, 2)
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    BH.Text = s5.Substring(0, 2)
                                    BL.Text = s5.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If s4.Length = 4 Then
                                    CH.Text = s4.Substring(0, 2)
                                    CL.Text = s4.Substring(2, 2)
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    CH.Text = s5.Substring(0, 2)
                                    CL.Text = s5.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If s4.Length = 4 Then
                                    DH.Text = s4.Substring(0, 2)
                                    DL.Text = s4.Substring(2, 2)
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    DH.Text = s5.Substring(0, 2)
                                    DL.Text = s5.Substring(2, 2)
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If s4.Length = 4 Then
                                    SI.Text = s4.ToUpper
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    SI.Text = s5.ToUpper
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If s4.Length = 4 Then
                                    DI.Text = s4.ToUpper
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    DI.Text = s5.ToUpper
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If s4.Length = 4 Then
                                    SP.Text = s4.ToUpper
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    SP.Text = s5.ToUpper
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If s4.Length = 4 Then
                                    BP.Text = s4.ToUpper
                                ElseIf s4.Length = 2 Then
                                    Dim s5 As String = "00" + s4
                                    BP.Text = s5.ToUpper
                                Else
                                    MsgBox("invalid based index ax value")
                                End If
                            Else
                                MsgBox("Invalid 16 bit based index register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot possible")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (TextBox32.Text.Length > 7 And TextBox32.Text.Length <= 13) Then
            Dim v2 As String = v1.ToUpper.Substring(1, 2)
            If v1.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v1.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v3 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim rltvdec As Long = hex_to_dec(v2)

                Dim rltvdec1 As Long = hex_to_dec(v3)

                Dim rltvsum As Long = rltvdec + rltvdec1

                Dim rltvhexsum As String = Hex(rltvsum)

                Dim strhexval As String
                strhexval = rltvhexsum + "H"
                MsgBox(strhexval)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(rltvhexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + strhexval)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text + "H"
                        If u1.Length = 3 Then
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = u1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = u1.ToUpper
                            Else
                                MsgBox("Invalid register combination")
                            End If
                        Else
                            MsgBox("Invalid hecadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v1.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v1.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v3 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim rltvdec As Long = hex_to_dec(v2)

                Dim rltvdec1 As Long = hex_to_dec(v3)

                If rltvdec > rltvdec1 Then
                    Dim rltvsum As Long = rltvdec - rltvdec1

                    Dim rltvhexsum As String = Hex(rltvsum)

                    Dim strhexval As String
                    strhexval = rltvhexsum + "H"
                    MsgBox(strhexval)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(rltvhexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + strhexval)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text + "H"
                            If u1.Length = 3 Then
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = u1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = u1.ToUpper
                                Else
                                    MsgBox("Invalid register combination")
                                End If
                            Else
                                MsgBox("Invalid hecadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Invalid substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub AddRegisterRelativeAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim sum As Long = decregrltv1 + s2
                        Dim hexsum As String = Hex(sum)
                        AddFlagSetting(hexsum)
                        Dim hexsum1 As String = hexsum + "H"
                        If TextBox30.Text.ToUpper.Trim = b(0) Then
                            AH.Text = hexsum.Substring(0, 2)
                            AL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(1)) Then
                            BH.Text = hexsum.Substring(0, 2)
                            BL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(2)) Then
                            CH.Text = hexsum.Substring(0, 2)
                            CL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(3)) Then
                            DH.Text = hexsum.Substring(0, 2)
                            DL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(4)) Then
                            SI.Text = hexsum1
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(5)) Then
                            DI.Text = hexsum1
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(6)) Then
                            SP.Text = hexsum1
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(7)) Then
                            BP.Text = hexsum1
                        Else
                            MsgBox("Invalid regtr conbination")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim s1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow()
                            Dim s2 As Long = hex_to_dec(s1)
                            Dim sum As Long = decregrltv1 + s2
                            Dim hexsum As String = Hex(sum)
                            AddFlagSetting(hexsum)
                            Dim hexsum1 As String = hexsum + "H"
                            If TextBox30.Text.ToUpper.Trim = c(0) Then
                                AH.Text = hexsum.Substring(0, 2)
                                AL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(1)) Then
                                BH.Text = hexsum.Substring(0, 2)
                                BL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(2)) Then
                                CH.Text = hexsum.Substring(0, 2)
                                CL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(3)) Then
                                DH.Text = hexsum.Substring(0, 2)
                                DL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(4)) Then
                                SI.Text = hexsum1
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(5)) Then
                                DI.Text = hexsum1
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(6)) Then
                                SP.Text = hexsum1
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(7)) Then
                                BP.Text = hexsum1
                            Else
                                MsgBox("Invalid regtr conbination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            Dim s2 As Long = hex_to_dec(s1)
                            Dim sum As Long = decregrltv1 + s2
                            Dim hexsum As String = Hex(sum)
                            addflagsetting8(hexsum)
                            Dim hexsum1 As String = hexsum + "H"
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = hexsum1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = hexsum1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = hexsum1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = hexsum1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = hexsum1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = hexsum1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = hexsum1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = hexsum1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim s1 As String = TextBox32.Text
                            MsgBox(s1)
                            If s1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(s1)
                                t5.Text = OverFlow8()
                                Dim s2 As Long = hex_to_dec(s1)
                                Dim sum As Long = decregrltv1 + s2
                                Dim hexsum As String = Hex(sum)
                                addflagsetting8(hexsum)
                                Dim hexsum1 As String = hexsum + "H"
                                MsgBox(hexsum1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = hexsum1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = hexsum1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = hexsum1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = hexsum1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = hexsum1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = hexsum1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = hexsum1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = hexsum1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register combination")
                                End If
                            Else
                                MsgBox("Invalid enred value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Opearation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddrgstrrltv()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub SubRegisterRelativeAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v6)

                Dim sumb As Long = s1 + s2

                Dim hexsum As String = Hex(sumb)

                Dim hexsumb As String = hexsum + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsumb)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim k1 As String = TextBox32.Text

                        Dim k2 As Long = hex_to_dec(v3)

                        Dim k3 As Long = hex_to_dec(k1)

                        If k2 > k3 Then
                            Dim bsumdec As Long = k2 - k3
                            Dim bsumhex As String = Hex(bsumdec)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(bsumhex)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(bsumhex)
                            t5.Text = OverFlow()
                            subflagsetting(bsumhex)
                            Dim bsumhex1 As String = bsumhex + "H"
                            MsgBox(bsumhex1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    AH.Text = bsumhex.ToUpper.Substring(0, 2)
                                    AL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    BH.Text = bsumhex.ToUpper.Substring(0, 2)
                                    BL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    CH.Text = bsumhex.ToUpper.Substring(0, 2)
                                    CL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    DH.Text = bsumhex.ToUpper.Substring(0, 2)
                                    DL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = bsumhex1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = bsumhex1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = bsumhex1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = bsumhex1.ToUpper
                            Else
                                MsgBox("Invalid register combination in sum +")
                            End If

                        ElseIf k2 = k3 Or k2 <= k3 Then
                            Dim bsumdec As Long = k2 - k3
                            Dim bsumhex As String = Hex(bsumdec)
                            subflagsetting64(bsumhex)
                            Dim bsumhex1 As String = bsumhex + "H"
                            MsgBox(bsumhex1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    AH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    BH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    CH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If bsumhex.Length = 3 Then
                                    Dim hexbm As String = "0" + bsumhex
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf bsumhex.Length >= 4 Then
                                    DH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = bsumhex.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = bsumhex.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = bsumhex.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = bsumhex.ToUpper
                            Else
                                MsgBox("Invalid register combination in sum +")
                            End If
                        Else
                            MsgBox("Invalid, substraction cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                If s1 > s2 Then

                    Dim sumb As Long = s1 - s2

                    Dim hexsum As String = Hex(sumb)

                    Dim hexsumb As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text

                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 > k3 Then
                                Dim bsumdec As Long = k2 - k3

                                Dim bsumhex As String = Hex(bsumdec)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(bsumhex)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(bsumhex)
                                t5.Text = OverFlow()
                                subflagsetting(bsumhex)
                                Dim bsumhex1 As String = bsumhex + "H"
                                MsgBox(bsumhex1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        AH.Text = bsumhex.ToUpper.Substring(0, 2)
                                        AL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        BH.Text = bsumhex.ToUpper.Substring(0, 2)
                                        BL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        CH.Text = bsumhex.ToUpper.Substring(0, 2)
                                        CL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        DH.Text = bsumhex.ToUpper.Substring(0, 2)
                                        DL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = bsumhex1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = bsumhex1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = bsumhex1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = bsumhex1.ToUpper

                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim bsumdec As Long = k2 - k3
                                Dim bsumhex As String = Hex(bsumdec)
                                subflagsetting64(bsumhex)
                                Dim bsumhex1 As String = bsumhex + "H"
                                MsgBox(bsumhex1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        AH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        BH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        CH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If bsumhex.Length = 3 Then
                                        Dim hexbm As String = "0" + bsumhex
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf bsumhex.Length >= 4 Then
                                        DH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = bsumhex.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = bsumhex.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = bsumhex.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = bsumhex.ToUpper

                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            Else
                                MsgBox("Invalid sub cant be preformed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v6)

                Dim sumb As Long = s1 + s2

                Dim hexsum As String = Hex(sumb)

                Dim hexsumb As String = hexsum + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsumb)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 > k3 Then
                                Dim bsumdec As Long = k2 - k3

                                Dim bsumhex As String = Hex(bsumdec)
                                MsgBox(bsumhex)
                                subflagsetting8(bsumhex)
                                Dim bsumhex1 As String = bsumhex + "H"
                                MsgBox(bsumhex1)
                                If TextBox30.Text.ToUpper.Trim = c(0) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        AH.Text = bsumhex.ToUpper
                                        AL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(1) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        AL.Text = bsumhex.ToUpper
                                        AH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(2) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        BH.Text = bsumhex.ToUpper
                                        BL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(3) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        BL.Text = bsumhex.ToUpper
                                        BH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(4) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        CH.Text = bsumhex.ToUpper
                                        CL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(5) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        CL.Text = bsumhex.ToUpper
                                        CH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(6) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        DH.Text = bsumhex.ToUpper
                                        DL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(7) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        DL.Text = bsumhex.ToUpper
                                        DH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim bsumdec As Long = k2 - k3
                                Dim bsumhex As String = Hex(bsumdec)
                                subflagsetting16(bsumhex)
                                Dim bsumhex1 As String = bsumhex + "H"
                                MsgBox(bsumhex1)
                                If TextBox30.Text.ToUpper.Trim = c(0) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        AH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        AL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(1) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        AH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(2) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        BH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        BL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(3) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        BH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(4) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        CH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        CL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(5) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        CH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(6) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        DH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        DL.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(7) Then
                                    If bsumhex1.ToUpper.Length >= 3 Then
                                        DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        DH.Text = "00"
                                    ElseIf bsumhex1.ToUpper.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            Else
                                MsgBox("Invalid, substraction cannot be performed")
                            End If
                        Else
                            MsgBox("substraction of 8 bit cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v6)

                If s1 > s2 Then
                    Dim sumb As Long = s1 - s2

                    Dim hexsum As String = Hex(sumb)

                    Dim hexsumb As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim bsumdec As Long = k2 - k3

                                    Dim bsumhex As String = Hex(bsumdec)

                                    subflagsetting8(bsumhex)
                                    Dim bsumhex1 As String = bsumhex + "H"
                                    MsgBox(bsumhex1)
                                    
                                    If TextBox30.Text.ToUpper.Trim = c(0) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            AH.Text = bsumhex1.ToUpper
                                            AL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(1) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            AL.Text = bsumhex1.ToUpper
                                            AH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(2) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            BH.Text = bsumhex1.ToUpper
                                            BL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(3) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            BL.Text = bsumhex1.ToUpper
                                            BH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(4) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            CH.Text = bsumhex1.ToUpper
                                            CL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(5) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            CL.Text = bsumhex1.ToUpper
                                            CH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(6) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            DH.Text = bsumhex1.ToUpper
                                            DL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(7) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            DL.Text = bsumhex1.ToUpper
                                            DH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    Else
                                        MsgBox("Invalid, substraction cannot be performed")
                                    End If
                                ElseIf k2 = k3 Or k2 <= k3 Then
                                    Dim bsumdec As Long = k2 - k3
                                    Dim bsumhex As String = Hex(bsumdec)
                                    subflagsetting16(bsumhex)
                                    Dim bsumhex1 As String = bsumhex + "H"
                                    MsgBox(bsumhex1)
                                    If TextBox30.Text.ToUpper.Trim = c(0) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            AH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            AL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(1) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            AH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(2) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            BH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(3) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            BH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(4) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            CH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            CL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(5) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            CH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(6) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            DH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            DL.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(7) Then
                                        If bsumhex1.ToUpper.Length >= 3 Then
                                            DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            DH.Text = "00"
                                        ElseIf bsumhex1.ToUpper.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    Else
                                        MsgBox("Invalid, substraction cannot be performed")
                                    End If

                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                                Else
                                    MsgBox("substraction of 8 bit cannot be performed")
                                End If

                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Invalid substraction")
                End If

            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubrgstrrltvMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub andrgstrrltv()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox(v3)
        MsgBox((b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))))
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            MsgBox(v2)
            Dim v4 As String = v3.Substring(1, 4)
            MsgBox(v4)
            Dim v5 As String = TextBox32.Text.ToUpper
            MsgBox(v5)
            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hexa(r)

                            andflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("INvalid destination register")
                            End If

                        Else
                            MsgBox("Invalid hexadecmil enterd")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hexa(r)

                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("INvalid destination register")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction cannot be proseccd")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hex8(r)

                            andflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = r1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = r1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = r1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = r1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v2)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hex8(r)

                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal valie")
                            End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                    Next
                    
                Else
                    MsgBox("Substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandrgstrrltv()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub orrgstrrelativ()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox((b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))))
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            orflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("INvalid destination register")
                            End If

                        Else
                            MsgBox("Invalid hexadecmil enterd")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                orflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("INvalid destination register")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be proseccd")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hex8(r)
                            MsgBox(r1)
                            orflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = r1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = r1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = r1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = r1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hex8(r)
                                orflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal valie")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varorrgstrrltv()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub adcrgstrrltv()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim s1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim s2 As Long = hex_to_dec(s1)
                        Dim sum As Long = decregrltv1 + s2
                        Dim hexsum2 As String = Hex(sum)
                        AddFlagSetting(hexsum2)
                        Dim p1 As String = t16.Text
                        Dim p2 As Long = hex_to_dec(p1)
                        Dim p3 As Long = sum + p2
                        Dim hexsum As String = Hex(p3)
                        Dim hexsum1 As String = hexsum + "H"
                        MsgBox(hexsum1)
                        If TextBox30.Text.ToUpper.Trim = b(0) Then
                            AH.Text = hexsum.Substring(0, 2)
                            AL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(1)) Then
                            BH.Text = hexsum.Substring(0, 2)
                            BL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(2)) Then
                            CH.Text = hexsum.Substring(0, 2)
                            CL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(3)) Then
                            DH.Text = hexsum.Substring(0, 2)
                            DL.Text = hexsum.Substring(2, 2)
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(4)) Then
                            SI.Text = hexsum1
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(5)) Then
                            DI.Text = hexsum1
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(6)) Then
                            SP.Text = hexsum1
                        ElseIf (TextBox30.Text.Trim.ToUpper = b(7)) Then
                            BP.Text = hexsum1
                        Else
                            MsgBox("Invalid regtr conbination")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    MsgBox(adddec)
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim s1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow()
                            Dim s2 As Long = hex_to_dec(s1)
                            Dim sum As Long = decregrltv1 + s2
                            MsgBox(sum)
                            Dim hexsum2 As String = Hex(sum)
                            MsgBox(hexsum2)
                            AddFlagSetting(hexsum2)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = sum + p2
                            Dim hexsum As String = Hex(p3)
                            Dim hexsum1 As String = hexsum + "H"
                            MsgBox(hexsum1)
                            If TextBox30.Text.ToUpper.Trim = b(0) Then
                                AH.Text = hexsum.Substring(0, 2)
                                AL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(1)) Then
                                BH.Text = hexsum.Substring(0, 2)
                                BL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(2)) Then
                                CH.Text = hexsum.Substring(0, 2)
                                CL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(3)) Then
                                DH.Text = hexsum.Substring(0, 2)
                                DL.Text = hexsum.Substring(2, 2)
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(4)) Then
                                SI.Text = hexsum1
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(5)) Then
                                DI.Text = hexsum1
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(6)) Then
                                SP.Text = hexsum1
                            ElseIf (TextBox30.Text.Trim.ToUpper = b(7)) Then
                                BP.Text = hexsum1
                            Else
                                MsgBox("Invalid regtr conbination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            Dim s2 As Long = hex_to_dec(s1)
                            Dim sum As Long = decregrltv1 + s2
                            Dim hexsum2 As String = Hex(sum)
                            MsgBox(hexsum2)
                            addflagsetting8(hexsum2)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = sum + p2
                            Dim hexsum As String = Hex(p3)
                            Dim hexsum1 As String = hexsum + "H"
                            MsgBox(hexsum1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = hexsum1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = hexsum1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = hexsum1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = hexsum1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = hexsum1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = hexsum1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = hexsum1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = hexsum1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim s1 As String = TextBox32.Text
                            If s1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(s1)
                                t5.Text = OverFlow8()
                                Dim s2 As Long = hex_to_dec(s1)
                                Dim sum As Long = decregrltv1 + s2
                                Dim hexsum2 As String = Hex(sum)
                                addflagsetting8(hexsum2)
                                Dim p1 As String = t16.Text
                                Dim p2 As Long = hex_to_dec(p1)
                                Dim p3 As Long = sum + p2
                                Dim hexsum As String = Hex(p3)
                                Dim hexsum1 As String = hexsum + "H"
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = hexsum1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = hexsum1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = hexsum1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = hexsum1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = hexsum1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = hexsum1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = hexsum1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = hexsum1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register combination")
                                End If
                            Else
                                MsgBox("Invalid enred value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Opearation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub xchgbaserltvMode()
        Dim v1 As String = InputBox("Enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v1.Length = 5 And v1.ToUpper.EndsWith("H") And (v2.Length = 10 Or v2.Length = 11 Or v2.Length = 12 Or v2.Length = 13) And (v2.ToUpper.ElementAt(8) = "H" Or v2.ToUpper.ElementAt(9) = "H" Or v2.ToUpper.ElementAt(10) = "H" Or v2.ToUpper.ElementAt(11) = "H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s2 As Long = hex_to_dec(v4)
                Dim s3 As Long = hex_to_dec(v6)
                Dim v7 As Long = s2 + s3
                Dim v8 As String = Hex(v7)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v8)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v8)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        DataGridView1.Rows.Add(New String() {v8, v3})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If k1.Length = 4 Then
                                AH.Text = k1.ToUpper.Substring(0, 2)
                                AL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                AH.Text = k3.ToUpper.Substring(0, 2)
                                AL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If k1.Length = 4 Then
                                BH.Text = k1.ToUpper.Substring(0, 2)
                                BL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                BH.Text = k3.ToUpper.Substring(0, 2)
                                BL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If k1.Length = 4 Then
                                CH.Text = k1.ToUpper.Substring(0, 2)
                                CL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                CH.Text = k3.ToUpper.Substring(0, 2)
                                CL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If k1.Length = 4 Then
                                DH.Text = k1.ToUpper.Substring(0, 2)
                                DL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                DH.Text = k3.ToUpper.Substring(0, 2)
                                DL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            If k1.Length = 4 Then
                                SI.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                SI.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            If k1.Length = 4 Then
                                DI.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                DI.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            If k1.Length = 4 Then
                                SP.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                SP.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            If k1.Length = 4 Then
                                BP.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                BP.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        Else
                            MsgBox("Invalid combination of register")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next      
            ElseIf v2.ToUpper.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s2 As Long = hex_to_dec(v4)
                Dim s3 As Long = hex_to_dec(v6)
                If s2 > s3 Then
                    Dim v7 As Long = s2 - s3
                    Dim v8 As String = Hex(v7)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(v8)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + v8)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {v8, v3})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If k1.Length = 4 Then
                                    AH.Text = k1.ToUpper.Substring(0, 2)
                                    AL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    AH.Text = k3.ToUpper.Substring(0, 2)
                                    AL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If k1.Length = 4 Then
                                    BH.Text = k1.ToUpper.Substring(0, 2)
                                    BL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    BH.Text = k3.ToUpper.Substring(0, 2)
                                    BL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If k1.Length = 4 Then
                                    CH.Text = k1.ToUpper.Substring(0, 2)
                                    CL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    CH.Text = k3.ToUpper.Substring(0, 2)
                                    CL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If k1.Length = 4 Then
                                    DH.Text = k1.ToUpper.Substring(0, 2)
                                    DL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    DH.Text = k3.ToUpper.Substring(0, 2)
                                    DL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If k1.Length = 4 Then
                                    SI.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    SI.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If k1.Length = 4 Then
                                    DI.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    DI.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If k1.Length = 4 Then
                                    SP.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    SP.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If k1.Length = 4 Then
                                    BP.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    BP.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            Else
                                MsgBox("Invalid combination of register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next                 
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v1.Length = 3 And v1.ToUpper.EndsWith("H") And (v2.Length = 10 Or v2.Length = 11 Or v2.Length = 12 Or v2.Length = 13) And (v2.ToUpper.ElementAt(8) = "H" Or v2.ToUpper.ElementAt(9) = "H" Or v2.ToUpper.ElementAt(10) = "H" Or v2.ToUpper.ElementAt(11) = "H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s2 As Long = hex_to_dec(v4)
                Dim s3 As Long = hex_to_dec(v6)
                Dim v7 As Long = s2 + s3
                Dim v8 As String = Hex(v7)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v8)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v8)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        DataGridView1.Rows.Add(New String() {v8, v3})

                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = k1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = k1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = k1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = k1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = k1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = k1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = k1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = k1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid combination of register")
                            End If
                        Else
                            MsgBox("Invalid 8 bit hexadecimal value foe xchg operation")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next      
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s2 As Long = hex_to_dec(v4)

                Dim s3 As Long = hex_to_dec(v6)

                If s2 > s3 Then
                    Dim v7 As Long = s2 - s3

                    Dim v8 As String = Hex(v7)

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(v8)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + v8)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {v8, v3})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = k1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = k1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = k1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = k1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = k1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = k1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = k1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = k1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid combination of register")
                                End If
                            Else
                                MsgBox("Invalid 8 bit hexadecimal value foe xchg operation")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be processed")
                End If
            Else
                MsgBox("Invalid sign Operaion")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub testrgstrrltv()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hexa(r)
                            MsgBox(r1)
                            testflagsetting(r1)

                        ElseIf u1.Length = 2 Then
                            Dim u2 As String = "00" + u1
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u2)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hexa(r)

                            testflagsetting(r1)

                        Else
                            MsgBox("Invalid hexadecmil enterd")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    MsgBox(adddec)
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                testflagsetting(r1)

                            ElseIf u1.Length = 2 Then
                                Dim u2 As String = "00" + u1
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u2)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                testflagsetting(r1)

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be proseccd")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hex8(r)
                            MsgBox(r1)
                            testflagsetting8(r1)

                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hex8(r)
                                MsgBox(r1)
                                testflagsetting8(r1)

                            Else
                                MsgBox("Invalid hexadecimal valie")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub sbbbaserltv()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v6)
                Dim sumb As Long = s1 + s2
                Dim hexsum As String = Hex(sumb)
                Dim hexsumb As String = hexsum + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsumb)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim k1 As String = TextBox32.Text
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        If k2 > k3 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim bsumdec As Long = k2 - k3
                            Dim subhex2 As String = Hex(bsumdec)
                            subflagsetting(subhex2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = bsumdec - p1
                            Dim bsumhex As String = Hex(p2)
                            Dim bsumhex1 As String = bsumhex + "H"

                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If bsumhex.Length = 4 Then
                                    AH.Text = bsumhex.ToString.Substring(0, 2)
                                    AL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If bsumhex.Length = 4 Then
                                    BH.Text = bsumdec.ToString.Substring(0, 2)
                                    BL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If bsumhex.Length = 4 Then
                                    CH.Text = bsumdec.ToString.Substring(0, 2)
                                    CL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If bsumhex.Length = 4 Then
                                    DH.Text = bsumdec.ToString.Substring(0, 2)
                                    DL.Text = bsumhex.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = bsumhex1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = bsumhex1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = bsumhex1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = bsumhex1.ToUpper
                            Else
                                MsgBox("Invalid register combination in sum +")
                            End If
                        ElseIf k2 <= k3 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim bsumdec As Long = k2 - k3
                            Dim subhex2 As String = Hex(bsumdec)
                            subflagsetting64(subhex2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = bsumdec - p1
                            Dim bsumhex As String = Hex(p2)
                            Dim bsumhex1 As String = bsumhex + "H"

                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If bsumhex.Length >= 4 Then
                                    AH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If bsumhex.Length >= 4 Then
                                    BH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If bsumhex.Length >= 4 Then
                                    CH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If bsumhex.Length >= 4 Then
                                    DH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                    DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                Else
                                    MsgBox("Invalid ax reg")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = bsumhex.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = bsumhex.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = bsumhex.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = bsumhex.ToUpper
                            Else
                                MsgBox("Invalid register combination in sum +")
                            End If
                        Else
                            MsgBox("Invalid, substraction cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next      
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                If s1 > s2 Then
                    Dim sumb As Long = s1 - s2
                    Dim hexsum As String = Hex(sumb)
                    Dim hexsumb As String = hexsum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 > k3 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim bsumdec As Long = k2 - k3
                                Dim subhex2 As String = Hex(bsumdec)
                                subflagsetting(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsumdec - p1
                                Dim bsumhex As String = Hex(p2)
                                Dim bsumhex1 As String = bsumhex + "H"
                                MsgBox(bsumhex1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If bsumhex.Length = 4 Then
                                        AH.Text = bsumhex.ToString.Substring(0, 2)
                                        AL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If bsumhex.Length = 4 Then
                                        BH.Text = bsumdec.ToString.Substring(0, 2)
                                        BL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If bsumhex.Length = 4 Then
                                        CH.Text = bsumdec.ToString.Substring(0, 2)
                                        CL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If bsumhex.Length = 4 Then
                                        DH.Text = bsumdec.ToString.Substring(0, 2)
                                        DL.Text = bsumhex.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = bsumhex1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = bsumhex1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = bsumhex1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = bsumhex1.ToUpper

                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            ElseIf k2 <= k3 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim bsumdec As Long = k2 - k3
                                Dim subhex2 As String = Hex(bsumdec)
                                subflagsetting64(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsumdec - p1
                                Dim bsumhex As String = Hex(p2)
                                Dim bsumhex1 As String = bsumhex + "H"
                                MsgBox(bsumhex1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If bsumhex.Length >= 4 Then
                                        AH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If bsumhex.Length >= 4 Then
                                        BH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If bsumhex.Length >= 4 Then
                                        CH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If bsumhex.Length >= 4 Then
                                        DH.Text = bsumhex.Substring(bsumhex.Length - 4, 2)
                                        DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid ax reg")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = bsumhex.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = bsumhex.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = bsumhex.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = bsumhex.ToUpper
                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            Else
                                MsgBox("Invalid sub cant be preformed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v6)
                Dim sumb As Long = s1 + s2
                Dim hexsum As String = Hex(sumb)
                Dim hexsumb As String = hexsum + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + hexsumb)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim bsumdec As Long = k2 - k3
                                Dim subhex2 As String = Hex(bsumdec)
                                subflagsetting8(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsumdec - p1
                                Dim bsumhex As String = Hex(p2)
                                Dim bsumhex1 As String = bsumhex + "H"

                                If TextBox30.Text.ToUpper.Trim = c(0) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        AH.Text = bsumhex1.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(1) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        AL.Text = bsumhex1.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(2) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        BH.Text = bsumhex1.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(3) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        BL.Text = bsumhex1.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(4) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        CH.Text = bsumhex1.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(5) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        CL.Text = bsumhex1.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(6) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        DH.Text = bsumhex1.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                ElseIf TextBox30.Text.ToUpper.Trim = c(7) Then
                                    If bsumhex1.ToUpper.Length = 3 Then
                                        DL.Text = bsumhex1.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid op")
                                    End If
                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            ElseIf k2 <= k3 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim bsumdec As Long = k2 - k3
                                Dim subhex2 As String = Hex(bsumdec)
                                subflagsetting16(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = bsumdec - p1
                                Dim bsumhex As String = Hex(p2)
                                Dim bsumhex1 As String = bsumhex + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If bsumhex1.Length >= 3 Then
                                        AH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        AL.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If bsumhex1.Length >= 3 Then
                                        AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        AH.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If bsumhex1.Length >= 3 Then
                                        BH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        BL.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If bsumhex1.Length >= 3 Then
                                        BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        BH.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If bsumhex1.Length >= 3 Then
                                        CH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        CL.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If bsumhex1.Length >= 3 Then
                                        CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        CH.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If bsumhex1.Length >= 3 Then
                                        DH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        DL.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If bsumhex1.Length >= 3 Then
                                        DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                        DH.Text = "00"
                                    ElseIf bsumhex1.Length = 2 Then
                                        Dim sb As String = "0" + bsumhex.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                Else
                                    MsgBox("Invalid Combination")
                                End If
                            Else
                                MsgBox("Invalid, substraction cannot be performed")
                            End If
                        Else
                            MsgBox("substraction of 8 bit cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next            
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v6)
                If s1 > s2 Then
                    Dim sumb As Long = s1 - s2
                    Dim hexsum As String = Hex(sumb)
                    Dim hexsumb As String = hexsum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                If k2 > k3 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim bsumdec As Long = k2 - k3
                                    Dim subhex2 As String = Hex(bsumdec)
                                    subflagsetting8(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = bsumdec - p1
                                    Dim bsumhex As String = Hex(p2)
                                    Dim bsumhex1 As String = bsumhex + "H"
                                    MsgBox(bsumhex1)
                                    If TextBox30.Text.ToUpper.Trim = c(0) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            AH.Text = bsumhex1.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(1) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            AL.Text = bsumhex1.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(2) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            BH.Text = bsumhex1.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(3) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            BL.Text = bsumhex1.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(4) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            CH.Text = bsumhex1.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(5) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            CL.Text = bsumhex1.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(6) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            DH.Text = bsumhex1.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    ElseIf TextBox30.Text.ToUpper.Trim = c(7) Then
                                        If bsumhex1.ToUpper.Length = 3 Then
                                            DL.Text = bsumhex1.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid op")
                                        End If
                                    Else
                                        MsgBox("Invalid, substraction cannot be performed")
                                    End If
                                ElseIf k2 <= k3 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim bsumdec As Long = k2 - k3
                                    Dim subhex2 As String = Hex(bsumdec)
                                    subflagsetting16(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = bsumdec - p1
                                    Dim bsumhex As String = Hex(p2)
                                    Dim bsumhex1 As String = bsumhex + "H"
                                    MsgBox(bsumhex1)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If bsumhex1.Length >= 3 Then
                                            AH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            AL.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If bsumhex1.Length >= 3 Then
                                            AL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            AH.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If bsumhex1.Length >= 3 Then
                                            BH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If bsumhex1.Length >= 3 Then
                                            BL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            BH.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If bsumhex1.Length >= 3 Then
                                            CH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            CL.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If bsumhex1.Length >= 3 Then
                                            CL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            CH.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If bsumhex1.Length >= 3 Then
                                            DH.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            DL.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If bsumhex1.Length >= 3 Then
                                            DL.Text = bsumhex.Substring(bsumhex.Length - 2, 2)
                                            DH.Text = "00"
                                        ElseIf bsumhex1.Length = 2 Then
                                            Dim sb As String = "0" + bsumhex.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                Else
                                    MsgBox("Invalid, substraction cannot be performed")
                                End If
                            Else
                                MsgBox("substraction of 8 bit cannot be performed")
                            End If

                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub cmprgtrrltv()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                MsgBox(s1)
                Dim s2 As Long = hex_to_dec(v6)
                Dim sumb As Long = s1 + s2
                Dim hexsum As String = Hex(sumb)
                Dim hexsumb As String = hexsum + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim values1 As String = InputBox("enter the value for" + hexsumb)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        DataGridView1.Rows.Add(New String() {hexsumb, values1})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        cmpflagsetting(k2, k3)
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                If s1 > s2 Then
                    MsgBox(s2)
                    Dim sumb As Long = s1 - s2

                    Dim hexsum As String = Hex(sumb)

                    Dim hexsumb As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {hexsumb, values1})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            cmpflagsetting(k2, k3)
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next                   
                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v6)

                Dim sumb As Long = s1 + s2

                Dim hexsum As String = Hex(sumb)

                Dim hexsumb As String = hexsum + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexsum)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then

                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim values1 As String = InputBox("enter the value for" + hexsumb)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        DataGridView1.Rows.Add(New String() {hexsumb, values1})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            cmpflagsetting(k2, k3)
                        Else
                            MsgBox("substraction of 8 bit cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v6)
                If s1 > s2 Then
                    Dim sumb As Long = s1 - s2
                    Dim hexsum As String = Hex(sumb)

                    Dim hexsumb As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then

                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {hexsumb, values1})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim k2 As Long = hex_to_dec(v3)
                                MsgBox(k2)
                                Dim k3 As Long = hex_to_dec(k1)
                                MsgBox(k3)
                                cmpflagsetting(k2, k3)
                            Else
                                MsgBox("substraction of 8 bit cannot be performed")
                            End If

                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub MOVRelativeBaseIndexMode()
        Dim v1 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.ToUpper)) Then
            Dim v2 As String = v1.ToUpper.Substring(1, 4)
            Dim v3 As String = v1.ToUpper.Substring(7, 4)
            Dim v4 As String = v1.ToUpper
            If v1.ToUpper.ElementAt(6) = "+" And v1.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v4.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)
                Dim s2 As Long = hex_to_dec(v3)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s2
                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    MsgBox(sumh2)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            MsgBox(k1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If k1.Length = 4 Then
                                    AH.Text = k1.ToUpper.Substring(0, 2)
                                    AL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If k1.Length = 4 Then
                                    BH.Text = k1.ToUpper.Substring(0, 2)
                                    BL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If k1.Length = 4 Then
                                    CH.Text = k1.ToUpper.Substring(0, 2)
                                    CL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If k1.Length = 4 Then
                                    DH.Text = k1.ToUpper.Substring(0, 2)
                                    DL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If k1.Length = 4 Then
                                    SI.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    SI.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If k1.Length = 4 Then
                                    DI.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    DI.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If k1.Length = 4 Then
                                    SP.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    SP.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If k1.Length = 4 Then
                                    BP.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    BP.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be processed")
                End If
            ElseIf v1.ToUpper.ElementAt(6) = "-" And v1.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v4.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)
                Dim s2 As Long = hex_to_dec(v3)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s3
                MsgBox(sum1)
                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    MsgBox(sumh2)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If k1.Length = 4 Then
                                    AH.Text = k1.ToUpper.Substring(0, 2)
                                    AL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If k1.Length = 4 Then
                                    BH.Text = k1.ToUpper.Substring(0, 2)
                                    BL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If k1.Length = 4 Then
                                    CH.Text = k1.ToUpper.Substring(0, 2)
                                    CL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If k1.Length = 4 Then
                                    DH.Text = k1.ToUpper.Substring(0, 2)
                                    DL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    AH.Text = k2.ToUpper.Substring(0, 2)
                                    AL.Text = k2.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If k1.Length = 4 Then
                                    SI.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    SI.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If k1.Length = 4 Then
                                    DI.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    DI.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If k1.Length = 4 Then
                                    SP.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    SP.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If k1.Length = 4 Then
                                    BP.Text = k1.ToUpper
                                ElseIf k1.Length = 2 Then
                                    Dim k2 As String = "00" + k1
                                    BP.Text = k2.ToUpper
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction Canot be performed")
                End If
            ElseIf v1.ToUpper.ElementAt(6) = "+" And v1.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v4.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                'MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                'MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)

                Dim s2 As Long = hex_to_dec(v3)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + s3
                'MsgBox(sum1)
                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"
                'MsgBox(sumh2)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim k1 As String = TextBox32.Text

                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If k1.Length = 4 Then
                                AH.Text = k1.ToUpper.Substring(0, 2)
                                AL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                AH.Text = k2.ToUpper.Substring(0, 2)
                                AL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid number value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If k1.Length = 4 Then
                                BH.Text = k1.ToUpper.Substring(0, 2)
                                BL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                AH.Text = k2.ToUpper.Substring(0, 2)
                                AL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid number value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If k1.Length = 4 Then
                                CH.Text = k1.ToUpper.Substring(0, 2)
                                CL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                AH.Text = k2.ToUpper.Substring(0, 2)
                                AL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid number value")
                            End If

                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If k1.Length = 4 Then
                                DH.Text = k1.ToUpper.Substring(0, 2)
                                DL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                AH.Text = k2.ToUpper.Substring(0, 2)
                                AL.Text = k2.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid number value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            If k1.Length = 4 Then
                                SI.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                SI.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid number value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            If k1.Length = 4 Then
                                DI.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                DI.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid number value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            If k1.Length = 4 Then
                                SP.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                SP.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid number value")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            If k1.Length = 4 Then
                                BP.Text = k1.ToUpper
                            ElseIf k1.Length = 2 Then
                                Dim k2 As String = "00" + k1
                                BP.Text = k2.ToUpper
                            Else
                                MsgBox("Invalid number value")
                            End If
                        Else
                            MsgBox("Invalid reg combination")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v1.ToUpper.ElementAt(6) = "-" And v1.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v4.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)
                Dim s2 As Long = hex_to_dec(v3)            
                Dim s3 As Long = hex_to_dec(v7)             
                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2
                    'MsgBox(sum1)
                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3                    
                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"
                        MsgBox(sumh2)
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If k1.Length = 4 Then
                                        AH.Text = k1.ToUpper.Substring(0, 2)
                                        AL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        AH.Text = k2.ToUpper.Substring(0, 2)
                                        AL.Text = k2.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If k1.Length = 4 Then
                                        BH.Text = k1.ToUpper.Substring(0, 2)
                                        BL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        AH.Text = k2.ToUpper.Substring(0, 2)
                                        AL.Text = k2.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If k1.Length = 4 Then
                                        CH.Text = k1.ToUpper.Substring(0, 2)
                                        CL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        AH.Text = k2.ToUpper.Substring(0, 2)
                                        AL.Text = k2.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If k1.Length = 4 Then
                                        DH.Text = k1.ToUpper.Substring(0, 2)
                                        DL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        AH.Text = k2.ToUpper.Substring(0, 2)
                                        AL.Text = k2.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    If k1.Length = 4 Then
                                        SI.Text = k1.ToUpper
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        SI.Text = k2.ToUpper
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    If k1.Length = 4 Then
                                        DI.Text = k1.ToUpper
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        DI.Text = k2.ToUpper
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    If k1.Length = 4 Then
                                        SP.Text = k1.ToUpper
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        SP.Text = k2.ToUpper
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    If k1.Length = 4 Then
                                        BP.Text = k1.ToUpper
                                    ElseIf k1.Length = 2 Then
                                        Dim k2 As String = "00" + k1
                                        BP.Text = k2.ToUpper
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Substraction Cannot be processd")
                    End If
                Else
                    MsgBox("Substraction Cannot be processd")
                End If
            Else
                MsgBox("Invalid sign Opearion")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v2 As String = v1.ToUpper.Substring(1, 4)
            Dim v3 As String = v1.ToUpper.Substring(7, 4)
            Dim v4 As String = v1.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v4.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1
                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)             
                Dim s2 As Long = hex_to_dec(v3)               
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s2              
                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    MsgBox(sumh2)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                MsgBox(k1)
                                Dim sumh3 As String = Hex(k1)
                                MsgBox(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh3.Length = 2 Then
                                        AH.Text = sumh4.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh3.Length = 2 Then
                                        AL.Text = sumh4.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh3.Length = 2 Then
                                        BH.Text = sumh4.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh3.Length = 2 Then
                                        BL.Text = sumh4.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh3.Length = 2 Then
                                        CH.Text = sumh4.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh3.Length = 2 Then
                                        CL.Text = sumh4.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh3.Length = 2 Then
                                        DH.Text = sumh4.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh3.Length = 2 Then
                                        DL.Text = sumh4.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be perormed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v4.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)              
                Dim s2 As Long = hex_to_dec(v3)              
                Dim s3 As Long = hex_to_dec(v7)               
                Dim sum1 As Long = s1 + s3               
                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2                  
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    MsgBox(sumh2)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim sumh3 As String = Hex(k1)
                                MsgBox(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh3.Length = 2 Then
                                        AH.Text = sumh4.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh3.Length = 2 Then
                                        AL.Text = sumh4.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh3.Length = 2 Then
                                        BH.Text = sumh4.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh3.Length = 2 Then
                                        BL.Text = sumh4.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh3.Length = 2 Then
                                        CH.Text = sumh4.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh3.Length = 2 Then
                                        CL.Text = sumh4.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh3.Length = 2 Then
                                        DH.Text = sumh4.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh3.Length = 2 Then
                                        DL.Text = sumh4.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("enterd value is not an 8 bit value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v4.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v2)      
                Dim s2 As Long = hex_to_dec(v3)
                Dim s3 As Long = hex_to_dec(v7)              
                Dim sum1 As Long = s1 + s2 + 3
                MsgBox(sum1)
                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"
                MsgBox(sumh2)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then                         
                            Dim sumh3 As String = Hex(k1)
                            MsgBox(sumh3)
                            Dim sumh4 As String = sumh3 + "H"
                            MsgBox(sumh4)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                If sumh3.Length = 2 Then
                                    AH.Text = sumh4.ToUpper
                                    AL.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                If sumh3.Length = 2 Then
                                    AL.Text = sumh4.ToUpper
                                    AH.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                If sumh3.Length = 2 Then
                                    BH.Text = sumh4.ToUpper
                                    BL.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                If sumh3.Length = 2 Then
                                    BL.Text = sumh4.ToUpper
                                    BH.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                If sumh3.Length = 2 Then
                                    CH.Text = sumh4.ToUpper
                                    CL.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                If sumh3.Length = 2 Then
                                    CL.Text = sumh4.ToUpper
                                    CH.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                If sumh3.Length = 2 Then
                                    DH.Text = sumh4.ToUpper
                                    DL.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                If sumh3.Length = 2 Then
                                    DL.Text = sumh4.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid enterd hexa value")
                                End If
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("enterd value is not an 8 bit value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v4.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length And count2 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim s1 As Long = hex_to_dec(v2)
                Dim s2 As Long = hex_to_dec(v3)              
                Dim s3 As Long = hex_to_dec(v7)
                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2           
                    If sum1 > s3 Then
                        If sum1 > s3 Then
                            Dim sum2 As Long = sum1 - s3
                            Dim sumh1 As String = Hex(sum2)
                            Dim sumh2 As String = sumh1 + "H"
                            MsgBox(sumh2)
                            Dim flagValue As Boolean = False
                            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                                Dim f As Integer = hex_to_dec(sumh1)
                                Dim f1 As Integer = hex_to_dec(tempstr)
                                If (f = f1) Then
                                    Dim values1 As String = InputBox("enter the value for" + sumh2)
                                    DataGridView1.Rows(f).Cells(1).Value = values1
                                    TextBox32.Text = values1
                                    Dim k1 As String = TextBox32.Text
                                    If k1.Length = 2 Then
                                        MsgBox(k1)
                                        Dim sumh3 As String = Hex(k1)
                                        MsgBox(sumh3)
                                        Dim sumh4 As String = sumh3 + "H"
                                        MsgBox(sumh4)
                                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                                            If sumh3.Length = 2 Then
                                                AH.Text = sumh4.ToUpper
                                                AL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                            If sumh3.Length = 2 Then
                                                AL.Text = sumh4.ToUpper
                                                AH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                            If sumh3.Length = 2 Then
                                                BH.Text = sumh4.ToUpper
                                                BL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                            If sumh3.Length = 2 Then
                                                BL.Text = sumh4.ToUpper
                                                BH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                            If sumh3.Length = 2 Then
                                                CH.Text = sumh4.ToUpper
                                                CL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                            If sumh3.Length = 2 Then
                                                CL.Text = sumh4.ToUpper
                                                CH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                            If sumh3.Length = 2 Then
                                                DH.Text = sumh4.ToUpper
                                                DL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                            If sumh3.Length = 2 Then
                                                DL.Text = sumh4.ToUpper
                                                DH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        Else
                                            MsgBox("Invalid reg combination")
                                        End If
                                    Else
                                        MsgBox("enterd value is not an 8 bit value")
                                    End If
                                    flagValue = False
                                    Exit For
                                Else
                                    flagValue = True
                                End If
                            Next

                        Else
                            MsgBox("Substraction cannot be performed")
                        End If
                    Else
                        MsgBox("Substraction cannot be performed")
                    End If
                Else
                    MsgBox("Substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Opearion")
            End If
        Else
            MsgBox("INvalid rltv based index mode add mode")
        End If
    End Sub
    Sub AddRelativeBaseIndexAddressing()

        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v1.Length = 5 And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1
                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim decs1 As Long = hex_to_dec(s1)
                        Dim sumdec As Long = adddec1 + decs1
                        Dim sumdec1 As String = Hex(sumdec)
                        AddFlagSetting(sumdec1)
                        Dim sumdec2 As String = sumdec1 + "H"
                        If TextBox30.Text.ToUpper.Trim = b(0) Then

                            AH.Text = sumdec1.Substring(0, 2)
                            AL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                            BH.Text = sumdec1.Substring(0, 2)
                            BL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                            CH.Text = sumdec1.Substring(0, 2)
                            CL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                            DH.Text = sumdec1.Substring(0, 2)
                            DL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                            SI.Text = sumdec2
                        ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                            DI.Text = sumdec2
                        ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                            SP.Text = sumdec2
                        ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                            BP.Text = sumdec2
                        Else
                            MsgBox("Invalid regtr conbination")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim u2 As Long = hex_to_dec(u1)
                            Dim s3 As Long = u2 + adddec1
                            MsgBox(s3)
                            Dim sumdec1 As String = Hex(s3)
                            AddFlagSetting(sumdec1)
                            Dim sumdec2 As String = sumdec1 + "H"

                            If TextBox30.Text.ToUpper.Trim = b(0) Then

                                AH.Text = sumdec1.Substring(0, 2)
                                AL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                                BH.Text = sumdec1.Substring(0, 2)
                                BL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                                CH.Text = sumdec1.Substring(0, 2)
                                CL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                                DH.Text = sumdec1.Substring(0, 2)
                                DL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                                SI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                                DI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                                SP.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                                BP.Text = sumdec2
                            Else
                                MsgBox("Invalid regtr conbination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Invalid sumstraction")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then

                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim u2 As Long = hex_to_dec(u1)
                            Dim s3 As Long = u2 + adddec1

                            Dim sumdec1 As String = Hex(s3)

                            AddFlagSetting(sumdec1)
                            Dim sumdec2 As String = sumdec1 + "H"

                            If TextBox30.Text.ToUpper.Trim = b(0) Then

                                AH.Text = sumdec1.Substring(0, 2)
                                AL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                                BH.Text = sumdec1.Substring(0, 2)
                                BL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                                CH.Text = sumdec1.Substring(0, 2)
                                CL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                                DH.Text = sumdec1.Substring(0, 2)
                                DL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                                SI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                                DI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                                SP.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                                BP.Text = sumdec2
                            Else
                                MsgBox("Invalid regtr conbination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("sub cannot be performed")
                End If

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim s3 As Long = u2 + adddec1

                                Dim sumdec1 As String = Hex(s3)

                                AddFlagSetting(sumdec1)
                                Dim sumdec2 As String = sumdec1 + "H"

                                If TextBox30.Text.ToUpper.Trim = b(0) Then

                                    AH.Text = sumdec1.Substring(0, 2)
                                    AL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                                    BH.Text = sumdec1.Substring(0, 2)
                                    BL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                                    CH.Text = sumdec1.Substring(0, 2)
                                    CL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                                    DH.Text = sumdec1.Substring(0, 2)
                                    DL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                                    SI.Text = sumdec2
                                ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                                    DI.Text = sumdec2
                                ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                                    SP.Text = sumdec2
                                ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                                    BP.Text = sumdec2
                                Else
                                    MsgBox("Invalid regtr conbination")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                       
                    Else
                        MsgBox("substraction cannot be performed")
                    End If
                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v1.Length = 3 And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            MsgBox(v5)
            Dim v6 As String = v2.ToUpper
            MsgBox(v6)
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim sumadd As Long = adddec2 + adddec3 + adddec4

                Dim sumadd1 As String = Hex(sumadd)

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            Dim decs1 As Long = hex_to_dec(s1)

                            Dim sumdec As Long = adddec1 + decs1

                            Dim sumdec1 As String = Hex(sumdec)

                            addflagsetting8(sumdec1)
                            Dim sumdec2 As String = sumdec1 + "H"

                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = sumdec2.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                AL.Text = sumdec2.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                BH.Text = sumdec2.ToUpper
                                BL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                BL.Text = sumdec2.ToUpper
                                BH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                CH.Text = sumdec2.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = sumdec2.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = sumdec2.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = sumdec2.ToUpper
                                DH.Text = "00"

                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim s3 As Long = u2 + adddec1

                                Dim sumdec1 As String = Hex(s3)

                                addflagsetting8(sumdec1)
                                Dim sumdec2 As String = sumdec1 + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = sumdec2.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = sumdec2.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = sumdec2.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = sumdec2.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = sumdec2.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = sumdec2.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = sumdec2.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = sumdec2.ToUpper
                                    DH.Text = "00"

                                Else
                                    MsgBox("Invalid reg combination")
                                End If

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Invalid substraction caoot be performed")
                End If

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim s3 As Long = u2 + adddec1

                                Dim sumdec1 As String = Hex(s3)

                                addflagsetting8(sumdec1)
                                Dim sumdec2 As String = sumdec1 + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = sumdec2.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = sumdec2.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = sumdec2.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumdec2.Length = 3 Then
                                        BL.Text = sumdec2.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = sumdec2.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = sumdec2.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = sumdec2.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = sumdec2.ToUpper
                                    DH.Text = "00"

                                Else
                                    MsgBox("Invalid reg combination")
                                End If

                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Invalid substraction cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u2 As Long = hex_to_dec(u1)
                                    Dim s3 As Long = u2 + adddec1
                                    MsgBox(s3)
                                    Dim sumdec1 As String = Hex(s3)

                                    addflagsetting8(sumdec1)
                                    Dim sumdec2 As String = sumdec1 + "H"

                                    If TextBox30.Text.Trim.ToUpper = c(0) Then

                                        AH.Text = sumdec2.ToUpper
                                        AL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                        AL.Text = sumdec2.ToUpper
                                        AH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                        BH.Text = sumdec2.ToUpper
                                        BL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                        BL.Text = sumdec2.ToUpper
                                        BH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                        CH.Text = sumdec2.ToUpper
                                        CL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                        CL.Text = sumdec2.ToUpper
                                        CH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                        DH.Text = sumdec2.ToUpper
                                        DL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                        DL.Text = sumdec2.ToUpper
                                        DH.Text = "00"

                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    
                    Else
                        MsgBox("Invalid substractionn cannot be performed")
                    End If
                Else
                    MsgBox("Invalid substractio cannot be performed")
                End If

            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddrltvbaseMode()
        Else
            MsgBox("INvalid rltv based index mode add mode")
        End If
    End Sub
    Sub SubRelativeBaseIndexAddressing()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2

                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim sumh3 As String = Hex(sum3)
                                subflagsetting(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        AH.Text = sumh3.ToUpper.Substring(0, 2)
                                        AL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        BH.Text = hexbm.ToUpper.Substring(0, 2)
                                        BL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        BH.Text = sumh3.ToUpper.Substring(0, 2)
                                        BL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        CH.Text = hexbm.ToUpper.Substring(0, 2)
                                        CL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        CH.Text = sumh3.ToUpper.Substring(0, 2)
                                        CL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        DH.Text = hexbm.ToUpper.Substring(0, 2)
                                        DL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        DH.Text = sumh3.ToUpper.Substring(0, 2)
                                        DL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh4.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim sumh3 As String = Hex(sum3)
                                subflagsetting64(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        AH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        AL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        BH.Text = hexbm.ToUpper.Substring(0, 2)
                                        BL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        BH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        BL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        CH.Text = hexbm.ToUpper.Substring(0, 2)
                                        CL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        CH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        CL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        DH.Text = hexbm.ToUpper.Substring(0, 2)
                                        DL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        DH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        DL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh3.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s3

                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim sumh3 As String = Hex(sum3)
                                subflagsetting(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        AH.Text = sumh3.ToUpper.Substring(0, 2)
                                        AL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        BH.Text = hexbm.ToUpper.Substring(0, 2)
                                        BL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        BH.Text = sumh3.ToUpper.Substring(0, 2)
                                        BL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        CH.Text = hexbm.ToUpper.Substring(0, 2)
                                        CL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        CH.Text = sumh3.ToUpper.Substring(0, 2)
                                        CL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        DH.Text = hexbm.ToUpper.Substring(0, 2)
                                        DL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        DH.Text = sumh3.ToUpper.Substring(0, 2)
                                        DL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh3.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim sumh3 As String = Hex(sum3)
                                subflagsetting64(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        AH.Text = hexbm.ToUpper.Substring(0, 2)
                                        AL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        AH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        AL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        BH.Text = hexbm.ToUpper.Substring(0, 2)
                                        BL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        BH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        BL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        CH.Text = hexbm.ToUpper.Substring(0, 2)
                                        CL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        CH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        CL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length = 3 Then
                                        Dim hexbm As String = "0" + sumh3
                                        DH.Text = hexbm.ToUpper.Substring(0, 2)
                                        DL.Text = hexbm.ToUpper.Substring(2, 2)
                                    ElseIf sumh3.Length >= 4 Then
                                        DH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                        DL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh3.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Final sub cannot be performed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be possible")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + s3

                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        Dim k2 As Long = hex_to_dec(v3)

                        Dim k3 As Long = hex_to_dec(k1)

                        If k2 > k3 Then
                            Dim sum3 As Long = k2 - k3
                            Dim sumh3 As String = Hex(sum3)
                            subflagsetting(sumh3)
                            Dim sumh4 As String = sumh3 + "H"
                            
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    AH.Text = sumh3.ToUpper.Substring(0, 2)
                                    AL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    BH.Text = hexbm.ToUpper.Substring(0, 2)
                                    BL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    BH.Text = sumh3.ToUpper.Substring(0, 2)
                                    BL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    CH.Text = hexbm.ToUpper.Substring(0, 2)
                                    CL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    CH.Text = sumh3.ToUpper.Substring(0, 2)
                                    CL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    DH.Text = hexbm.ToUpper.Substring(0, 2)
                                    DL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    DH.Text = sumh3.ToUpper.Substring(0, 2)
                                    DL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = sumh4.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = sumh4.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = sumh4.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                BP.Text = sumh4.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        ElseIf k2 = k3 Or k2 <= k3 Then
                            Dim sum3 As Long = k2 - k3
                            Dim sumh3 As String = Hex(sum3)
                            subflagsetting64(sumh3)
                            Dim sumh4 As String = sumh3 + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    AH.Text = hexbm.ToUpper.Substring(0, 2)
                                    AL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    AH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                    AL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    BH.Text = hexbm.ToUpper.Substring(0, 2)
                                    BL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    BH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                    BL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    CH.Text = hexbm.ToUpper.Substring(0, 2)
                                    CL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    CH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                    CL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If sumh3.Length = 3 Then
                                    Dim hexbm As String = "0" + sumh3
                                    DH.Text = hexbm.ToUpper.Substring(0, 2)
                                    DL.Text = hexbm.ToUpper.Substring(2, 2)
                                ElseIf sumh3.Length >= 4 Then
                                    DH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                    DL.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = sumh3.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = sumh3.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = sumh3.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                BP.Text = sumh3.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Final sub cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2

                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim sumh3 As String = Hex(sum3)
                                    subflagsetting(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"
                                    
                                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            AH.Text = hexbm.ToUpper.Substring(0, 2)
                                            AL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            AH.Text = sumh3.ToUpper.Substring(0, 2)
                                            AL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            BH.Text = hexbm.ToUpper.Substring(0, 2)
                                            BL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            BH.Text = sumh3.ToUpper.Substring(0, 2)
                                            BL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            CH.Text = hexbm.ToUpper.Substring(0, 2)
                                            CL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            CH.Text = sumh3.ToUpper.Substring(0, 2)
                                            CL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If

                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            DH.Text = hexbm.ToUpper.Substring(0, 2)
                                            DL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            DH.Text = sumh3.ToUpper.Substring(0, 2)
                                            DL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                        SI.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                        DI.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                        SP.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                        BP.Text = sumh3.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                ElseIf k2 = k3 Or k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim sumh3 As String = Hex(sum3)
                                    subflagsetting64(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"

                                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            AH.Text = hexbm.ToUpper.Substring(0, 2)
                                            AL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            AH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                            AL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            BH.Text = hexbm.ToUpper.Substring(0, 2)
                                            BL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            BH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                            BL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            CH.Text = hexbm.ToUpper.Substring(0, 2)
                                            CL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            CH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                            CL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If

                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                        If sumh3.Length = 3 Then
                                            Dim hexbm As String = "0" + sumh3
                                            AH.Text = hexbm.ToUpper.Substring(0, 2)
                                            AL.Text = hexbm.ToUpper.Substring(2, 2)
                                        ElseIf sumh3.Length >= 4 Then
                                            DH.Text = sumh3.ToUpper.Substring(sumh3.Length - 4, 2)
                                            DL.Text = sumh3.ToUpper.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                        SI.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                        DI.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                        SP.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                        BP.Text = sumh3.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction Cannot be Possible")
                    End If
                Else
                    MsgBox("Substraction Cannot be Possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = v2.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2

                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim sumh3 As String = Hex(sum3)
                                    subflagsetting8(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"
                                    MsgBox(sumh4)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh3.Length >= 2 Then
                                            AH.Text = sumh4.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh3.Length >= 2 Then
                                            AL.Text = sumh4.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh3.Length >= 2 Then
                                            BH.Text = sumh4.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh3.Length >= 2 Then
                                            BL.Text = sumh4.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh3.Length >= 2 Then
                                            CH.Text = sumh4.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh3.Length >= 2 Then
                                            CL.Text = sumh4.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh3.Length >= 2 Then
                                            DH.Text = sumh4.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh3.Length >= 2 Then
                                            DL.Text = sumh4.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                ElseIf k2 = k3 Or k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim sumh3 As String = Hex(sum3)
                                    subflagsetting16(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh3.Length >= 2 Then
                                            AH.Text = sumh4.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh3.Length >= 2 Then
                                            AL.Text = sumh4.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh3.Length >= 2 Then
                                            BH.Text = sumh4.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh3.Length >= 2 Then
                                            BL.Text = sumh4.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh3.Length >= 2 Then
                                            CH.Text = sumh4.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh3.Length >= 2 Then
                                            CL.Text = sumh4.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh3.Length >= 2 Then
                                            DH.Text = sumh4.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh3.Length >= 2 Then
                                            DL.Text = sumh4.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If

                            Else
                                MsgBox("Invalid enterd value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be Possible")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s3

                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text

                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3

                                    Dim sumh3 As String = Hex(sum3)

                                    subflagsetting8(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"
                                    MsgBox(sumh4)
                                   
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh3.Length >= 2 Then
                                            AH.Text = sumh4.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh3.Length >= 2 Then
                                            AL.Text = sumh4.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh3.Length >= 2 Then
                                            BH.Text = sumh4.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh3.Length >= 2 Then
                                            BL.Text = sumh4.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh3.Length >= 2 Then
                                            CH.Text = sumh4.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh3.Length >= 2 Then
                                            CL.Text = sumh4.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh3.Length >= 2 Then
                                            DH.Text = sumh4.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh3.Length >= 2 Then
                                            DL.Text = sumh4.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                ElseIf k2 = k3 Or k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim sumh3 As String = Hex(sum3)
                                    subflagsetting16(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"
                                    MsgBox(sumh4)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh3.Length >= 2 Then
                                            AH.Text = sumh4.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh3.Length >= 2 Then
                                            AL.Text = sumh4.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh3.Length >= 2 Then
                                            BH.Text = sumh4.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh3.Length >= 2 Then
                                            BL.Text = sumh4.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh3.Length >= 2 Then
                                            CH.Text = sumh4.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh3.Length >= 2 Then
                                            CL.Text = sumh4.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh3.Length >= 2 Then
                                            DH.Text = sumh4.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh3.Length >= 2 Then
                                            DL.Text = sumh4.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If
                            Else
                                MsgBox("Enter value is not an 8 bit value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1
                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1
                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1
                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s2 + 3
                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text

                        If k1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim sumh3 As String = Hex(sum3)
                                subflagsetting8(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                MsgBox(sumh4)
                               
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh3.Length >= 2 Then
                                        AH.Text = sumh4.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh3.Length >= 2 Then
                                        AL.Text = sumh4.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh3.Length >= 2 Then
                                        BH.Text = sumh4.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh3.Length >= 2 Then
                                        BL.Text = sumh4.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh3.Length >= 2 Then
                                        CH.Text = sumh4.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh3.Length >= 2 Then
                                        CL.Text = sumh4.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh3.Length >= 2 Then
                                        DH.Text = sumh4.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh3.Length >= 2 Then
                                        DL.Text = sumh4.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            ElseIf k2 = k3 Or k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim sumh3 As String = Hex(sum3)
                                subflagsetting16(sumh3)
                                Dim sumh4 As String = sumh3 + "H"
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh3.Length >= 2 Then
                                        AH.Text = sumh4.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh3.Length >= 2 Then
                                        AL.Text = sumh4.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh3.Length >= 2 Then
                                        BH.Text = sumh4.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh3.Length >= 2 Then
                                        BL.Text = sumh4.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh3.Length >= 2 Then
                                        CH.Text = sumh4.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh3.Length >= 2 Then
                                        CL.Text = sumh4.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh3.Length >= 2 Then
                                        DH.Text = sumh4.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh3.Length >= 2 Then
                                        DL.Text = sumh4.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Final sub cannot be performed")
                            End If
                        Else
                            MsgBox("Enter value is not an 8 bit value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2
                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3
                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim k2 As Long = hex_to_dec(v3)
                                    Dim k3 As Long = hex_to_dec(k1)
                                    If k2 > k3 Then
                                        Dim sum3 As Long = k2 - k3
                                        Dim sumh3 As String = Hex(sum3)
                                        subflagsetting8(sumh3)
                                        Dim sumh4 As String = sumh3 + "H"
                                        MsgBox(sumh4)
                                        
                                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                                            If sumh3.Length >= 2 Then
                                                AH.Text = sumh4.ToUpper
                                                AL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                            If sumh3.Length >= 2 Then
                                                AL.Text = sumh4.ToUpper
                                                AH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                            If sumh3.Length >= 2 Then
                                                BH.Text = sumh4.ToUpper
                                                BL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                            If sumh3.Length >= 2 Then
                                                BL.Text = sumh4.ToUpper
                                                BH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                            If sumh3.Length >= 2 Then
                                                CH.Text = sumh4.ToUpper
                                                CL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                            If sumh3.Length >= 2 Then
                                                CL.Text = sumh4.ToUpper
                                                CH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                            If sumh3.Length >= 2 Then
                                                DH.Text = sumh4.ToUpper
                                                DL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                            If sumh3.Length >= 2 Then
                                                DL.Text = sumh4.ToUpper
                                                DH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        Else
                                            MsgBox("Invalid reg combination")
                                        End If
                                    ElseIf k2 = k3 Or k2 <= k3 Then
                                        Dim sum3 As Long = k2 - k3
                                        Dim sumh3 As String = Hex(sum3)
                                        subflagsetting16(sumh3)
                                        Dim sumh4 As String = sumh3 + "H"
                                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                                            If sumh3.Length >= 2 Then
                                                AH.Text = sumh4.ToUpper
                                                AL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                            If sumh3.Length >= 2 Then
                                                AL.Text = sumh4.ToUpper
                                                AH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                            If sumh3.Length >= 2 Then
                                                BH.Text = sumh4.ToUpper
                                                BL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                            If sumh3.Length >= 2 Then
                                                BL.Text = sumh4.ToUpper
                                                BH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                            If sumh3.Length >= 2 Then
                                                CH.Text = sumh4.ToUpper
                                                CL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                            If sumh3.Length >= 2 Then
                                                CL.Text = sumh4.ToUpper
                                                CH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                            If sumh3.Length >= 2 Then
                                                DH.Text = sumh4.ToUpper
                                                DL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                            If sumh3.Length >= 2 Then
                                                DL.Text = sumh4.ToUpper
                                                DH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        Else
                                            MsgBox("Invalid reg combination")
                                        End If
                                    Else
                                        MsgBox("Final sub cannot be performed")
                                    End If
                                Else
                                    MsgBox("Invalid, ented value outof range")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction cannot be Possible")
                    End If
                Else
                    MsgBox("Substraction cannot be Possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varsubbserltvMode()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub andrltvbase()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox((c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H")))
        If c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        If u1.Length = 4 Then
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction cannot be prossed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                MsgBox(s2)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 4 Then
                                    Dim s3 As String = hex_to_bin(v3)
                                    Dim s4 As String = hex_to_bin(u1)
                                    Dim source As String = s4
                                    Dim dest As String = s3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = hexa(r)
                                    andflagsetting(r1)
                                    If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        AH.Text = r1.ToUpper.Substring(0, 2)
                                        AL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        BH.Text = r1.ToUpper.Substring(0, 2)
                                        BL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        CH.Text = r1.ToUpper.Substring(0, 2)
                                        CL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        DH.Text = r1.ToUpper.Substring(0, 2)
                                        DL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        SI.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        DI.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        SP.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        BP.Text = r1.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Substraction cannot be perfomred")
                    End If
                Else
                    MsgBox("Substraction cannot be perfomred")
                End If
            Else
                MsgBox("Invalid sign opearion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = Hex(r)
                            andflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = r1.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                CH.Text = r1.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = r1.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = r1.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction cannot be processed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1

                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u3 As String = hex_to_bin(v3)
                                    Dim u4 As String = hex_to_bin(u1)
                                    Dim source As String = u4
                                    Dim dest As String = u3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = Hex(r)
                                    andflagsetting8(r1)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then

                                        AH.Text = r1.ToUpper
                                        AL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        AL.Text = r1.ToUpper
                                        AH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                        BH.Text = r1.ToUpper
                                        BL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                        BL.Text = r1.ToUpper
                                        BH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                        CH.Text = r1.ToUpper
                                        CL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                        CL.Text = r1.ToUpper
                                        CH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                        DH.Text = r1.ToUpper
                                        DL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                        DL.Text = r1.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Substraction CAnnot be performed")
                    End If
                Else
                    MsgBox("Substraction CAnnot be performed")
                End If

            Else
                MsgBox("Invlaid sign operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varandrltvbase()
        Else
            MsgBox("Invalid register cobination")
        End If
    End Sub
    Sub orrltvbase()

        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox((c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H")))
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("substraction cannot be prossed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1

                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 4 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow()
                                    Dim s3 As String = hex_to_bin(v3)
                                    Dim s4 As String = hex_to_bin(u1)
                                    Dim source As String = s4
                                    Dim dest As String = s3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = hexa(r)
                                    andflagsetting(r1)
                                    If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        AH.Text = r1.ToUpper.Substring(0, 2)
                                        AL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        BH.Text = r1.ToUpper.Substring(0, 2)
                                        BL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        CH.Text = r1.ToUpper.Substring(0, 2)
                                        CL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        DH.Text = r1.ToUpper.Substring(0, 2)
                                        DL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        SI.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        DI.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        SP.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        BP.Text = r1.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be perfomred")
                    End If
                Else
                    MsgBox("Substraction cannot be perfomred")
                End If
            Else
                MsgBox("Invalid sign opearion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then

            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then

                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            MsgBox(s1)
                            Dim s2 As String = hex_to_bin(u1)
                            MsgBox(s2)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = Hex(r)
                            MsgBox(r1)
                            andflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = r1.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                BH.Text = r1.ToUpper
                                BL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                BL.Text = r1.ToUpper
                                BH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                CH.Text = r1.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = r1.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = r1.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = Hex(r)
                                MsgBox(r1)
                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("substraction cannot be processed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1

                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u3 As String = hex_to_bin(v3)
                                    MsgBox(s1)
                                    Dim u4 As String = hex_to_bin(u1)
                                    MsgBox(s2)
                                    Dim source As String = u4
                                    Dim dest As String = u3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    MsgBox(r)
                                    Dim r1 As String = Hex(r)
                                    MsgBox(r1)
                                    andflagsetting8(r1)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then

                                        AH.Text = r1.ToUpper
                                        AL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        AL.Text = r1.ToUpper
                                        AH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                        BH.Text = r1.ToUpper
                                        BL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                        BL.Text = r1.ToUpper
                                        BH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                        CH.Text = r1.ToUpper
                                        CL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                        CL.Text = r1.ToUpper
                                        CH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                        DH.Text = r1.ToUpper
                                        DL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                        DL.Text = r1.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                       
                    Else
                        MsgBox("Substraction CAnnot be performed")
                    End If
                Else
                    MsgBox("Substraction CAnnot be performed")
                End If

            Else
                MsgBox("Invlaid sign operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varorrltvbase()
        Else
            MsgBox("Invalid register cobination")
        End If
    End Sub
    Sub adcrltvbaseindx()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.ElementAt(4) = "H" Or v1.ToUpper.Trim.ElementAt(4) = "h")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim decs1 As Long = hex_to_dec(s1)
                        MsgBox(decs1)
                        Dim sumdec As Long = adddec1 + decs1
                        MsgBox(sumdec)
                        Dim sumdec3 As String = Hex(sumdec)
                        MsgBox(sumdec3)
                        AddFlagSetting(sumdec3)
                        Dim p1 As String = t16.Text
                        Dim p2 As Long = hex_to_dec(p1)
                        Dim p3 As Long = sumdec + p2
                        Dim sumdec1 As String = Hex(p3)
                        Dim sumdec2 As String = sumdec1 + "H"
                        MsgBox(sumdec2)
                        If TextBox30.Text.ToUpper.Trim = b(0) Then

                            AH.Text = sumdec1.Substring(0, 2)
                            AL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                            BH.Text = sumdec1.Substring(0, 2)
                            BL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                            CH.Text = sumdec1.Substring(0, 2)
                            CL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                            DH.Text = sumdec1.Substring(0, 2)
                            DL.Text = sumdec1.Substring(2, 2)

                        ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                            SI.Text = sumdec2
                        ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                            DI.Text = sumdec2
                        ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                            SP.Text = sumdec2
                        ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                            BP.Text = sumdec2
                        Else
                            MsgBox("Invalid regtr conbination")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim u2 As Long = hex_to_dec(u1)
                            Dim sumdec As Long = u2 + adddec1

                            Dim sumdec3 As String = Hex(sumdec)

                            AddFlagSetting(sumdec3)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = sumdec + p2
                            Dim sumdec1 As String = Hex(p3)
                            Dim sumdec2 As String = sumdec1 + "H"

                            If TextBox30.Text.ToUpper.Trim = b(0) Then

                                AH.Text = sumdec1.Substring(0, 2)
                                AL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                                BH.Text = sumdec1.Substring(0, 2)
                                BL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                                CH.Text = sumdec1.Substring(0, 2)
                                CL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                                DH.Text = sumdec1.Substring(0, 2)
                                DL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                                SI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                                DI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                                SP.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                                BP.Text = sumdec2
                            Else
                                MsgBox("Invalid regtr conbination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Invalid sumstraction")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then

                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim u2 As Long = hex_to_dec(u1)
                            Dim sumdec As Long = u2 + adddec1

                            Dim sumdec3 As String = Hex(sumdec)

                            AddFlagSetting(sumdec3)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = sumdec + p2
                            Dim sumdec1 As String = Hex(p3)
                            Dim sumdec2 As String = sumdec1 + "H"

                            If TextBox30.Text.ToUpper.Trim = b(0) Then

                                AH.Text = sumdec1.Substring(0, 2)
                                AL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                                BH.Text = sumdec1.Substring(0, 2)
                                BL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                                CH.Text = sumdec1.Substring(0, 2)
                                CL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                                DH.Text = sumdec1.Substring(0, 2)
                                DL.Text = sumdec1.Substring(2, 2)

                            ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                                SI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                                DI.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                                SP.Text = sumdec2
                            ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                                BP.Text = sumdec2
                            Else
                                MsgBox("Invalid regtr conbination")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("sub cannot be performed")
                End If

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1

                                Dim u1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim sumdec As Long = u2 + adddec1
                                MsgBox(sumdec)
                                Dim sumdec3 As String = Hex(sumdec)
                                MsgBox(sumdec3)
                                AddFlagSetting(sumdec3)
                                Dim p1 As String = t16.Text
                                Dim p2 As Long = hex_to_dec(p1)
                                Dim p3 As Long = sumdec + p2
                                Dim sumdec1 As String = Hex(p3)
                                Dim sumdec2 As String = sumdec1 + "H"
                                If TextBox30.Text.ToUpper.Trim = b(0) Then

                                    AH.Text = sumdec1.Substring(0, 2)
                                    AL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(1) Then

                                    BH.Text = sumdec1.Substring(0, 2)
                                    BL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(2) Then

                                    CH.Text = sumdec1.Substring(0, 2)
                                    CL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(3) Then

                                    DH.Text = sumdec1.Substring(0, 2)
                                    DL.Text = sumdec1.Substring(2, 2)

                                ElseIf TextBox30.Text.ToUpper.Trim = b(4) Then
                                    SI.Text = sumdec2
                                ElseIf TextBox30.Text.ToUpper.Trim = b(5) Then
                                    DI.Text = sumdec2
                                ElseIf TextBox30.Text.ToUpper.Trim = b(6) Then
                                    SP.Text = sumdec2
                                ElseIf TextBox30.Text.ToUpper.Trim = b(7) Then
                                    BP.Text = sumdec2
                                Else
                                    MsgBox("Invalid regtr conbination")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("substraction cannot be performed")
                    End If
                Else
                    MsgBox("substraction cannot be performed")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(4) = "H" Or v1.ToUpper.Trim.ElementAt(4) = "h")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            MsgBox(v3)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            MsgBox(v5)
            Dim v6 As String = v2.ToUpper
            MsgBox(v6)
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim sumadd As Long = adddec2 + adddec3 + adddec4

                Dim sumadd1 As String = Hex(sumadd)

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            Dim decs1 As Long = hex_to_dec(s1)
                            MsgBox(decs1)
                            Dim sumdec As Long = adddec1 + decs1
                            MsgBox(sumdec)
                            Dim sumdec3 As String = Hex(sumdec)
                            MsgBox(sumdec3)
                            addflagsetting8(sumdec3)
                            Dim p1 As String = t16.Text
                            Dim p2 As Long = hex_to_dec(p1)
                            Dim p3 As Long = sumdec + p2
                            Dim sumdec1 As String = Hex(p3)
                            Dim sumdec2 As String = sumdec1 + "H"
                            MsgBox(sumdec2)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = sumdec2.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                AL.Text = sumdec2.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                BH.Text = sumdec2.ToUpper
                                BL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                BL.Text = sumdec2.ToUpper
                                BH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                CH.Text = sumdec2.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = sumdec2.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = sumdec2.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = sumdec2.ToUpper
                                DH.Text = "00"

                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
              
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim sumdec As Long = u2 + adddec1

                                Dim sumdec3 As String = Hex(sumdec)

                                addflagsetting8(sumdec3)
                                Dim p1 As String = t16.Text
                                Dim p2 As Long = hex_to_dec(p1)
                                Dim p3 As Long = sumdec + p2
                                Dim sumdec1 As String = Hex(p3)
                                Dim sumdec2 As String = sumdec1 + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = sumdec2.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = sumdec2.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = sumdec2.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = sumdec2.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = sumdec2.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = sumdec2.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = sumdec2.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = sumdec2.ToUpper
                                    DH.Text = "00"

                                Else
                                    MsgBox("Invalid reg combination")
                                End If

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Invalid substraction caoot be performed")
                End If

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim sumdec As Long = u2 + adddec1

                                Dim sumdec3 As String = Hex(sumdec)

                                addflagsetting8(sumdec3)
                                Dim p1 As String = t16.Text
                                Dim p2 As Long = hex_to_dec(p1)
                                Dim p3 As Long = sumdec + p2
                                Dim sumdec1 As String = Hex(p3)
                                Dim sumdec2 As String = sumdec1 + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = sumdec2.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                    AL.Text = sumdec2.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = sumdec2.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = sumdec2.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = sumdec2.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = sumdec2.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = sumdec2.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = sumdec2.ToUpper
                                    DH.Text = "00"

                                Else
                                    MsgBox("Invalid reg combination")
                                End If

                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Invalid substraction cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1

                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u2 As Long = hex_to_dec(u1)
                                    Dim sumdec As Long = u2 + adddec1

                                    Dim sumdec3 As String = Hex(sumdec)

                                    addflagsetting8(sumdec3)
                                    Dim p1 As String = t16.Text
                                    Dim p2 As Long = hex_to_dec(p1)
                                    Dim p3 As Long = sumdec + p2
                                    Dim sumdec1 As String = Hex(p3)
                                    Dim sumdec2 As String = sumdec1 + "H"

                                    If TextBox30.Text.Trim.ToUpper = c(0) Then

                                        AH.Text = sumdec2.ToUpper
                                        AL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then

                                        AL.Text = sumdec2.ToUpper
                                        AH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                        BH.Text = sumdec2.ToUpper
                                        BL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                        BL.Text = sumdec2.ToUpper
                                        BH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                        CH.Text = sumdec2.ToUpper
                                        CL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                        CL.Text = sumdec2.ToUpper
                                        CH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                        DH.Text = sumdec2.ToUpper
                                        DL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                        DL.Text = sumdec2.ToUpper
                                        DH.Text = "00"

                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Invalid substractionn cannot be performed")
                    End If
                Else
                    MsgBox("Invalid substractio cannot be performed")
                End If

            Else
                MsgBox("Invalid sign operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            varaddrltvbaseMode()
        Else
            MsgBox("INvalid rltv based index mode add mode")
        End If
    End Sub
    Sub xchgrltvbaseindexMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v8 As String = v2.ToUpper.Substring(7, 4)

            Dim v5 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v8.Length - 1

                    If f1.Contains(v8.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v7.Length And count3 = v8.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v8)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2

                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {sumh2, v3})
                            TextBox32.Text = values1
                           
                            Dim k1 As String = TextBox32.Text

                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If k1.Length = 4 Then
                                    AH.Text = k1.ToUpper.Substring(0, 2)
                                    AL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    AH.Text = k3.ToUpper.Substring(0, 2)
                                    AL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If k1.Length = 4 Then
                                    BH.Text = k1.ToUpper.Substring(0, 2)
                                    BL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    BH.Text = k3.ToUpper.Substring(0, 2)
                                    BL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If k1.Length = 4 Then
                                    CH.Text = k1.ToUpper.Substring(0, 2)
                                    CL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    CH.Text = k3.ToUpper.Substring(0, 2)
                                    CL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If k1.Length = 4 Then
                                    DH.Text = k1.ToUpper.Substring(0, 2)
                                    DL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    DH.Text = k3.ToUpper.Substring(0, 2)
                                    DL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If k1.Length = 4 Then
                                    SI.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    SI.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If k1.Length = 4 Then
                                    DI.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    DI.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If k1.Length = 4 Then
                                    SP.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    SP.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If k1.Length = 4 Then
                                    BP.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    BP.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            Else
                                MsgBox("Invalid combination of register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be proceed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v8.Length - 1

                    If f1.Contains(v8.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v8.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v8)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s3
                MsgBox(sum1)
                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {sumh2, v3})
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text

                            MsgBox(k1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If k1.Length = 4 Then
                                    AH.Text = k1.ToUpper.Substring(0, 2)
                                    AL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    AH.Text = k3.ToUpper.Substring(0, 2)
                                    AL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If k1.Length = 4 Then
                                    BH.Text = k1.ToUpper.Substring(0, 2)
                                    BL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    BH.Text = k3.ToUpper.Substring(0, 2)
                                    BL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If k1.Length = 4 Then
                                    CH.Text = k1.ToUpper.Substring(0, 2)
                                    CL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    CH.Text = k3.ToUpper.Substring(0, 2)
                                    CL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If k1.Length = 4 Then
                                    DH.Text = k1.ToUpper.Substring(0, 2)
                                    DL.Text = k1.ToUpper.Substring(2, 2)
                                ElseIf k1.Length = 2 Then
                                    Dim k3 As String = "00" + k1
                                    DH.Text = k3.ToUpper.Substring(0, 2)
                                    DL.Text = k3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                If k1.Length = 4 Then
                                    SI.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    SI.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                If k1.Length = 4 Then
                                    DI.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    DI.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                If k1.Length = 4 Then
                                    SP.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    SP.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                If k1.Length = 4 Then
                                    BP.Text = k1.ToUpper
                                ElseIf k1.Length = 3 Then
                                    Dim k3 As String = "00" + k1
                                    BP.Text = k3.ToUpper
                                Else
                                    MsgBox("Invalid reuslt")
                                End If
                            Else
                                MsgBox("Invalid combination of register")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v8.Length - 1

                    If f1.Contains(v8.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v8.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + 3

                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sum1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        DataGridView1.Rows.Add(New String() {sumh2, v3})
                        TextBox32.Text = values1
                        
                        Dim k1 As String = TextBox32.Text

                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            If k1.Length = 4 Then
                                AH.Text = k1.ToUpper.Substring(0, 2)
                                AL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                AH.Text = k3.ToUpper.Substring(0, 2)
                                AL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            If k1.Length = 4 Then
                                BH.Text = k1.ToUpper.Substring(0, 2)
                                BL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                BH.Text = k3.ToUpper.Substring(0, 2)
                                BL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            If k1.Length = 4 Then
                                CH.Text = k1.ToUpper.Substring(0, 2)
                                CL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                CH.Text = k3.ToUpper.Substring(0, 2)
                                CL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            If k1.Length = 4 Then
                                DH.Text = k1.ToUpper.Substring(0, 2)
                                DL.Text = k1.ToUpper.Substring(2, 2)
                            ElseIf k1.Length = 2 Then
                                Dim k3 As String = "00" + k1
                                DH.Text = k3.ToUpper.Substring(0, 2)
                                DL.Text = k3.ToUpper.Substring(2, 2)
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            If k1.Length = 4 Then
                                SI.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                SI.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            If k1.Length = 4 Then
                                DI.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                DI.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            If k1.Length = 4 Then
                                SP.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                SP.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            If k1.Length = 4 Then
                                BP.Text = k1.ToUpper
                            ElseIf k1.Length = 3 Then
                                Dim k3 As String = "00" + k1
                                BP.Text = k3.ToUpper
                            Else
                                MsgBox("Invalid reuslt")
                            End If
                        Else
                            MsgBox("Invalid combination of register")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v8.Length - 1

                    If f1.Contains(v8.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v8.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2

                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                DataGridView1.Rows.Add(New String() {sumh2, v3})
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text

                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If k1.Length = 4 Then
                                        AH.Text = k1.ToUpper.Substring(0, 2)
                                        AL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k3 As String = "00" + k1
                                        AH.Text = k3.ToUpper.Substring(0, 2)
                                        AL.Text = k3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If k1.Length = 4 Then
                                        BH.Text = k1.ToUpper.Substring(0, 2)
                                        BL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k3 As String = "00" + k1
                                        BH.Text = k3.ToUpper.Substring(0, 2)
                                        BL.Text = k3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If k1.Length = 4 Then
                                        CH.Text = k1.ToUpper.Substring(0, 2)
                                        CL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k3 As String = "00" + k1
                                        CH.Text = k3.ToUpper.Substring(0, 2)
                                        CL.Text = k3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If k1.Length = 4 Then
                                        DH.Text = k1.ToUpper.Substring(0, 2)
                                        DL.Text = k1.ToUpper.Substring(2, 2)
                                    ElseIf k1.Length = 2 Then
                                        Dim k3 As String = "00" + k1
                                        DH.Text = k3.ToUpper.Substring(0, 2)
                                        DL.Text = k3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    If k1.Length = 4 Then
                                        SI.Text = k1.ToUpper
                                    ElseIf k1.Length = 3 Then
                                        Dim k3 As String = "00" + k1
                                        SI.Text = k3.ToUpper
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    If k1.Length = 4 Then
                                        DI.Text = k1.ToUpper
                                    ElseIf k1.Length = 3 Then
                                        Dim k3 As String = "00" + k1
                                        DI.Text = k3.ToUpper
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    If k1.Length = 4 Then
                                        SP.Text = k1.ToUpper
                                    ElseIf k1.Length = 3 Then
                                        Dim k3 As String = "00" + k1
                                        SP.Text = k3.ToUpper
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    If k1.Length = 4 Then
                                        BP.Text = k1.ToUpper
                                    ElseIf k1.Length = 3 Then
                                        Dim k3 As String = "00" + k1
                                        BP.Text = k3.ToUpper
                                    Else
                                        MsgBox("Invalid reuslt")
                                    End If
                                Else
                                    MsgBox("Invalid combination of register")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction cannot be done")
                    End If

                Else
                    MsgBox("Substraction cannot be done")
                End If
            Else
                MsgBox("Invalid sign Opearion")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = v2.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2

                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    MsgBox(sum2)
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {sumh2, v3})
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim sumh4 As String = k1 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = sumh4.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = sumh4.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = sumh4.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = sumh4.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = sumh4.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = sumh4.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = sumh4.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = sumh4.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Inavlid enterd value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be process")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s3

                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {sumh2, v3})
                            TextBox32.Text = values1
                           
                            Dim k1 As String = TextBox32.Text

                            If k1.Length = 2 Then
                                Dim sumh4 As String = k1 + "H"
                                MsgBox(sumh4)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = sumh4.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = sumh4.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = sumh4.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = sumh4.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = sumh4.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = sumh4.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = sumh4.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = sumh4.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid enterd value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be process")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + 3

                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sum1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        DataGridView1.Rows.Add(New String() {sumh2, v3})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        MsgBox(k1)
                        If k1.Length = 2 Then
                            Dim sumh4 As String = k1 + "H"
                            MsgBox(sumh4)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = sumh4.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = sumh4.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = sumh4.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = sumh4.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = sumh4.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = sumh4.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = sumh4.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = sumh4.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid enterd value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2

                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                DataGridView1.Rows.Add(New String() {sumh2, v3})
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    Dim sumh4 As String = k1 + "H"

                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        AH.Text = sumh4.ToUpper
                                        AL.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        AL.Text = sumh4.ToUpper
                                        AH.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        BH.Text = sumh4.ToUpper
                                        BL.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        BL.Text = sumh4.ToUpper
                                        BH.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        CH.Text = sumh4.ToUpper
                                        CL.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        CL.Text = sumh4.ToUpper
                                        CH.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        DH.Text = sumh4.ToUpper
                                        DL.Text = "00"
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        DL.Text = sumh4.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid enterd value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction Cannot be done")
                    End If
                Else
                    MsgBox("Substraction Cannot be done")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination in exchange Operation")
        End If
    End Sub
    Sub testrltvbase()

        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox((c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H")))
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        If u1.Length = 4 Then
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                andflagsetting(r1)
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction cannot be prossed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                MsgBox(adddec4)
                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s3 As String = hex_to_bin(v3)
                                MsgBox(s3)
                                Dim s4 As String = hex_to_bin(u1)
                                MsgBox(s2)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 4 Then
                                    Dim s3 As String = hex_to_bin(v3)
                                    Dim s4 As String = hex_to_bin(u1)
                                    Dim source As String = s4
                                    Dim dest As String = s3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = hexa(r)
                                    andflagsetting(r1)
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction cannot be perfomred")
                    End If
                Else
                    MsgBox("Substraction cannot be perfomred")
                End If
            Else
                MsgBox("Invalid sign opearion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            MsgBox("ia")
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = Hex(r)
                            andflagsetting8(r1)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                MsgBox(s1)
                                Dim u4 As String = hex_to_bin(u1)
                                MsgBox(s2)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("substraction cannot be processed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1

                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u3 As String = hex_to_bin(v3)
                                    Dim u4 As String = hex_to_bin(u1)
                                    Dim source As String = u4
                                    Dim dest As String = u3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = Hex(r)
                                    andflagsetting8(r1)

                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                       
                    Else
                        MsgBox("Substraction CAnnot be performed")
                    End If
                Else
                    MsgBox("Substraction CAnnot be performed")
                End If

            Else
                MsgBox("Invlaid sign operation")
            End If

        Else
            MsgBox("Invalid register cobination")
        End If
    End Sub
    Sub sbbrltvbaseindx()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = v2.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s2
                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim subhex2 As String = Hex(sum3)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                subflagsetting(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = sum3 - p1
                                Dim sumh3 As String = Hex(p2)
                                Dim sumh4 As String = sumh3 + "H"

                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length = 4 Then
                                        AH.Text = sumh3.ToUpper.Substring(0, 2)
                                        AL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length = 4 Then
                                        BH.Text = sumh3.ToUpper.Substring(0, 2)
                                        BL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length = 4 Then
                                        CH.Text = sumh3.ToUpper.Substring(0, 2)
                                        CL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length = 4 Then
                                        DH.Text = sumh3.ToUpper.Substring(0, 2)
                                        DL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh4.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            ElseIf k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim subhex2 As String = Hex(sum3)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                subflagsetting64(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = sum3 - p1
                                Dim sumh3 As String = Hex(p2)
                                Dim sumh4 As String = sumh3 + "H"

                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length >= 4 Then
                                        AH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length >= 4 Then
                                        BH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length >= 4 Then
                                        CH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length >= 4 Then
                                        DH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh3.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Final sub cannot be performed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s3
                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim subhex2 As String = Hex(sum3)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                subflagsetting(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = sum3 - p1
                                Dim sumh3 As String = Hex(p2)
                                Dim sumh4 As String = sumh3 + "H"
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length = 4 Then
                                        AH.Text = sumh3.ToUpper.Substring(0, 2)
                                        AL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length = 4 Then
                                        BH.Text = sumh3.ToUpper.Substring(0, 2)
                                        BL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length = 4 Then
                                        CH.Text = sumh3.ToUpper.Substring(0, 2)
                                        CL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length = 4 Then
                                        DH.Text = sumh3.ToUpper.Substring(0, 2)
                                        DL.Text = sumh3.ToUpper.Substring(2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh4.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh4.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            ElseIf k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim subhex2 As String = Hex(sum3)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                subflagsetting64(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = sum3 - p1
                                Dim sumh3 As String = Hex(p2)
                                Dim sumh4 As String = sumh3 + "H"

                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    If sumh3.Length >= 4 Then
                                        AH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    If sumh3.Length >= 4 Then
                                        BH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    If sumh3.Length >= 4 Then
                                        CH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If

                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    If sumh3.Length >= 4 Then
                                        DH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                        DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                    Else
                                        MsgBox("Invalid number value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = sumh3.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = sumh3.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Final sub cannot be performed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be possible")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s2 + 3
                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim k1 As String = TextBox32.Text
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        If k2 > k3 Then
                            Dim sum3 As Long = k2 - k3
                            Dim subhex2 As String = Hex(sum3)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            subflagsetting(subhex2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = sum3 - p1
                            Dim sumh3 As String = Hex(p2)
                            Dim sumh4 As String = sumh3 + "H"
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If sumh3.Length = 4 Then
                                    AH.Text = sumh3.ToUpper.Substring(0, 2)
                                    AL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If sumh3.Length = 4 Then
                                    BH.Text = sumh3.ToUpper.Substring(0, 2)
                                    BL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If sumh3.Length = 4 Then
                                    CH.Text = sumh3.ToUpper.Substring(0, 2)
                                    CL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If sumh3.Length = 4 Then
                                    DH.Text = sumh3.ToUpper.Substring(0, 2)
                                    DL.Text = sumh3.ToUpper.Substring(2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = sumh4.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = sumh4.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = sumh4.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = sumh4.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        ElseIf k2 <= k3 Then
                            Dim sum3 As Long = k2 - k3
                            Dim subhex2 As String = Hex(sum3)
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            subflagsetting(subhex2)
                            Dim p As String = t16.Text
                            Dim p1 As Long = hex_to_dec(p)
                            Dim p2 As Long = sum3 - p1
                            Dim sumh3 As String = Hex(p2)
                            Dim sumh4 As String = sumh3 + "H"

                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                If sumh3.Length >= 4 Then
                                    AH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                    AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                If sumh3.Length >= 4 Then
                                    BH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                    BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                If sumh3.Length >= 4 Then
                                    CH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                    CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If

                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                If sumh3.Length >= 4 Then
                                    DH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                    DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                Else
                                    MsgBox("Invalid number value")
                                End If
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = sumh3.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = sumh3.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = sumh3.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = sumh3.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Final sub cannot be performed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2
                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3
                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim subhex2 As String = Hex(sum3)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow()
                                    subflagsetting(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = sum3 - p1
                                    Dim sumh3 As String = Hex(p2)
                                    Dim sumh4 As String = sumh3 + "H"
                                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                                        If sumh3.Length = 4 Then
                                            AH.Text = sumh3.ToUpper.Substring(0, 2)
                                            AL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                        If sumh3.Length = 4 Then
                                            BH.Text = sumh3.ToUpper.Substring(0, 2)
                                            BL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                        If sumh3.Length = 4 Then
                                            CH.Text = sumh3.ToUpper.Substring(0, 2)
                                            CL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If

                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                        If sumh3.Length = 4 Then
                                            DH.Text = sumh3.ToUpper.Substring(0, 2)
                                            DL.Text = sumh3.ToUpper.Substring(2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                        SI.Text = sumh4.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                        DI.Text = sumh4.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                        SP.Text = sumh4.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                        BP.Text = sumh4.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                ElseIf k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim subhex2 As String = Hex(sum3)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow()
                                    subflagsetting(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = sum3 - p1
                                    Dim sumh3 As String = Hex(p2)
                                    Dim sumh4 As String = sumh3 + "H"

                                    If TextBox30.Text.Trim.ToUpper = b(0) Then
                                        If sumh3.Length >= 4 Then
                                            AH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                            AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                        If sumh3.Length >= 4 Then
                                            BH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                            BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                        If sumh3.Length >= 4 Then
                                            CH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                            CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If

                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                        If sumh3.Length >= 4 Then
                                            DH.Text = sumh3.Substring(sumh3.Length - 4, 2)
                                            DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        Else
                                            MsgBox("Invalid number value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                        SI.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                        DI.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                        SP.Text = sumh3.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                        BP.Text = sumh3.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                       
                    Else
                        MsgBox("Substraction Cannot be Possible")
                    End If
                Else
                    MsgBox("Substraction Cannot be Possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = v2.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s2
                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim subhex2 As String = Hex(sum3)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    subflagsetting8(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = sum3 - p1
                                    Dim sumh3 As String = Hex(p2)
                                    Dim sumh4 As String = sumh3 + "H"
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh3.Length = 2 Then
                                            AH.Text = sumh4.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh3.Length = 2 Then
                                            AL.Text = sumh4.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh3.Length = 2 Then
                                            BH.Text = sumh4.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh3.Length = 2 Then
                                            BL.Text = sumh4.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh3.Length = 2 Then
                                            CH.Text = sumh4.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh3.Length = 2 Then
                                            CL.Text = sumh4.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh3.Length = 2 Then
                                            DH.Text = sumh4.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh3.Length = 2 Then
                                            DL.Text = sumh4.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                ElseIf k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim subhex2 As String = Hex(sum3)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    subflagsetting16(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = sum3 - p1
                                    Dim sumh3 As String = Hex(p2)
                                    Dim sumh4 As String = sumh3 + "H"
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh4.Length >= 3 Then
                                            AH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            AL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh4.Length >= 3 Then
                                            AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            AH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh4.Length >= 3 Then
                                            BH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh4.Length >= 3 Then
                                            BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            BH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh4.Length >= 3 Then
                                            CH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            CL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh4.Length >= 3 Then
                                            CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            CH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh4.Length >= 3 Then
                                            DH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            DL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh4.Length >= 3 Then
                                            DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            DH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If
                            Else
                                MsgBox("Invalid enterd value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be Possible")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                Dim sum1 As Long = s1 + s3
                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text

                            If k1.Length = 2 Then
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim subhex2 As String = Hex(sum3)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    subflagsetting8(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = sum3 - p1
                                    Dim sumh3 As String = Hex(p2)
                                    Dim sumh4 As String = sumh3 + "H"

                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh3.Length = 2 Then
                                            AH.Text = sumh4.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh3.Length = 2 Then
                                            AL.Text = sumh4.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh3.Length = 2 Then
                                            BH.Text = sumh4.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh3.Length = 2 Then
                                            BL.Text = sumh4.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh3.Length = 2 Then
                                            CH.Text = sumh4.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh3.Length = 2 Then
                                            CL.Text = sumh4.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh3.Length = 2 Then
                                            DH.Text = sumh4.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh3.Length = 2 Then
                                            DL.Text = sumh4.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid enterd hexa value")
                                        End If
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                ElseIf k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3
                                    Dim subhex2 As String = Hex(sum3)
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    subflagsetting16(subhex2)
                                    Dim p As String = t16.Text
                                    Dim p1 As Long = hex_to_dec(p)
                                    Dim p2 As Long = sum3 - p1
                                    Dim sumh3 As String = Hex(p2)
                                    Dim sumh4 As String = sumh3 + "H"
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then
                                        If sumh4.Length >= 3 Then
                                            AH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            AL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            AH.Text = sb.ToUpper
                                            AL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        If sumh4.Length >= 3 Then
                                            AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            AH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            AL.Text = sb.ToUpper
                                            AH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                        If sumh4.Length >= 3 Then
                                            BH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            BL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            BH.Text = sb.ToUpper
                                            BL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                        If sumh4.Length >= 3 Then
                                            BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            BH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            BL.Text = sb.ToUpper
                                            BH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                        If sumh4.Length >= 3 Then
                                            CH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            CL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            CH.Text = sb.ToUpper
                                            CL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                        If sumh4.Length >= 3 Then
                                            CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            CH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            CL.Text = sb.ToUpper
                                            CH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                        If sumh4.Length >= 3 Then
                                            DH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            DL.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            DH.Text = sb.ToUpper
                                            DL.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                        If sumh4.Length >= 3 Then
                                            DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                            DH.Text = "00"
                                        ElseIf sumh4.Length = 2 Then
                                            Dim sb As String = "0" + sumh3.ToUpper
                                            DL.Text = sb.ToUpper
                                            DH.Text = "00"
                                        Else
                                            MsgBox("Invalid result")
                                        End If
                                    Else
                                        MsgBox("Invalid Combination")
                                    End If
                                Else
                                    MsgBox("Final sub cannot be performed")
                                End If
                            Else
                                MsgBox("Enter value is not an 8 bit value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + 3

                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text
                        If k1.Length = 2 Then
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            If k2 > k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim subhex2 As String = Hex(sum3)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                subflagsetting8(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = sum3 - p1
                                Dim sumh3 As String = Hex(p2)
                                Dim sumh4 As String = sumh3 + "H"

                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh3.Length = 2 Then
                                        AH.Text = sumh4.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh3.Length = 2 Then
                                        AL.Text = sumh4.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh3.Length = 2 Then
                                        BH.Text = sumh4.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh3.Length = 2 Then
                                        BL.Text = sumh4.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh3.Length = 2 Then
                                        CH.Text = sumh4.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh3.Length = 2 Then
                                        CL.Text = sumh4.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh3.Length = 2 Then
                                        DH.Text = sumh4.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh3.Length = 2 Then
                                        DL.Text = sumh4.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid enterd hexa value")
                                    End If
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            ElseIf k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3
                                Dim subhex2 As String = Hex(sum3)
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                subflagsetting16(subhex2)
                                Dim p As String = t16.Text
                                Dim p1 As Long = hex_to_dec(p)
                                Dim p2 As Long = sum3 - p1
                                Dim sumh3 As String = Hex(p2)
                                Dim sumh4 As String = sumh3 + "H"
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    If sumh4.Length >= 3 Then
                                        AH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        AL.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        AH.Text = sb.ToUpper
                                        AL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    If sumh4.Length >= 3 Then
                                        AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        AH.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        AL.Text = sb.ToUpper
                                        AH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    If sumh4.Length >= 3 Then
                                        BH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        BL.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        BH.Text = sb.ToUpper
                                        BL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    If sumh4.Length >= 3 Then
                                        BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        BH.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        BL.Text = sb.ToUpper
                                        BH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    If sumh4.Length >= 3 Then
                                        CH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        CL.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        CH.Text = sb.ToUpper
                                        CL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    If sumh4.Length >= 3 Then
                                        CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        CH.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        CL.Text = sb.ToUpper
                                        CH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    If sumh4.Length >= 3 Then
                                        DH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        DL.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        DH.Text = sb.ToUpper
                                        DL.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    If sumh4.Length >= 3 Then
                                        DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                        DH.Text = "00"
                                    ElseIf sumh4.Length = 2 Then
                                        Dim sb As String = "0" + sumh3.ToUpper
                                        DL.Text = sb.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid result")
                                    End If
                                Else
                                    MsgBox("Invalid Combination")
                                End If
                            Else
                                MsgBox("Final sub cannot be performed")
                            End If
                        Else
                            MsgBox("Enter value is not an 8 bit value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)
                Dim s2 As Long = hex_to_dec(v5)
                Dim s3 As Long = hex_to_dec(v7)
                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2
                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3
                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    Dim k2 As Long = hex_to_dec(v3)
                                    Dim k3 As Long = hex_to_dec(k1)
                                    If k2 > k3 Then
                                        Dim sum3 As Long = k2 - k3
                                        Dim subhex2 As String = Hex(sum3)
                                        binOp1 = hex_to_bin(v3)
                                        binOp2 = hex_to_bin(k1)
                                        subcar()
                                        binOp1 = hex_to_bin(v3)
                                        binOp2 = hex_to_bin(k1)
                                        t5.Text = OverFlow8()
                                        subflagsetting8(subhex2)
                                        Dim p As String = t16.Text
                                        Dim p1 As Long = hex_to_dec(p)
                                        Dim p2 As Long = sum3 - p1
                                        Dim sumh3 As String = Hex(p2)
                                        Dim sumh4 As String = sumh3 + "H"

                                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                                            If sumh3.Length = 2 Then
                                                AH.Text = sumh4.ToUpper
                                                AL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                            If sumh3.Length = 2 Then
                                                AL.Text = sumh4.ToUpper
                                                AH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                            If sumh3.Length = 2 Then
                                                BH.Text = sumh4.ToUpper
                                                BL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                            If sumh3.Length = 2 Then
                                                BL.Text = sumh4.ToUpper
                                                BH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                            If sumh3.Length = 2 Then
                                                CH.Text = sumh4.ToUpper
                                                CL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                            If sumh3.Length = 2 Then
                                                CL.Text = sumh4.ToUpper
                                                CH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                            If sumh3.Length = 2 Then
                                                DH.Text = sumh4.ToUpper
                                                DL.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                            If sumh3.Length = 2 Then
                                                DL.Text = sumh4.ToUpper
                                                DH.Text = "00"
                                            Else
                                                MsgBox("Invalid enterd hexa value")
                                            End If
                                        Else
                                            MsgBox("Invalid reg combination")
                                        End If
                                    ElseIf k2 <= k3 Then
                                        Dim sum3 As Long = k2 - k3
                                        Dim subhex2 As String = Hex(sum3)
                                        binOp1 = hex_to_bin(v3)
                                        binOp2 = hex_to_bin(k1)
                                        subcar()
                                        binOp1 = hex_to_bin(v3)
                                        binOp2 = hex_to_bin(k1)
                                        t5.Text = OverFlow8()
                                        subflagsetting16(subhex2)
                                        Dim p As String = t16.Text
                                        Dim p1 As Long = hex_to_dec(p)
                                        Dim p2 As Long = sum3 - p1
                                        Dim sumh3 As String = Hex(p2)
                                        Dim sumh4 As String = sumh3 + "H"
                                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                                            If sumh4.Length >= 3 Then
                                                AH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                AL.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                AH.Text = sb.ToUpper
                                                AL.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                            If sumh4.Length >= 3 Then
                                                AL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                AH.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                AL.Text = sb.ToUpper
                                                AH.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                            If sumh4.Length >= 3 Then
                                                BH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                BL.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                BH.Text = sb.ToUpper
                                                BL.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                            If sumh4.Length >= 3 Then
                                                BL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                BH.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                BL.Text = sb.ToUpper
                                                BH.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                            If sumh4.Length >= 3 Then
                                                CH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                CL.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                CH.Text = sb.ToUpper
                                                CL.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                            If sumh4.Length >= 3 Then
                                                CL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                CH.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                CL.Text = sb.ToUpper
                                                CH.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                            If sumh4.Length >= 3 Then
                                                DH.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                DL.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                DH.Text = sb.ToUpper
                                                DL.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                            If sumh4.Length >= 3 Then
                                                DL.Text = sumh3.Substring(sumh3.Length - 2, 2)
                                                DH.Text = "00"
                                            ElseIf sumh4.Length = 2 Then
                                                Dim sb As String = "0" + sumh3.ToUpper
                                                DL.Text = sb.ToUpper
                                                DH.Text = "00"
                                            Else
                                                MsgBox("Invalid result")
                                            End If
                                        Else
                                            MsgBox("Invalid Combination")
                                        End If
                                    Else
                                        MsgBox("Final sub cannot be performed")
                                    End If
                                Else
                                    MsgBox("Invalid, ented value outof range")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                       
                    Else
                        MsgBox("Substraction cannot be Possible")
                    End If
                Else
                    MsgBox("Substraction cannot be Possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If

        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub cmpbaserltv()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox(v2)
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = v2.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2

                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    MsgBox(sum2)
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    MsgBox(sumh2)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {sumh2, values1})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)
                            Dim k3 As Long = hex_to_dec(k1)
                            MsgBox(k3)
                            cmpflagsetting(k2, k3)
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s3
                MsgBox(sum1)
                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2

                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            DataGridView1.Rows.Add(New String() {sumh2, values1})
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)
                            MsgBox(k2)
                            Dim k3 As Long = hex_to_dec(k1)
                            MsgBox(k3)
                            cmpflagsetting(k2, k3)
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Substraction Cannot be possible")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + 3

                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        DataGridView1.Rows.Add(New String() {sumh2, values1})
                        TextBox32.Text = values1
                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim k1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        Dim k2 As Long = hex_to_dec(v3)
                        Dim k3 As Long = hex_to_dec(k1)
                        cmpflagsetting(k2, k3)
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2
                    MsgBox(sum1)
                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3
                        MsgBox(sum2)
                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"
                        MsgBox(sumh2)
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                DataGridView1.Rows.Add(New String() {sumh2, values1})
                                TextBox32.Text = values1
                                TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                                Dim k1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim k2 As Long = hex_to_dec(v3)
                                Dim k3 As Long = hex_to_dec(k1)
                                cmpflagsetting(k2, k3)
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction Cannot be Possible")
                    End If
                Else
                    MsgBox("Substraction Cannot be Possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 3) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = v2.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2

                If sum1 > s3 Then
                    Dim sum2 As Long = sum1 - s3
                    MsgBox(sum2)
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"
                    MsgBox(sumh2)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {sumh2, values1})
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()

                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                cmpflagsetting(k2, k3)
                            Else
                                MsgBox("Invalid enterd value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be Possible")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s3

                If sum1 > s2 Then
                    Dim sum2 As Long = sum1 - s2
                    MsgBox(sum2)
                    Dim sumh1 As String = Hex(sum2)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            DataGridView1.Rows.Add(New String() {sumh2, values1})
                            TextBox32.Text = values1

                            Dim k1 As String = TextBox32.Text
                            MsgBox(k1)
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                cmpflagsetting(k2, k3)
                            Else
                                MsgBox("Enter value is not an 8 bit value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                Dim sum1 As Long = s1 + s2 + 3

                Dim sumh1 As String = Hex(sum1)
                Dim sumh2 As String = sumh1 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumh1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim values1 As String = InputBox("enter the value for" + sumh2)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        DataGridView1.Rows.Add(New String() {sumh2, values1})
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text

                        If k1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            cmpflagsetting(k2, k3)
                        Else
                            MsgBox("Enter value is not an 8 bit value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim s1 As Long = hex_to_dec(v4)

                Dim s2 As Long = hex_to_dec(v5)

                Dim s3 As Long = hex_to_dec(v7)

                If s1 > s2 Then
                    Dim sum1 As Long = s1 - s2

                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                DataGridView1.Rows.Add(New String() {sumh2, values1})
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                MsgBox(k1)
                                If k1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim k2 As Long = hex_to_dec(v3)

                                    Dim k3 As Long = hex_to_dec(k1)

                                    cmpflagsetting(k2, k3)
                                Else
                                    MsgBox("Invalid, ented value outof range")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction cannot be Possible")
                    End If
                Else
                    MsgBox("Substraction cannot be Possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varmulregstrMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text
        If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)
            AH.Text = InputBox("Enter the value for AH accumalator")
            AL.Text = InputBox("Enter the value for AL accumalator")
            If AH.Text.Length = 2 And AL.Text.Length = 2 Then
                Dim n1 As String = AH.Text.ToUpper
                Dim n2 As String = AL.Text.ToUpper
                Dim sumn As String = n1 + n2
                MsgBox(sumn)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(sumn)
                t5.Text = OverFlow()
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To sumn.Length - 1

                    If f1.Contains(sumn.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next

                If count = v2.Length And count1 = sumn.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = hex_to_dec(sumn)
                Dim decsum As Long = dec1 * dec2
                Dim dechex As String = Hex(decsum)
                mulflagsetting16(dechex)
                Dim dechex1 As String = dechex + "H"
                MsgBox(dechex1)
                If dechex.Length = 8 Then
                    AH.Text = dechex.Substring(0, 2)
                    AL.Text = dechex.Substring(2, 2)
                    DH.Text = dechex.Substring(4, 2)
                    DL.Text = dechex.Substring(6, 2)
                ElseIf dechex.Length = 7 Then
                    Dim dechexa As String = "0" + dechex
                    AH.Text = dechexa.Substring(0, 2)
                    AL.Text = dechexa.Substring(2, 2)
                    DH.Text = dechexa.Substring(4, 2)
                    DL.Text = dechexa.Substring(6, 2)
                Else
                    MsgBox("Invalid value for result")
                End If
            Else
                MsgBox("Invalid value for accumalator")
            End If
        ElseIf v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)
            AL.Text = InputBox("Enter the value for AL accumalator ")
            If AL.Text.Length = 2 Then
                Dim n1 As String = AL.Text
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(n1)
                t5.Text = OverFlow8()
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To n1.Length - 1
                    If f1.Contains(n1.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = n1.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = hex_to_dec(n1)
                Dim decsum As Long = dec1 * dec2
                Dim dechex As String = Hex(decsum)
                mulfalgsetting8(dechex)
                Dim dechex1 As String = dechex + "H"
                MsgBox(dechex1)
                If dechex.Length = 4 Then
                    AH.Text = dechex.ToUpper.Substring(0, 2)
                    AL.Text = dechex.ToUpper.Substring(2, 2)
                ElseIf dechex.Length = 3 Then
                    Dim dechexa As String = "0" + dechex
                    AH.Text = dechexa.ToUpper.Substring(0, 2)
                    AL.Text = dechexa.ToUpper.Substring(2, 2)
                Else
                    MsgBox("Invalid result")
                End If
            Else
                MsgBox("Invalid value for accumalator")
            End If
        Else
            MsgBox("Operand value is not in length")
        End If
    End Sub
    Sub vardivrgstrmode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        If v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)
            AH.Text = InputBox("Enter the value for AH Accumalator")
            AL.Text = InputBox("Enter the value for AL Accumalator")
            If AH.Text.Length = 2 And AH.Text.Length = 2 Then
                Dim n1 As String = AH.Text.ToUpper
                Dim n2 As String = AL.Text.ToUpper
                Dim sumn As String = n1 + n2
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To sumn.Length - 1
                    If f1.Contains(sumn.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = sumn.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = hex_to_dec(sumn)
                Dim s1 As Long
                Dim s2 As Long
                s1 = dec2 / dec1
                s2 = dec2 Mod dec1
                Dim sh1 As String
                Dim sh2 As String
                sh1 = Hex(s1)
                sh2 = Hex(s2)
                AL.Text = sh1
                AH.Text = sh2
            Else
                MsgBox("Invalid, accumalator value is nt in range")
            End If
        ElseIf v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Or v1.Trim.ToUpper.EndsWith("h") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)
            AH.Text = InputBox("Enter the value for AH register")
            AL.Text = InputBox("Enter the value for AL register")
            DH.Text = InputBox("Enter the value for DH register")
            DL.Text = InputBox("Enter the value for DL register")
            If AH.Text.Length = 2 And AL.Text.Length = 2 And DH.Text.Length = 2 And DL.Text.Length = 2 Then
                Dim n1 As String = AH.Text.Trim.ToUpper
                Dim n2 As String = AL.Text.Trim.ToUpper
                Dim s1 As String = n1 + n2
                Dim n3 As String = DH.Text.ToUpper
                Dim n4 As String = DL.Text.ToUpper
                Dim s2 As String = n3 + n4
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To s1.Length - 1
                    If f1.Contains(s1.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To s2.Length - 1

                    If f1.Contains(s2.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = s1.Length And count2 = s2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = hex_to_dec(s1)
                Dim dec3 As Long = hex_to_dec(s2)
                Dim dec4 As Long = dec2 * dec3
                Dim s3 As Long = dec4 / dec1
                Dim s4 As Long = dec4 Mod dec1
                Dim sumh1 As String = Hex(s3)
                Dim sumh2 As String = Hex(s4)

                If sumh1.Length = 4 And sumh2.Length = 4 Then
                    AH.Text = sumh1.ToUpper.Substring(0, 2)
                    AL.Text = sumh1.ToUpper.Substring(2, 2)
                    DH.Text = sumh2.ToUpper.Substring(0, 2)
                    DL.Text = sumh2.ToUpper.Substring(2, 2)
                ElseIf sumh1.Length = 4 And sumh2.Length = 3 Then
                    AH.Text = sumh1.ToUpper.Substring(0, 2)
                    AL.Text = sumh1.ToUpper.Substring(2, 2)
                    Dim sumh2a As String = "0" + sumh2
                    DH.Text = sumh2a.ToUpper.Substring(0, 2)
                    DL.Text = sumh2a.ToUpper.Substring(2, 2)
                ElseIf sumh1.Length = 3 And sumh2.Length = 4 Then
                    Dim sumh1a As String = "0" + sumh1
                    AH.Text = sumh1a.ToUpper.Substring(0, 2)
                    AL.Text = sumh1a.ToUpper.Substring(2, 2)
                    DH.Text = sumh2.ToUpper.Substring(0, 2)
                    DL.Text = sumh2.ToUpper.Substring(2, 2)
                Else
                    MsgBox("Invalid result")
                End If
            Else
                MsgBox("Invlid value for 32 bitt register")
            End If
        Else
            MsgBox("Invalid length of regstr value")
        End If

    End Sub
    Sub varnotregMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        If v1.ToUpper.Length = 5 And v1.ToUpper.EndsWith("h") Or v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim fr As String = v2.ElementAt(0)
            Dim s1 As Long = hex_to_bin(v2)
            Dim s4 As String = s1.ToString
            Dim fr1() As String = New String() {"1"}
            Dim fr2() As String = New String() {"4", "5", "6", "7"}
            Dim fr3() As String = New String() {"2", "3"}
            Dim fr4() As String = New String() {"8", "9", "A", "B", "C", "D", "E", "F"}
            If fr = fr1(0) Then
                Dim s2 As String = "000" + s4
                Dim a() As Char = s2.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                Dim res2 As String = Hex(res1)
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    AH.Text = res2.ToUpper.Substring(0, 2)
                    AL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    BH.Text = res2.ToUpper.Substring(0, 2)
                    BL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    CH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    DH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    Dim res3 As String = res2 + "H"
                    SI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    Dim res3 As String = res2 + "H"
                    DI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    Dim res3 As String = res2 + "H"
                    SP.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    Dim res3 As String = res2 + "H"
                    BP.Text = res3
                Else
                    MsgBox("inavld")
                End If
            ElseIf fr = fr3(0) Or fr = fr3(1) Then
                Dim s2 As String = "00" + s4
                Dim a() As Char = s2.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                Dim res2 As String = Hex(res1)
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    AH.Text = res2.ToUpper.Substring(0, 2)
                    AL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    BH.Text = res2.ToUpper.Substring(0, 2)
                    BL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    CH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    DH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    Dim res3 As String = res2 + "H"
                    SI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    Dim res3 As String = res2 + "H"
                    DI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    Dim res3 As String = res2 + "H"
                    SP.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    Dim res3 As String = res2 + "H"
                    BP.Text = res3
                Else
                    MsgBox("inavld")
                End If
            ElseIf fr = fr2(0) Or fr = fr2(1) Or fr = fr2(2) Or fr = fr2(3) Then
                Dim s2 As String = "0" + s4
                Dim a() As Char = s2.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                Dim res2 As String = Hex(res1)
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    AH.Text = res2.ToUpper.Substring(0, 2)
                    AL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    BH.Text = res2.ToUpper.Substring(0, 2)
                    BL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    CH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    DH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    Dim res3 As String = res2 + "H"
                    SI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    Dim res3 As String = res2 + "H"
                    DI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    Dim res3 As String = res2 + "H"
                    SP.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    Dim res3 As String = res2 + "H"
                    BP.Text = res3
                Else
                    MsgBox("inavld")
                End If
            ElseIf fr4.Contains(fr) Then
                Dim a() As Char = s4.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                Dim res2 As String = Hex(res1)
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    AH.Text = res2.ToUpper.Substring(0, 2)
                    AL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    BH.Text = res2.ToUpper.Substring(0, 2)
                    BL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    CH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    DH.Text = res2.ToUpper.Substring(0, 2)
                    DL.Text = res2.ToUpper.Substring(2, 2)
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    Dim res3 As String = res2 + "H"
                    SI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    Dim res3 As String = res2 + "H"
                    DI.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    Dim res3 As String = res2 + "H"
                    SP.Text = res3
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    Dim res3 As String = res2 + "H"
                    BP.Text = res3
                Else
                    MsgBox("inavld")
                End If
            End If

        ElseIf v1.ToUpper.Length = 3 And v1.ToUpper.EndsWith("h") Or v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)


            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim fr As String = v2.ElementAt(0)
            Dim s1 As Long = hex_to_bin(v2)
            Dim s4 As String = s1.ToString
            Dim fr1() As String = New String() {"1"}
            Dim fr2() As String = New String() {"4", "5", "6", "7"}
            Dim fr3() As String = New String() {"2", "3"}
            Dim fr4() As String = New String() {"8", "9", "A", "B", "C", "D", "E", "F"}
            If fr = fr1(0) Then
                Dim s2 As String = "000" + s4
                Dim a() As Char = s2.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                Dim res2 As String = Hex(res1)
                Dim res3 As String = res2 + "H"
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    AH.Text = res3.ToUpper
                    AL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    AL.Text = res3.ToUpper
                    AH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    BH.Text = res3.ToUpper
                    BL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    BL.Text = res3.ToUpper
                    BH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    CH.Text = res3.ToUpper
                    CL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    CL.Text = res3.ToUpper
                    CH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    DH.Text = res3.ToUpper
                    DL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    DL.Text = res3.ToUpper
                    DH.Text = "00"
                Else
                    MsgBox("Invalid")
                End If
            ElseIf fr3.Contains(fr) Then
                Dim s2 As String = "00" + s4
                Dim a() As Char = s2.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                Dim res2 As String = Hex(res1)
                Dim res3 As String = res2 + "H"
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    AH.Text = res3.ToUpper
                    AL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    AL.Text = res3.ToUpper
                    AH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    BH.Text = res3.ToUpper
                    BL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    BL.Text = res3.ToUpper
                    BH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    CH.Text = res3.ToUpper
                    CL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    CL.Text = res3.ToUpper
                    CH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    DH.Text = res3.ToUpper
                    DL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    DL.Text = res3.ToUpper
                    DH.Text = "00"
                Else
                    MsgBox("Invalid")
                End If
            ElseIf fr2.Contains(fr) Then
                Dim s2 As String = "0" + s4
                Dim a() As Char = s2.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)
                MsgBox(res1)
                Dim res2 As String = Hex(res1)
                MsgBox(res2)
                Dim res3 As String = res2 + "H"
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    AH.Text = res3.ToUpper
                    AL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    AL.Text = res3.ToUpper
                    AH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    BH.Text = res3.ToUpper
                    BL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    BL.Text = res3.ToUpper
                    BH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    CH.Text = res3.ToUpper
                    CL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    CL.Text = res3.ToUpper
                    CH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    DH.Text = res3.ToUpper
                    DL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    DL.Text = res3.ToUpper
                    DH.Text = "00"
                Else
                    MsgBox("Invalid")
                End If
            ElseIf fr4.Contains(fr) Then
                Dim a() As Char = s4.ToString.ToCharArray
                Dim negative As String = ""
                For Each el As Char In a
                    If el = "1" Then
                        negative = negative + "0"
                    Else
                        negative = negative + "1"
                    End If
                Next
                MsgBox("Negative  : " + negative)
                Dim res1 As String = bin_to_dec(negative)

                Dim res2 As String = Hex(res1)

                Dim res3 As String = res2 + "H"
                If TextBox30.Text.Trim.ToUpper = c(0) Then
                    AH.Text = res3.ToUpper
                    AL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                    AL.Text = res3.ToUpper
                    AH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                    BH.Text = res3.ToUpper
                    BL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                    BL.Text = res3.ToUpper
                    BH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                    CH.Text = res3.ToUpper
                    CL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                    CL.Text = res3.ToUpper
                    CH.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                    DH.Text = res3.ToUpper
                    DL.Text = "00"
                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                    DL.Text = res3.ToUpper
                    DH.Text = "00"
                Else
                    MsgBox("Invalid")
                End If
            End If
        Else
            MsgBox("Invalid length")
        End If
    End Sub
    Sub varincrgstr()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper
            If v1.Length = 5 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 + 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow()
                incflagsetting(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If dech.Length = 4 Then
                        AH.Text = dech.ToUpper.Substring(0, 2)
                        AL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        AH.Text = decha.ToUpper.Substring(0, 2)
                        AL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If dech.Length = 4 Then
                        BH.Text = dech.ToUpper.Substring(0, 2)
                        BL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        BH.Text = decha.ToUpper.Substring(0, 2)
                        BL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If dech.Length = 4 Then
                        CH.Text = dech.ToUpper.Substring(0, 2)

                        CL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        CH.Text = decha.ToUpper.Substring(0, 2)
                        CL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If dech.Length = 4 Then
                        DH.Text = dech.ToUpper.Substring(0, 2)
                        DL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        DH.Text = decha.ToUpper.Substring(0, 2)
                        DL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    If dech.Length = 4 Then
                        SI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    If dech.Length = 4 Then
                        DI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        DI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    If dech.Length = 4 Then
                        SP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    If dech.Length = 4 Then
                        BP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        BP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
           
            ElseIf v1.Length = 3 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 + 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow8()
                incflagsetting8(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper.ToUpper = c(0) Then
                    If dech.Length = 2 Then
                        AH.Text = dech1.ToUpper
                        AL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AH.Text = decha1.ToUpper
                        AL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(1) Then
                    If dech.Length = 2 Then
                        AL.Text = dech1.ToUpper
                        AH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AL.Text = decha1.ToUpper
                        AH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(2) Then
                    If dech.Length = 2 Then
                        BH.Text = dech1.ToUpper
                        BL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BH.Text = decha1.ToUpper
                        BL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(3) Then
                    If dech.Length = 2 Then
                        BL.Text = dech1.ToUpper
                        BH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BL.Text = decha1.ToUpper
                        BH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(4) Then
                    If dech.Length = 2 Then
                        CH.Text = dech1.ToUpper
                        CL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CH.Text = decha1.ToUpper
                        CL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(5) Then
                    If dech.Length = 2 Then
                        CL.Text = dech1.ToUpper
                        CH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CL.Text = decha1.ToUpper
                        CH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(6) Then
                    If dech.Length = 2 Then
                        DH.Text = dech1.ToUpper
                        DL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DH.Text = decha1.ToUpper
                        DL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(7) Then
                    If dech.Length = 2 Then
                        DL.Text = dech1.ToUpper
                        DH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DL.Text = decha1.ToUpper
                        DH.Text = "00"
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            Else
                MsgBox("Invalid length")
            End If
        End If
    End Sub
    Sub vardecrgstrMode()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper
            If v1.Length = 5 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 4)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 - 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow()
                incflagsetting(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper = b(0) Then
                    If dech.Length = 4 Then
                        AH.Text = dech.ToUpper.Substring(0, 2)
                        AL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        AH.Text = decha.ToUpper.Substring(0, 2)
                        AL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                    If dech.Length = 4 Then
                        BH.Text = dech.ToUpper.Substring(0, 2)

                        BL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        BH.Text = decha.ToUpper.Substring(0, 2)
                        BL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                    If dech.Length = 4 Then
                        CH.Text = dech.ToUpper.Substring(0, 2)
                        CL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        CH.Text = decha.ToUpper.Substring(0, 2)
                        CL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                    If dech.Length = 4 Then
                        DH.Text = dech.ToUpper.Substring(0, 2)
                        DL.Text = dech.ToUpper.Substring(2, 2)
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        DH.Text = decha.ToUpper.Substring(0, 2)
                        DL.Text = decha.ToUpper.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                    If dech.Length = 4 Then
                        SI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                    If dech.Length = 4 Then
                        DI.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        DI.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                    If dech.Length = 4 Then
                        SP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        SP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                    If dech.Length = 4 Then
                        BP.Text = dech1
                    ElseIf dech.Length = 3 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = "0" + decha
                        BP.Text = decha1
                    Else
                        MsgBox("Invalid hexadecimal value or result is greater than 16 bit")
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            ElseIf v1.Length = 3 And v1.ToUpper.EndsWith("H") Or v1.ToUpper.EndsWith("h") Then
                Dim v2 As String = v1.ToUpper.Substring(0, 2)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                If count = v2.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim dec1 As Long = hex_to_dec(v2)
                Dim dec2 As Long = dec1 - 1
                Dim dech As String = Hex(dec2)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(dech)
                t5.Text = OverFlow8()
                incflagsetting8(dech)
                Dim dech1 As String = dech + "H"
                If TextBox30.Text.Trim.ToUpper.ToUpper = c(0) Then
                    If dech.Length = 2 Then
                        AH.Text = dech1.ToUpper
                        AL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AH.Text = decha1.ToUpper
                        AL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(1) Then
                    If dech.Length = 2 Then
                        AL.Text = dech1.ToUpper
                        AH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        AL.Text = decha1.ToUpper
                        AH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(2) Then
                    If dech.Length = 2 Then
                        BH.Text = dech1.ToUpper
                        BL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BH.Text = decha1.ToUpper
                        BL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(3) Then
                    If dech.Length = 2 Then
                        BL.Text = dech1.ToUpper
                        BH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        BL.Text = decha1.ToUpper
                        BH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(4) Then
                    If dech.Length = 2 Then
                        CH.Text = dech1.ToUpper
                        CL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CH.Text = decha1.ToUpper
                        CL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(5) Then
                    If dech.Length = 2 Then
                        CL.Text = dech1.ToUpper
                        CH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        CL.Text = decha1.ToUpper
                        CH.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(6) Then
                    If dech.Length = 2 Then
                        DH.Text = dech1.ToUpper
                        DL.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DH.Text = decha1.ToUpper
                        DL.Text = "00"
                    End If
                ElseIf TextBox30.Text.Trim.ToUpper.ToUpper = c(7) Then
                    If dech.Length = 2 Then
                        DL.Text = dech1.ToUpper
                        DH.Text = "00"
                    ElseIf dech.Length = 1 Then
                        Dim decha As String = "0" + dech
                        Dim decha1 As String = decha + "H"
                        DL.Text = decha1.ToUpper
                        DH.Text = "00"
                    End If
                Else
                    MsgBox("Invalid combination")
                End If
            Else
                MsgBox("Invalid length")
            End If
        Else
            MsgBox("Invalid Value")
        End If
    End Sub
    Sub varmovdrctMode()
        Dim v1 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If v1.Trim.ToUpper = b(0) Then
            AH.Text = v1.Substring(0, 2)
            AL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(1) Then
            BH.Text = v1.Substring(0, 2)
            BL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(2) Then
            CH.Text = v1.Substring(0, 2)
            CL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(3) Then
            DH.Text = v1.Substring(0, 2)
            DL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(4) Then
            SI.Text = v1
        ElseIf v1.Trim.ToUpper = b(5) Then
            DI.Text = v1
        ElseIf v1.Trim.ToUpper = b(6) Then
            SP.Text = v1
        ElseIf v1.Trim.ToUpper = b(7) Then
            BP.Text = v1
        End If
        If v1.Trim.ToUpper = c(0) Then
            AH.Text = v1.Substring(0, 2)
            AL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(1) Then
            AL.Text = v1.Substring(0, 2)
            AH.Text = "00"
        ElseIf v1.Trim.ToUpper = c(2) Then
            BH.Text = v1.Substring(0, 2)
            BL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(3) Then
            BL.Text = v1.Substring(0, 2)
            BH.Text = "00"
        ElseIf v1.Trim.ToUpper = c(4) Then
            CH.Text = v1.Substring(0, 2)
            CL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(5) Then
            CL.Text = v1.Substring(0, 2)
            CH.Text = "00"
        ElseIf v1.Trim.ToUpper = c(6) Then
            DH.Text = v1.Substring(0, 2)
            DL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(7) Then
            DL.Text = v1.Substring(0, 2)
            DH.Text = "00"
        End If
        Dim f As String = TextBox30.Text.Trim.ToUpper
        If f.Length = 7 And f.StartsWith("[") And f.EndsWith("]") Then
            Dim f3 As String = TextBox30.Text.Trim.ToUpper.Substring(1, 4)
            Dim drct As String = v1
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f1 As Integer = hex_to_dec(tempstr)
                Dim F2 As Integer = hex_to_dec(f3)
                If (F2 = f1) Then
                    DataGridView1.Rows(F2 - 1).Cells(1).Value = drct.Substring(drct.Length - 2, 2)
                    DataGridView1.Rows(F2).Cells(1).Value = drct.Substring(drct.Length - 4, 2)
                End If

            Next
        ElseIf f.Length = 5 And f.StartsWith("[") And f.EndsWith("]") Then
            Dim f3 As String = TextBox30.Text.Trim.ToUpper.Substring(1, 2)
            Dim drct As String = v1
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f1 As Integer = hex_to_dec(tempstr)
                Dim F2 As Integer = hex_to_dec(f3)
                If (F2 = f1) Then
                    DataGridView1.Rows(F2).Cells(1).Value = drct
                End If
            Next
        Else
            MsgBox("invalid number")
        End If
    End Sub
    Sub varmovregMode()
        Dim v1 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If v1.Trim.ToUpper = b(0) Then
            AH.Text = v1.Substring(0, 2)
            AL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(1) Then
            BH.Text = v1.Substring(0, 2)
            BL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(2) Then
            CH.Text = v1.Substring(0, 2)
            CL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(3) Then
            DH.Text = v1.Substring(0, 2)
            DL.Text = v1.Substring(2, 4)
        ElseIf v1.Trim.ToUpper = b(4) Then
            SI.Text = v1
        ElseIf v1.Trim.ToUpper = b(5) Then
            DI.Text = v1
        ElseIf v1.Trim.ToUpper = b(6) Then
            SP.Text = v1
        ElseIf v1.Trim.ToUpper = b(7) Then
            BP.Text = v1
        End If
        If v1.Trim.ToUpper = c(0) Then
            AH.Text = v1.Substring(0, 2)
            AL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(1) Then
            AL.Text = v1.Substring(0, 2)
            AH.Text = "00"
        ElseIf v1.Trim.ToUpper = c(2) Then
            BH.Text = v1.Substring(0, 2)
            BL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(3) Then
            BL.Text = v1.Substring(0, 2)
            BH.Text = "00"
        ElseIf v1.Trim.ToUpper = c(4) Then
            CH.Text = v1.Substring(0, 2)
            CL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(5) Then
            CL.Text = v1.Substring(0, 2)
            CH.Text = "00"
        ElseIf v1.Trim.ToUpper = c(6) Then
            DH.Text = v1.Substring(0, 2)
            DL.Text = "00"
        ElseIf v1.Trim.ToUpper = c(7) Then
            DL.Text = v1.Substring(0, 2)
            DH.Text = "00"
        End If
        If b.Contains(TextBox32.Text.Trim.ToUpper) And v1.Length = 5 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            DataGridView1.Rows(0).Cells(1).Value = v1.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = v1.Substring(2, 2)

        ElseIf c.Contains(TextBox32.Text.Trim.ToUpper) And v1.Length = 3 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1
                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            DataGridView1.Rows(0).Cells(1).Value = TextBox32.Text.Substring(0, 2)
        End If
    End Sub
    Sub varmovbaseindxMode()
        Dim v1 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If v1.Length = 13 And v1.ToUpper.ElementAt(5) = "H" And v1.ToUpper.ElementAt(11) = "H" Then
            Dim v2 As String = v1.ToUpper.Substring(1, 4)
            Dim v3 As String = v1.ToUpper.Substring(7, 4)
            Dim count As Integer = 0
            If v1.Trim.ElementAt(6) = "+" Then
                For i As Integer = 0 To v2.Length - 1
                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decval As Long = hex_to_dec(v2)
                Dim decval1 As Long = hex_to_dec(v3)
                Dim sum As Long = decval + decval1
                Dim hexaval As String = Hex(sum)
                Dim strhexval As String
                strhexval = hexaval + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexaval)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + strhexval)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 4 Then
                            DataGridView1.Rows(0).Cells(1).Value = s1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = s1.Substring(2, 2)
                        End If
                    End If
                Next

            ElseIf v1.ToUpper.ElementAt(6) = "-" Then
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim v4 As Long = hex_to_dec(v2)
                Dim v5 As Long = hex_to_dec(v3)
                If v4 > v5 Then
                    Dim sum As Long = v4 - v5
                    Dim sumh As String = Hex(sum) + "H".ToUpper
                    MsgBox(sumh)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim s1 As String = TextBox32.Text
                            If s1.Length = 4 Then
                                DataGridView1.Rows(0).Cells(1).Value = s1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = s1.Substring(2, 2)
                            End If
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf v1.Length = 13 And v1.ToUpper.ElementAt(5) = "H" And v1.ToUpper.ElementAt(11) = "H" Then
            Dim v2 As String = v1.ToUpper.Substring(1, 4)
            Dim v3 As String = v1.ToUpper.Substring(7, 4)
            Dim count As Integer = 0
            If v1.ToUpper.ElementAt(6) = "+" Then
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decval As Long = hex_to_dec(v2)
                Dim decval1 As Long = hex_to_dec(v3)
                Dim sum As Long = decval + decval1
                Dim hexaval As String = Hex(sum)

                Dim strhexval As String
                strhexval = hexaval + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(hexaval)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + strhexval)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 4 Then
                            DataGridView1.Rows(0).Cells(1).Value = s1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = s1.Substring(2, 2)
                        End If
                    End If
                Next

            ElseIf v1.ToUpper.ElementAt(6) = "-" Then
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                If count = v2.Length And count1 = v3.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim v4 As Long = hex_to_dec(v2)
                Dim v5 As Long = hex_to_dec(v3)
                If v4 > v5 Then
                    Dim sum As Long = v4 - v5
                    Dim sumh As String = Hex(sum) + "H".ToUpper
                    MsgBox(sumh)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim s1 As String = TextBox32.Text
                            If s1.Length = 4 Then
                                DataGridView1.Rows(0).Cells(1).Value = s1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = s1.Substring(2, 2)
                            End If
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        Else
            MsgBox("Invalid regisster combination")
        End If
    End Sub
    Sub varmovrgstrindrctMode()
        Dim v1 As String = InputBox("Enter th value for" + TextBox32.Text.Trim.ToUpper)
        Dim v4 As String = v1.Trim.ToUpper.Substring(1, 4)
        If v1.Length = 7 Then
            Dim v2 As String = v1.ToUpper.Substring(1, 5)
            Dim v3 As String = v1.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v1)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text.ToUpper
                    If s1.Length = 2 Then
                        DataGridView1.Rows(0).Cells(1).Value = s1.Substring(0, 2)
                    End If
                End If
            Next
        ElseIf v1.Length = 5 Then
            Dim v2 As String = v1.ToUpper.Substring(1, 3)
            Dim v3 As String = v1.ToUpper.Substring(1, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            If count = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v1)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text.ToUpper
                    If s1.Length = 2 Then
                        DataGridView1.Rows(0).Cells(1).Value = s1.Substring(0, 2)
                    End If
                End If
                        Next
       
        Else
            MsgBox("Invalid combination of register value")
        End If
    End Sub
    Sub varorimmdete()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = TextBox32.Text.Trim.ToUpper
        If v1.Length = 5 And v2.Length = 5 And v1.ToUpper.EndsWith("H") And v2.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            orflagsetting(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.ToUpper.EndsWith("H") And v2.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            orflagsetting8(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
        Else
            MsgBox("Invalid combination of register value")
        End If
    End Sub
    Sub varordrct()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = TextBox32.Text.Trim.ToUpper
        If v1.Length = 5 And v2.Length = 7 And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f1 As Integer = hex_to_dec(tempstr)
                Dim F2 As Integer = hex_to_dec(v4)
                If (F2 = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v5)
                    DataGridView1.Rows(F2).Cells(1).Value = values1
                    TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hexa(r)
                        orflagsetting(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                        Dim dataGridValue As String = ""

                    End If

                Else

                End If
            Next
        ElseIf v1.Length = 3 And v2.Length = 7 And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f1 As Integer = hex_to_dec(tempstr)
                Dim F2 As Integer = hex_to_dec(v4)
                If (F2 = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v5)
                    DataGridView1.Rows(F2).Cells(1).Value = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hex8(r)
                        orflagsetting8(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                    Else
                        MsgBox("Invalid msg hexadecimal")
                    End If       
                Else
                End If
            Next
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varorbaseindx()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If

        Dim v1 As String = TextBox30.Text
        Dim v2 As String = InputBox("Enter the value for  " + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3

                Dim sumbase1 As String = Hex(sumbase) + "H"
                Dim sumbase2 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            orflagsetting(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)

                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                       
                    Else

                    End If
                Next
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim sumbase2 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase2)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                orflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Subsraction cannor possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf v1.Length = 3 And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hex8(r)
                            orflagsetting8(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase2 As String = Hex(sumbase)
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase2)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hex8(r)
                                orflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If

                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("substraction cannot be done")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invaldi register combination")
        End If
    End Sub
    Sub varoregindrct()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 7 Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        MsgBox(r)
                        Dim r1 As String = hexa(r)
                        MsgBox(r1)
                        orflagsetting(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                       
                    Else
                        MsgBox("Invalid hexadecimal ")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next

        ElseIf v1.Length = 3 And v2.Length = 7 Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hex8(r)
                        orflagsetting8(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                    Else
                        MsgBox("inavlid hexadecimal")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        Else
            MsgBox("Invalid hexadecimal value")
        End If
    End Sub
    Sub varorrgstrrltv()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13)) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            orflagsetting(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)  
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                orflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                
                            Else
                                MsgBox("Invald length of hecadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Inavlid substraction")
                End If
            Else
                MsgBox("Invalid sign OPeration")
            End If
        ElseIf (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13)) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hex8(r)
                            orflagsetting8(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v2)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hex8(r)
                                orflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)

                            Else
                                MsgBox("Invalid hexadecimal valie")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction cannot be proseecd")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid register combiuantion")
        End If
    End Sub
    Sub varorrltvbase()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text

                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                Dim dataGridValue As String = ""

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("substraction cannot be prossed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                MsgBox(s2)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                               
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                Else
                    MsgBox("Substraction cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 4 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow()
                                    Dim s3 As String = hex_to_bin(v3)
                                    Dim s4 As String = hex_to_bin(u1)

                                    Dim source As String = s4
                                    Dim dest As String = s3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = hexa(r)
                                    andflagsetting(r1)
                                    DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                    DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                  
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Substraction cannot be perfomred")
                    End If
                Else
                    MsgBox("Substraction cannot be perfomred")
                End If
            Else
                MsgBox("Invalid sign opearion")
            End If
        ElseIf (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then

            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = Hex(r)
                            andflagsetting8(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("substraction cannot be processed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                               
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                  
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u3 As String = hex_to_bin(v3)
                                    Dim u4 As String = hex_to_bin(u1)
                                    Dim source As String = u4
                                    Dim dest As String = u3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = Hex(r)
                                    andflagsetting8(r1)
                                    DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                   
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction CAnnot be performed")
                    End If
                Else
                    MsgBox("Substraction CAnnot be performed")
                End If

            Else
                MsgBox("Invlaid sign operation")
            End If

        Else
            MsgBox("Invalid register cobination")
        End If

    End Sub
    Sub varorregster()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.ToUpper
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 5 And v1.ToUpper.EndsWith("H") And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            orflagsetting(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
            
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.ToUpper.EndsWith("H") And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" Or source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            orflagsetting8(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
          
        Else
            MsgBox("Invalid combination of register value")
        End If
    End Sub
    Sub varaddrgstrrltv()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper

        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13)) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim s1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim s2 As Long = hex_to_dec(s1)

                        Dim sum As Long = decregrltv1 + s2

                        Dim hexsum As String = Hex(sum)

                        AddFlagSetting(hexsum)
                        Dim hexsum1 As String = hexsum + "H".ToUpper

                        DataGridView1.Rows(0).Cells(1).Value = hexsum.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = hexsum.Substring(2, 2)

                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1

                            Dim s1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow()
                            Dim s2 As Long = hex_to_dec(s1)

                            Dim sum As Long = decregrltv1 + s2

                            Dim hexsum As String = Hex(sum)

                            AddFlagSetting(hexsum)
                            Dim hexsum1 As String = hexsum + "H".ToUpper

                            DataGridView1.Rows(0).Cells(1).Value = hexsum.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = hexsum.Substring(2, 2)
                           
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
            Else
                MsgBox("Substraction CAnnot be perform")
            End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13)) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim s1 As String = TextBox32.Text

                        If s1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            Dim s2 As Long = hex_to_dec(s1)

                            Dim sum As Long = decregrltv1 + s2

                            Dim hexsum As String = Hex(sum)

                            addflagsetting8(hexsum)
                            Dim hexsum1 As String = hexsum + "H".ToUpper

                            DataGridView1.Rows(0).Cells(1).Value = hexsum.Substring(0, 2)

                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim s1 As String = TextBox32.Text

                            If s1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(s1)
                                t5.Text = OverFlow8()
                                Dim s2 As Long = hex_to_dec(s1)

                                Dim sum As Long = decregrltv1 + s2

                                Dim hexsum As String = Hex(sum)

                                addflagsetting8(hexsum)
                                Dim hexsum1 As String = hexsum + "H"

                                DataGridView1.Rows(0).Cells(1).Value = hexsum.Substring(0, 2)
                               
                            Else
                                MsgBox("Invalid hecadecimal value entered")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invalid combination of registers")
        End If
    End Sub
    Sub varaddrltvbaseMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 2 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (v1.Length = 5) And (v1.ToUpper.Trim.ElementAt(4) = "H" Or v1.ToUpper.Trim.ElementAt(4) = "h") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim sumadd As Long = adddec2 + adddec3 + adddec4

                Dim sumadd1 As String = Hex(sumadd)

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow()
                        Dim decs1 As Long = hex_to_dec(s1)

                        Dim sumdec As Long = adddec1 + decs1

                        Dim sumdec1 As String = Hex(sumdec)

                        AddFlagSetting(sumdec1)
                        Dim sumdec2 As String = sumdec1 + "H".ToUpper

                        DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = sumdec1.Substring(2, 2)
                       
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim u2 As Long = hex_to_dec(u1)
                            Dim s3 As Long = u2 + adddec1

                            Dim sumdec1 As String = Hex(s3)

                            AddFlagSetting(sumdec1)
                            Dim sumdec2 As String = sumdec1 + "H"

                            DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = sumdec1.Substring(2, 2)
                            
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next         
            Else
                MsgBox("Substraction Cannot be performed")
            End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim u2 As Long = hex_to_dec(u1)
                            Dim s3 As Long = u2 + adddec1

                            Dim sumdec1 As String = Hex(s3)

                            AddFlagSetting(sumdec1)
                            Dim sumdec2 As String = sumdec1 + "H"

                            DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = sumdec1.Substring(2, 2)

                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be performed")
                End If

            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim s3 As Long = u2 + adddec1

                                Dim sumdec1 As String = Hex(s3)

                                AddFlagSetting(sumdec1)
                                Dim sumdec2 As String = sumdec1 + "H"
                                DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = sumdec1.Substring(2, 2)
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction Cannot be performed")
                    End If
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            Else
                MsgBox("Invalid Sign operation")
            End If
        ElseIf (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = v2.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim sumadd As Long = adddec2 + adddec3 + adddec4

                Dim sumadd1 As String = Hex(sumadd)

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim s1 As String = TextBox32.Text
                        If s1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(s1)
                            t5.Text = OverFlow8()
                            Dim decs1 As Long = hex_to_dec(s1)

                            Dim sumdec As Long = adddec1 + decs1

                            Dim sumdec1 As String = Hex(sumdec)

                            addflagsetting8(sumdec1)
                            Dim sumdec2 As String = sumdec1 + "H"

                            DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                            
                        Else
                            MsgBox("Enterd hexadecimal value is not valid one")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim s3 As Long = u2 + adddec1

                                Dim sumdec1 As String = Hex(s3)

                                addflagsetting8(sumdec1)
                                Dim sumdec2 As String = sumdec1 + "H"

                                DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                               
                            Else
                                MsgBox("Enter value is not a valid one")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3

                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u2 As Long = hex_to_dec(u1)
                                Dim s3 As Long = u2 + adddec1

                                Dim sumdec1 As String = Hex(s3)

                                addflagsetting8(sumdec1)
                                Dim sumdec2 As String = sumdec1 + "H"

                                DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u2 As Long = hex_to_dec(u1)
                                    Dim s3 As Long = u2 + adddec1

                                    Dim sumdec1 As String = Hex(s3)

                                    addflagsetting8(sumdec1)
                                    Dim sumdec2 As String = sumdec1 + "H"

                                    DataGridView1.Rows(0).Cells(1).Value = sumdec1.Substring(0, 2)
                                Else
                                    MsgBox("Enterd value is not a valid one")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be process")
                    End If
                Else
                    MsgBox("Substraction cannot be process")
                End If
            Else
                MsgBox("Invalid Sign operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varaddImmdtMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        If TextBox32.Text.Length = 5 And TextBox30.Text.Length = 5 Then
            Dim addvalue As String = TextBox30.Text.ToUpper
            Dim addvalue1 As String = addvalue.Substring(0, 4)
            Dim addvalue2 As String = TextBox32.Text.Trim.Substring(0, 4)
            Dim adddec As Long = hex_to_dec(addvalue1)
            Dim adddec1 As Long = hex_to_dec(addvalue2)
            Dim adddecsum As Long = adddec + adddec1
            Dim addhexsum As String = Hex(adddecsum)
            binOp1 = hex_to_bin(addvalue1)
            binOp2 = hex_to_bin(addhexsum)
            t5.Text = OverFlow()
            AddFlagSetting(addhexsum)
            Dim hexsum As String = addhexsum + "H"
            TextBox32.Text = hexsum
            Dim hexsum1 As String = hexsum.Substring(0, 4).ToUpper
            MsgBox(hexsum1)
            DataGridView1.Rows(0).Cells(1).Value = addhexsum.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = addhexsum.Substring(2, 2)
        ElseIf TextBox32.Text.Trim.Length = 3 And TextBox30.Text.Length = 3 Then
            Dim addvalue As String = TextBox30.Text.ToUpper
            Dim addvalue1 As String = addvalue.Substring(0, 2)
            Dim addvalue2 As String = TextBox32.Text.Trim.Substring(0, 2)
            Dim adddec As Long = hex_to_dec(addvalue1)
            Dim adddec1 As Long = hex_to_dec(addvalue2)
            Dim adddecsum As Long = adddec + adddec1
            Dim addhexsum As String = Hex(adddecsum)
            binOp1 = hex_to_bin(addvalue1)
            binOp2 = hex_to_bin(addhexsum)
            t5.Text = OverFlow8()
            addflagsetting8(addhexsum)
            Dim hexsum As String = addhexsum + "H".ToUpper
            TextBox32.Text = hexsum
            DataGridView1.Rows(0).Cells(1).Value = addhexsum.Substring(0, 2)
        Else
            MsgBox("Invalid combination of register")
        End If
    End Sub
    Sub varadddrctMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        If (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)

            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)

            Dim v3 As String = v4 + "H"
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2

                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v3)
                    DataGridView1.Rows(f).Cells(1).Value = values1

                    TextBox32.Text = values1
                    Dim drctadd1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(drctadd1)
                    t5.Text = OverFlow()
                    Dim decdrct1 As Long = hex_to_dec(drctadd1)

                    Dim decdrct2 As Long = hex_to_dec(v2)

                    Dim sumdrct As Long = decdrct1 + decdrct2

                    Dim sumhexdrct As String = Hex(sumdrct)

                    AddFlagSetting(sumhexdrct)
                    Dim sumhexdrct1 As String = sumhexdrct + "H"
                    DataGridView1.Rows(0).Cells(1).Value = sumhexdrct.Substring(0, 2)
                    DataGridView1.Rows(1).Cells(1).Value = sumhexdrct.Substring(2, 2)
                  
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next  
        ElseIf (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)

            Dim v3 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v3.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2

                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v3)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v3)
                    DataGridView1.Rows(f).Cells(1).Value = values1

                    TextBox32.Text = values1
                    Dim drctadd1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v2)
                    binOp2 = hex_to_bin(drctadd1)
                    t5.Text = OverFlow8()
                    Dim decdrct1 As Long = hex_to_dec(drctadd1)

                    Dim decdrct2 As Long = hex_to_dec(v2)

                    Dim sumdrct As Long = decdrct1 + decdrct2

                    Dim sumhexdrct As String = Hex(sumdrct)

                    addflagsetting8(sumhexdrct)
                    Dim sumhexdrct1 As String = sumhexdrct + "H"

                    DataGridView1.Rows(0).Cells(1).Value = sumhexdrct.Substring(0, 2)
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next

        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varaddregindctMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If v1.Length = 5 And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(s1)
                    t5.Text = OverFlow()
                    Dim decs1 As Long = hex_to_dec(s1)

                    Dim decs2 As Long = hex_to_dec(v3)

                    Dim sumdec As String = decs1 + decs2

                    Dim sumhex As String = Hex(sumdec)

                    AddFlagSetting(sumhex)
                    Dim sumhex1 As String = sumhex + "H".ToUpper

                    DataGridView1.Rows(0).Cells(1).Value = sumhex.Substring(0, 2)
                    DataGridView1.Rows(1).Cells(1).Value = sumhex.Substring(2, 2)

                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        ElseIf v1.Length = 3 And (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim s1 As String = TextBox32.Text
                    If s1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(s1)
                        t5.Text = OverFlow8()
                        Dim decs1 As Long = hex_to_dec(s1)

                        Dim decs2 As Long = hex_to_dec(v3)

                        Dim sumdec As String = decs1 + decs2

                        Dim sumhex As String = Hex(sumdec)

                        addflagsetting8(sumhex)
                        Dim sumhex1 As String = sumhex + "H".ToUpper

                        DataGridView1.Rows(0).Cells(1).Value = sumhex.Substring(0, 2)
                    Else
                        MsgBox("Invalid hexadecimal value is invalid")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varaddregadd()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim regadd1 As String = TextBox30.Text.Trim.ToUpper

        Dim regadd2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If regadd1.Length = 5 And (regadd1.ToUpper.Length = 5) And (regadd1.ToUpper.Trim.EndsWith("h") Or regadd1.ToUpper.Trim.EndsWith("H")) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (regadd2.ToUpper.Length = 5 And (regadd2.ToUpper.Trim.EndsWith("h") Or regadd2.ToUpper.Trim.EndsWith("H")))) Then
            Dim regadd3 As String = regadd1.ToUpper.Substring(0, 4)

            Dim regadd4 As String = regadd2.ToUpper.Substring(0, 4)

            binOp1 = hex_to_bin(regadd3)
            binOp2 = hex_to_bin(regadd4)
            t5.Text = OverFlow()
            Dim count As Integer = 0
            For i As Integer = 0 To regadd3.Length - 1

                If f1.Contains(regadd3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To regadd4.Length - 1

                If f1.Contains(regadd4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = regadd3.Length And count1 = regadd4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim regdec1 As Long = hex_to_dec(regadd3)

            Dim regdec2 As Long = hex_to_dec(regadd4)

            Dim regdecsum As Long = regdec1 + regdec2

            Dim reghex As String = Hex(regdecsum)
            AddFlagSetting(reghex)

            DataGridView1.Rows(0).Cells(1).Value = reghex.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = reghex.Substring(2, 2)
           
        ElseIf regadd1.Length = 3 And (regadd1.ToUpper.Length = 3) And (regadd1.ToUpper.Trim.EndsWith("h") Or regadd1.ToUpper.Trim.EndsWith("H")) And (c.Contains(TextBox32.Text.Trim.ToUpper) And (regadd2.ToUpper.Length = 3 And (regadd2.ToUpper.Trim.EndsWith("h") Or regadd2.ToUpper.Trim.EndsWith("H")))) Then
            Dim regadd3 As String = regadd1.ToUpper.Substring(0, 2)
            MsgBox(regadd3)
            Dim regadd4 As String = regadd2.ToUpper.Substring(0, 2)
            MsgBox(regadd4)
            binOp1 = hex_to_bin(regadd3)
            binOp2 = hex_to_bin(regadd4)
            t5.Text = OverFlow8()
            Dim count As Integer = 0
            For i As Integer = 0 To regadd3.Length - 1

                If f1.Contains(regadd3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To regadd4.Length - 1

                If f1.Contains(regadd4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = regadd3.Length And count1 = regadd4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
            End If
            Dim regdec1 As Long = hex_to_dec(regadd3)
            MsgBox(regdec1)
            Dim regdec2 As Long = hex_to_dec(regadd4)
            MsgBox(regdec2)
            Dim regdecsum As Long = regdec1 + regdec2
            MsgBox(regdecsum)
            Dim reghex1 As String = Hex(regdecsum)
            MsgBox(reghex1)
            addflagsetting8(reghex1)
            Dim reghex As String = reghex1 + "H"
            MsgBox(reghex)
            DataGridView1.Rows(0).Cells(1).Value = reghex.Substring(0, 2)
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varaddbaseMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase) + "H"
                Dim sumbase2 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim total As String = TextBox32.Text.ToUpper
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(total)
                        t5.Text = OverFlow()
                        Dim total1 As Long = hex_to_dec(total)
                        Dim totalsum As Long = baseadd1 + total1
                        Dim totaladdsum As String = Hex(totalsum)
                        AddFlagSetting(totaladdsum)
                        Dim totaladdsum1 As String = totaladdsum + "H"
                        DataGridView1.Rows(0).Cells(1).Value = totaladdsum.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = totaladdsum.Substring(2, 2)
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim sumbase2 As String = Hex(sumbase)
                    Dim flagVale As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase2)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)

                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim total As String = TextBox32.Text.ToUpper
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(total)
                            t5.Text = OverFlow()
                            Dim total1 As Long = hex_to_dec(total)
                            Dim totalsum As Long = baseadd1 + total1
                            Dim totaladdsum As String = Hex(totalsum)
                            AddFlagSetting(totaladdsum)
                            Dim totaladdsum1 As String = totaladdsum + "H"
                            DataGridView1.Rows(0).Cells(1).Value = totaladdsum.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = totaladdsum.Substring(2, 2)
                            
                        End If
                    Next
            Else
                MsgBox("substraction cannot be performed")
            End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf v1.Length = 3 And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim total As String = TextBox32.Text.ToUpper
                        If total.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(total)
                            t5.Text = OverFlow8()
                            Dim total1 As Long = hex_to_dec(total)
                            Dim totalsum As Long = baseadd1 + total1
                            Dim totaladdsum As String = Hex(totalsum)
                            addflagsetting8(totaladdsum)
                            Dim totaladdsum1 As String = totaladdsum + "H"
                            DataGridView1.Rows(0).Cells(1).Value = totaladdsum.Substring(0, 2)
                           
                        Else
                            MsgBox("enterd hexadecimal value is invalid")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim sumbase2 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase2)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim total As String = TextBox32.Text.ToUpper
                            If total.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(total)
                                t5.Text = OverFlow8()
                                Dim total1 As Long = hex_to_dec(total)
                                Dim totalsum As Long = baseadd1 + total1
                                Dim totaladdsum As String = Hex(totalsum)
                                addflagsetting8(totaladdsum)
                                Dim totaladdsum1 As String = totaladdsum + "H"
                                DataGridView1.Rows(0).Cells(1).Value = totaladdsum.Substring(0, 2)
                            Else
                                MsgBox("enterd hexadecimal value is invalid")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannnot be performed")
                End If
            Else
                MsgBox("Invalid sign operation")
            End If
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub varsubregMode()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper

            Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

            If (v1.ToUpper.Length = 5) And v1.ToUpper.Trim.EndsWith("H") And (c.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 5 And v2.ToUpper.Trim.EndsWith("H"))) Then
                Dim v3 As String = v1.ToUpper.Substring(0, 4)

                Dim v4 As String = v2.ToUpper.Substring(0, 4)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                If v3 >= v4 Or v3 <= v4 Then
                    Dim subdec1 As Long = hex_to_dec(v3)

                    Dim subdec2 As Long = hex_to_dec(v4)

                    Dim subdec As Long = subdec1 - subdec2

                    Dim subhex As String = Hex(subdec)
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(subhex)
                    subcar()
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(subhex)
                    t5.Text = OverFlow()
                    subflagsetting(subhex)
                    Dim subhex1 As String = subhex + "H"

                    DataGridView1.Rows(0).Cells(1).Value = subhex.Substring(0, 2)
                    DataGridView1.Rows(1).Cells(1).Value = subhex.Substring(2, 2)


                Else
                    MsgBox("substraction Cannot be perform")
                End If
            ElseIf (v1.ToUpper.Length = 3) And v1.ToUpper.Trim.EndsWith("H") And (c.Contains(TextBox32.Text.Trim.ToUpper) And (v2.ToUpper.Length = 3 And v2.ToUpper.Trim.EndsWith("H"))) Then
                Dim v3 As String = v1.ToUpper.Substring(0, 2)

                Dim v4 As String = v2.ToUpper.Substring(0, 2)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                If v3 >= v4 Or v3 <= v4 Then
                    Dim subdec1 As Long = hex_to_dec(v3)

                    Dim subdec2 As Long = hex_to_dec(v4)

                    Dim subdec As Long = subdec1 - subdec2

                    Dim subhex As String = Hex(subdec)
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(subhex)
                    subcar()
                    binOp1 = hex_to_bin(v3)
                    binOp2 = hex_to_bin(subhex)
                    t5.Text = OverFlow8()
                    subflagsetting8(subhex)
                    Dim subhex1 As String = subhex + "H"

                    DataGridView1.Rows(0).Cells(1).Value = subhex.Substring(0, 2)


                Else
                    MsgBox("substraction Cannot be perform")
                End If
            Else
                MsgBox("Invalid combination of register")
            End If
        Else
            MsgBox("Inavlid hexadecimal value")
        End If
    End Sub
    Sub varsubregindrctMode()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper

            Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

            If v1.Length = 5 And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 4)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim sumd As String = v4 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v4)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v4)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text.ToUpper
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        subcar()
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(k1)
                        t5.Text = OverFlow()
                        Dim k2 As Long = hex_to_dec(v3)

                        Dim k3 As Long = hex_to_dec(k1)

                        If k2 >= k3 Or k2 <= k3 Then
                            Dim deff As Long = k2 - k3

                            Dim sumh As String = Hex(deff)

                            subflagsetting(sumh)
                            Dim sumh1 As String = sumh + "H".ToUpper
                            MsgBox(sumh1)
                            DataGridView1.Rows(0).Cells(1).Value = sumh.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = sumh.Substring(2, 2)
                        Else
                            MsgBox("Substraction Cannot be processed")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 2)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim sumd As String = v4 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(v4)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + v4)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim k1 As String = TextBox32.Text.ToUpper
                        If k1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow8()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 >= k3 Or k2 <= k3 Then
                                Dim deff As Long = k2 - k3

                                Dim sumh As String = Hex(deff)

                                subflagsetting8(sumh)
                                Dim sumh1 As String = sumh + "H"
                                MsgBox(sumh1)
                                DataGridView1.Rows(0).Cells(1).Value = sumh.Substring(0, 2)
                            Else
                                MsgBox("Substraction Cannot be processed")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            Else
                MsgBox("Invalid register combination")
            End If
        Else
            MsgBox("Invalid hexadecimal value")
        End If
    End Sub
    Sub varsubbaseindxMode()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper

            Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

            If (v1.ToUpper.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 4)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim v5 As String = v2.ToUpper.Substring(7, 4)

                If v2.ToUpper.ElementAt(6) = "+" Then
                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)


                    Dim sum As Long = s1 + s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 >= k3 Or k2 <= k3 Then
                                Dim bsum As Long = v3 - k1

                                Dim hexbsum As String = Hex(bsum)

                                subflagsetting(hexbsum)
                                Dim hexbsum1 As String = hexbsum + "H"

                                DataGridView1.Rows(0).Cells(1).Value = hexbsum.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = hexbsum.Substring(2, 2)

                            Else
                                MsgBox("Substraction Cannot be processsed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    If s1 > s2 Then
                        Dim sum As Long = s1 - s2

                        Dim hexsum As String = Hex(sum)

                        Dim hexsum1 As String = hexsum + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(hexsum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + hexsum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 >= k3 Or k2 <= k3 Then
                                    Dim bsum As Long = k2 - k3

                                    Dim hexbsum As String = Hex(bsum)

                                    subflagsetting(hexbsum)
                                    Dim hexbsum1 As String = hexbsum + "H"

                                    DataGridView1.Rows(0).Cells(1).Value = hexbsum.Substring(0, 2)
                                    DataGridView1.Rows(1).Cells(1).Value = hexbsum.Substring(2, 2)
                                   
                                Else
                                    MsgBox("Substraction Cannot be done")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Substraction Cannot be processd")
                    End If
                Else
                    MsgBox("Invalid sign Operation")
                End If
            ElseIf v1.ToUpper.Length = 3 And v1.ToUpper.Trim.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 2)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim v5 As String = v2.ToUpper.Substring(7, 4)

                If v2.ToUpper.ElementAt(6) = "+" Then
                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)


                    Dim sum As Long = s1 + s2

                    Dim hexsum As String = Hex(sum)

                    Dim hexsum1 As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 >= k3 Or k2 <= k3 Then
                                    Dim bsum As Long = v3 - k1

                                    Dim hexbsum As String = Hex(bsum)

                                    subflagsetting8(hexbsum)
                                    Dim hexbsum1 As String = hexbsum + "H"

                                    DataGridView1.Rows(0).Cells(1).Value = hexbsum.Substring(0, 2)
                                Else
                                    MsgBox("Substraction Cannot be done")
                                End If
                            Else
                                MsgBox("Invalid hexaecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    If s1 > s2 Then
                        Dim sum As Long = s1 - s2

                        Dim hexsum As String = Hex(sum)

                        Dim hexsum1 As String = hexsum + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(hexsum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + hexsum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim k2 As Long = hex_to_dec(v3)

                                    Dim k3 As Long = hex_to_dec(k1)

                                    If k2 >= k3 Or k2 <= k3 Then
                                        Dim bsum As Long = v3 - k1

                                        Dim hexbsum As String = Hex(bsum)

                                        subflagsetting8(hexbsum)
                                        Dim hexbsum1 As String = hexbsum + "H"

                                        DataGridView1.Rows(0).Cells(1).Value = hexbsum.Substring(0, 2)
                                    Else
                                        MsgBox("substraction cannot be perofrmed")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be processed")
                    End If
                Else
                    MsgBox("Invalid sign Operation")
                End If
            Else
                MsgBox("Invalid register combination")
            End If
        Else
            MsgBox("Invalid hexadecimal value")
        End If

    End Sub
    Sub varsubrgstrrltvMode()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper

            Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

            If (v1.ToUpper.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 4)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim v5 As String = v2.ToUpper
                If v2.ToUpper.ElementAt(6) = "+" Then
                    Dim str() As String = v5.Split("+")
                    Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                    MsgBox(actualstring)
                    Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                    MsgBox(v6)
                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v6.Length - 1

                        If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v6)

                    Dim sumb As Long = s1 + s2

                    Dim hexsum As String = Hex(sumb)

                    Dim hexsumb As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 > k3 Then
                                Dim bsumdec As Long = k2 - k3

                                Dim bsumhex As String = Hex(bsumdec)

                                subflagsetting(bsumhex)
                                Dim bsumhex1 As String = bsumhex + "H"

                                DataGridView1.Rows(0).Cells(1).Value = bsumhex.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = bsumhex.Substring(2, 2)

                            Else
                                MsgBox("substraction cannot processed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                    Dim str() As String = v5.Split("-")
                    Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                    Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v6.Length - 1

                        If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    If s1 > s2 Then

                        Dim sumb As Long = s1 - s2

                        Dim hexsum As String = Hex(sumb)

                        Dim hexsumb As String = hexsum + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(hexsum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + hexsumb)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim bsumdec As Long = k2 - k3

                                    Dim bsumhex As String = Hex(bsumdec)

                                    subflagsetting(bsumhex)
                                    Dim bsumhex1 As String = bsumhex + "H"

                                    DataGridView1.Rows(0).Cells(1).Value = bsumhex.Substring(0, 2)
                                    DataGridView1.Rows(1).Cells(1).Value = bsumhex.Substring(2, 2)
                                    
                                Else
                                    MsgBox("Substraction Cannot be preformed")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be performed")
                    End If
                Else
                    MsgBox("Invalid sign Operation")
                End If
            ElseIf (v1.ToUpper.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 2)
                Dim v4 As String = v2.ToUpper.Substring(1, 4)
                Dim v5 As String = v2.ToUpper
                If v2.ToUpper.ElementAt(6) = "+" Then
                    Dim str() As String = v5.Split("+")
                    Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                    Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v6.Length - 1

                        If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v6)

                    Dim sumb As Long = s1 + s2

                    Dim hexsum As String = Hex(sumb)

                    Dim hexsumb As String = hexsum + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(hexsum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + hexsumb)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim bsumdec As Long = k2 - k3

                                    Dim bsumhex As String = Hex(bsumdec)

                                    subflagsetting8(bsumhex)
                                    Dim bsumhex1 As String = bsumhex + "H".ToUpper

                                    DataGridView1.Rows(0).Cells(1).Value = bsumhex.Substring(0, 2)
                                Else
                                    MsgBox("Substraction Cannot be done")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value length")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                ElseIf v2.ToUpper.ElementAt(6) = "-" Then
                    Dim str() As String = v5.Split("-")
                    Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                    Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v6.Length - 1

                        If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v6.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v6)

                    If s1 > s2 Then
                        Dim sumb As Long = s1 - s2

                        Dim hexsum As String = Hex(sumb)

                        Dim hexsumb As String = hexsum + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(hexsum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + hexsumb)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim k2 As Long = hex_to_dec(v3)

                                    Dim k3 As Long = hex_to_dec(k1)

                                    If k2 > k3 Then
                                        Dim bsumdec As Long = k2 - k3

                                        Dim bsumhex As String = Hex(bsumdec)

                                        subflagsetting8(bsumhex)
                                        Dim bsumhex1 As String = bsumhex + "H"

                                        DataGridView1.Rows(0).Cells(1).Value = bsumhex.Substring(0, 2)
                                    Else
                                        MsgBox("SubstractionCannot be proceed")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be performed")
                    End If
                Else
                    MsgBox("Invalid sign Operation")
                End If
            Else
                MsgBox("Invalid register combination")
            End If
        Else
            MsgBox("Invalid hexaecimal value")
        End If
    End Sub
    Sub varsubbserltvMode()
        If TextBox37.Text.Trim.ToUpper.EndsWith("H") And TextBox37.Text.Length = 3 Or TextBox37.Text.Length = 5 Then
            TextBox30.Text = TextBox37.Text.Trim.ToUpper
            If TextBox30.Text.Length = 5 Then
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
            Else
                DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            End If
            Dim v1 As String = TextBox30.Text.Trim.ToUpper

            Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)

            If (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.ToUpper.Length = 5) And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H"))) Then
                Dim v3 As String = v1.ToUpper.Substring(0, 4)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim v5 As String = v2.ToUpper.Substring(7, 4)

                Dim v6 As String = v2.ToUpper

                If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                    Dim str() As String = v6.Split("-")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    Dim sum1 As Long = s1 + s2

                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 >= k3 Or k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3

                                    Dim sumh3 As String = Hex(sum3)

                                    subflagsetting(sumh3)
                                    Dim sumh4 As String = sumh3 + "H".ToUpper

                                    DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                    DataGridView1.Rows(1).Cells(1).Value = sumh3.Substring(2, 2)

                                Else
                                    MsgBox("Substraction Cannot be proceed")
                                End If

                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be done")
                    End If
                ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                    Dim str() As String = v6.Split("+")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    Dim sum1 As Long = s1 + s3

                    If sum1 > s2 Then
                        Dim sum2 As Long = sum1 - s2

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 >= k3 Or k2 <= k3 Then
                                    Dim sum3 As Long = k2 - k3

                                    Dim sumh3 As String = Hex(sum3)

                                    subflagsetting(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"

                                    DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                    DataGridView1.Rows(1).Cells(1).Value = sumh3.Substring(2, 2)

                                Else
                                    MsgBox("substraction cannot be proceed")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                        
                    Else
                        MsgBox("Substraction Acnnot proceeed")
                    End If
                ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                    Dim str() As String = v6.Split("+")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    Dim sum1 As Long = s1 + s2 + 3

                    Dim sumh1 As String = Hex(sum1)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            subcar()
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(k1)
                            t5.Text = OverFlow()
                            Dim k2 As Long = hex_to_dec(v3)

                            Dim k3 As Long = hex_to_dec(k1)

                            If k2 >= k3 Or k2 <= k3 Then
                                Dim sum3 As Long = k2 - k3

                                Dim sumh3 As String = Hex(sum3)

                                subflagsetting(sumh3)
                                Dim sumh4 As String = sumh3 + "H"

                                DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = sumh3.Substring(2, 2)
                               
                            Else
                                MsgBox("Substraction cannot be proceed")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                    
                ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                    Dim str() As String = v6.Split("-")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    If s1 > s2 Then
                        Dim sum1 As Long = s1 - s2

                        If sum1 > s3 Then
                            Dim sum2 As Long = sum1 - s3

                            Dim sumh1 As String = Hex(sum2)
                            Dim sumh2 As String = sumh1 + "H"

                            Dim flagValue As Boolean = False
                            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                                Dim f As Integer = hex_to_dec(sumh1)
                                Dim f1 As Integer = hex_to_dec(tempstr)
                                If (f = f1) Then
                                    Dim values1 As String = InputBox("enter the value for" + sumh2)
                                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                    TextBox32.Text = values1
                                    Dim k1 As String = TextBox32.Text
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow()
                                    Dim k2 As Long = hex_to_dec(v3)

                                    Dim k3 As Long = hex_to_dec(k1)

                                    If k2 >= k3 Or k2 <= k3 Then
                                        Dim sum3 As Long = k2 - k3

                                        Dim sumh3 As String = Hex(sum3)

                                        subflagsetting(sumh3)
                                        Dim sumh4 As String = sumh3 + "H"

                                        DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                        DataGridView1.Rows(1).Cells(1).Value = sumh3.Substring(2, 2)

                                    Else
                                        MsgBox("Substraction cannot be proceed")
                                    End If
                                    flagValue = False
                                    Exit For
                                Else
                                    flagValue = True
                                End If
                            Next
                            
                        Else
                            MsgBox("Substraction cannot be proceed")
                        End If
                    Else
                        MsgBox("Substraction cannot be proceed")
                    End If
                Else
                    MsgBox("Invalid sign Operation")
                End If
            ElseIf (v1.ToUpper.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
                Dim v3 As String = v1.ToUpper.Substring(0, 2)

                Dim v4 As String = v2.ToUpper.Substring(1, 4)

                Dim v5 As String = v2.ToUpper.Substring(7, 4)

                Dim v6 As String = v2.ToUpper

                If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                    Dim str() As String = v6.Split("-")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    Dim sum1 As Long = s1 + s2

                    If sum1 > s3 Then
                        Dim sum2 As Long = sum1 - s3

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim k2 As Long = hex_to_dec(v3)

                                    Dim k3 As Long = hex_to_dec(k1)

                                    If k2 >= k3 Or k2 <= k3 Then
                                        Dim sum3 As Long = k2 - k3

                                        Dim sumh3 As String = Hex(sum3)

                                        subflagsetting8(sumh3)
                                        Dim sumh4 As String = sumh3 + "H"

                                        DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                    Else
                                        MsgBox("Substraction cannot be proceed")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be [erformed")
                    End If
                ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                    Dim str() As String = v6.Split("+")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    Dim sum1 As Long = s1 + s3

                    If sum1 > s2 Then
                        Dim sum2 As Long = sum1 - s2

                        Dim sumh1 As String = Hex(sum2)
                        Dim sumh2 As String = sumh1 + "H"

                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sumh1)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sumh2)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim k1 As String = TextBox32.Text
                                If k1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    subcar()
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(k1)
                                    t5.Text = OverFlow8()
                                    Dim k2 As Long = hex_to_dec(v3)

                                    Dim k3 As Long = hex_to_dec(k1)

                                    If k2 >= k3 Or k2 <= k3 Then
                                        Dim sum3 As Long = k2 - k3

                                        Dim sumh3 As String = Hex(sum3)

                                        subflagsetting8(sumh3)
                                        Dim sumh4 As String = sumh3 + "H"

                                        DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                    Else
                                        MsgBox("Substraction cannot be proceed")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal value")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot proceed")
                    End If
                ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                    Dim str() As String = v6.Split("+")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    Dim sum1 As Long = s1 + s2 + 3

                    Dim sumh1 As String = Hex(sum1)
                    Dim sumh2 As String = sumh1 + "H"

                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumh1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumh2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim k1 As String = TextBox32.Text
                            If k1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                subcar()
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(k1)
                                t5.Text = OverFlow8()
                                Dim k2 As Long = hex_to_dec(v3)

                                Dim k3 As Long = hex_to_dec(k1)

                                If k2 > k3 Then
                                    Dim sum3 As Long = k2 - k3

                                    Dim sumh3 As String = Hex(sum3)

                                    subflagsetting8(sumh3)
                                    Dim sumh4 As String = sumh3 + "H"
                                    DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                Else
                                    MsgBox("Substraction cannot be proceed")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                    Dim str() As String = v6.Split("-")
                    Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                    Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                    Dim count As Integer = 0
                    For i As Integer = 0 To v3.Length - 1

                        If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                            count = count + 1
                        End If
                    Next
                    Dim count1 As Integer = 0
                    For i As Integer = 0 To v4.Length - 1

                        If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                            count1 = count1 + 1
                        End If
                    Next
                    Dim count2 As Integer = 0
                    For i As Integer = 0 To v5.Length - 1

                        If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                            count2 = count2 + 1
                        End If
                    Next
                    Dim count3 As Integer = 0
                    For i As Integer = 0 To v7.Length - 1

                        If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                            count3 = count3 + 1
                        End If
                    Next
                    If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                        MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                    Else
                        MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                        Exit Sub
                    End If
                    Dim s1 As Long = hex_to_dec(v4)

                    Dim s2 As Long = hex_to_dec(v5)

                    Dim s3 As Long = hex_to_dec(v7)

                    If s1 > s2 Then
                        Dim sum1 As Long = s1 - s2

                        If sum1 > s3 Then
                            Dim sum2 As Long = sum1 - s3

                            Dim sumh1 As String = Hex(sum2)
                            Dim sumh2 As String = sumh1 + "H"

                            Dim flagValue As Boolean = False
                            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                                Dim f As Integer = hex_to_dec(sumh1)
                                Dim f1 As Integer = hex_to_dec(tempstr)
                                If (f = f1) Then
                                    Dim values1 As String = InputBox("enter the value for" + sumh2)
                                    DataGridView1.Rows(f).Cells(1).Value = values1
                                    TextBox32.Text = values1
                                    Dim k1 As String = TextBox32.Text
                                    If k1.Length = 2 Then
                                        binOp1 = hex_to_bin(v3)
                                        binOp2 = hex_to_bin(k1)
                                        subcar()
                                        binOp1 = hex_to_bin(v3)
                                        binOp2 = hex_to_bin(k1)
                                        t5.Text = OverFlow8()
                                        Dim k2 As Long = hex_to_dec(v3)

                                        Dim k3 As Long = hex_to_dec(k1)

                                        If k2 > k3 Then
                                            Dim sum3 As Long = k2 - k3

                                            Dim sumh3 As String = Hex(sum3)

                                            subflagsetting8(sumh3)
                                            Dim sumh4 As String = sumh3 + "H"

                                            DataGridView1.Rows(0).Cells(1).Value = sumh3.Substring(0, 2)
                                        Else
                                            MsgBox("Substraction cannot be proceed")
                                        End If
                                    Else
                                        MsgBox("Invalid hexadecimal value")
                                    End If
                                    flagValue = False
                                    Exit For
                                Else
                                    flagValue = True
                                End If
                            Next
                        Else
                            MsgBox("Substraction cannot be proceed")
                        End If
                    Else
                        MsgBox("Substraction ACnnot be proceed")
                    End If
                Else
                    MsgBox("Invalid sign Operation")
                End If
            Else
                MsgBox("Invalid register combination")
            End If
        Else
            MsgBox("Invalid hexadecimal number")
        End If
    End Sub
    Sub varsubimmtrMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        If v1.Length = 5 And v1.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next

            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v3 As String = TextBox32.Text.Trim.ToUpper

            Dim v4 As String = v3.ToUpper.Substring(0, 4)

            If v2 > v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex As String = Hex(subimm)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(subhex)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(subhex)
                t5.Text = OverFlow()
                subflagsetting(subhex)
                Dim subhex1 As String = subhex + "H".ToUpper

                DataGridView1.Rows(0).Cells(1).Value = subhex.Substring(0, 2)
                DataGridView1.Rows(1).Cells(1).Value = subhex.Substring(2, 2)
               
            Else
                MsgBox("Substraction cannot perfomred")
            End If
        ElseIf v1.Length = 3 And v1.ToUpper.ElementAt(2) = "h" Or v1.ToUpper.ElementAt(2) = "H" Then
            Dim v2 As String = v1.ToUpper.Substring(0, 2)
            MsgBox(v2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next

            If count = v2.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v3 As String = TextBox32.Text.Trim.ToUpper

            Dim v4 As String = v3.ToUpper.Substring(0, 2)

            If v2 > v3 Then
                Dim subdec1 As Long = hex_to_dec(v2)

                Dim subdec2 As Long = hex_to_dec(v4)

                Dim subimm As Long = subdec1 - subdec2

                Dim subhex As String = Hex(subimm)
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(subhex)
                subcar()
                binOp1 = hex_to_bin(v2)
                binOp2 = hex_to_bin(subhex)
                t5.Text = OverFlow8()
                subflagsetting8(subhex)
                Dim subhex1 As String = subhex + "H".ToUpper

                DataGridView1.Rows(0).Cells(1).Value = subhex.Substring(0, 2)
            Else
                MsgBox("Substraction cannot perfomred")
            End If
        Else
            MsgBox("Invalid combination of register")
        End If

    End Sub
    Sub varandimmedate()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If

        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = TextBox32.Text.Trim.ToUpper
        If v1.Length = 5 And v2.Length = 5 And v1.ToUpper.EndsWith("H") And v2.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v3)

            Dim s2 As String = hex_to_bin(v4)

            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)

            Dim r1 As String = hexa(r)

            andflagsetting(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
           
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.ToUpper.EndsWith("H") And v2.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v3)

            Dim s2 As String = hex_to_bin(v4)

            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
        Else
            MsgBox("Invalid combination of register value")
        End If

    End Sub
    Sub varandreg()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.ToUpper
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 5 And v1.ToUpper.EndsWith("H") And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(0, 4)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v3)

            Dim s2 As String = hex_to_bin(v4)

            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)

            Dim r1 As String = hexa(r)

            andflagsetting(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.ToUpper.EndsWith("H") And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(0, 2)

            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v3)

            Dim s2 As String = hex_to_bin(v4)

            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                    result = result + "1"
                Else
                    result = result + "0"
                End If
            Next
            MsgBox("And Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            andflagsetting8(r1)
            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
        Else
            MsgBox("Invalid combination of register value")
        End If
    End Sub
    Sub varandbaseindxMode()

        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text
        Dim v2 As String = InputBox("Enter the value for  " + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase) + "H"
                Dim sumbase2 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase2)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hexa(r)

                            andflagsetting(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                           
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim sumbase2 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase2)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase2)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hexa(r)

                                andflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("Subsraction cannor possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf v1.Length = 3 And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)

                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)

                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"

                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase2)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase2)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hex8(r)

                            andflagsetting8(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
               
            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase) + "H"
                    Dim sumbase2 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase2)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase2)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hex8(r)

                                andflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If

                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("substraction cannot be done")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        Else
            MsgBox("Invaldi register combination")
        End If
    End Sub
    Sub varanddrctMode()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = TextBox32.Text.Trim.ToUpper
        If v1.Length = 5 And v2.Length = 7 And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1

                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hexa(r)

                        andflagsetting(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                        
                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        ElseIf v1.Length = 3 And v2.Length = 7 And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hex8(r)

                        andflagsetting8(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                       
                    Else
                        MsgBox("Invalid msg hexadecimal")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        Else
            MsgBox("Invalid register combination")

        End If
    End Sub
    Sub varandrgstrindrct()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox30.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper
        Dim v2 As String = InputBox("Enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 7 Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hexa(r)

                        andflagsetting(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                    Else
                        MsgBox("Invalid hexadecimal ")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
            
        ElseIf v1.Length = 3 And v2.Length = 7 Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1
                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            Dim v5 As String = v4 + "H"
            Dim flagValue As Boolean = False
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)

                        Dim s2 As String = hex_to_bin(u1)

                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                result = result + "1"
                            Else
                                result = result + "0"
                            End If
                        Next
                        MsgBox("And Result is " + result)
                        Dim r As String = bin_to_dec(result)

                        Dim r1 As String = hex8(r)

                        andflagsetting8(r1)
                        DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        
                    Else
                        MsgBox("inavlid hexadecimal")
                    End If
                    flagValue = False
                    Exit For
                Else
                    flagValue = True
                End If
            Next
        Else
            MsgBox("Invalid hexadecimal value")
        End If
    End Sub
    Sub varandrgstrrltv()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox32.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper

        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)

        If (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13)) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hexa(r)

                            andflagsetting(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                            
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hexa(r)
                                MsgBox(r1)

                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                
                            Else
                                MsgBox("Invald length of hecadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next                 
                Else
                    MsgBox("Inavlid substraction")
                End If
            Else
                MsgBox("Invalid sign OPeration")
            End If
        ElseIf (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13)) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)

            Dim v4 As String = v3.Substring(1, 4)

            Dim v5 As String = TextBox32.Text.ToUpper

            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                Dim adddec As Long = decregrltv2 + decregrltv3

                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)

                            Dim r1 As String = hex8(r)

                            andflagsetting8(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
                
            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)

                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)

                Dim decregrltv2 As Long = hex_to_dec(v4)

                Dim decregrltv3 As Long = hex_to_dec(v6)

                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3

                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)

                                Dim r1 As String = hex8(r)

                                andflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            Else
                                MsgBox("Invalid hexadecimal valie")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Invalid substraction cannot be proseecd")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If

        Else
            MsgBox("Invalid register combiantion")
        End If
    End Sub
    Sub varandrltvbase()
        TextBox30.Text = TextBox37.Text.Trim.ToUpper
        If TextBox32.Text.Length = 5 Then
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
            DataGridView1.Rows(1).Cells(1).Value = TextBox30.Text.Substring(2, 2)
        Else
            DataGridView1.Rows(0).Cells(1).Value = TextBox30.Text.Substring(0, 2)
        End If
        Dim v1 As String = TextBox30.Text.Trim.ToUpper

        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        If u1.Length = 4 Then
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                            DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)

                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                Dim dataGridValue As String = ""
                                
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("substraction cannot be prossed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                MsgBox(s2)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                Dim dataGridValue As String = ""

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 4 Then
                                    Dim s3 As String = hex_to_bin(v3)
                                    Dim s4 As String = hex_to_bin(u1)

                                    Dim source As String = s4
                                    Dim dest As String = s3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = hexa(r)
                                    andflagsetting(r1)
                                    DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                    DataGridView1.Rows(1).Cells(1).Value = r1.Substring(2, 2)
                                   
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be perfomred")
                    End If
                Else
                    MsgBox("Substraction cannot be perfomred")
                End If
            Else
                MsgBox("Invalid sign opearion")
            End If
        ElseIf (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                    result = result + "1"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("And Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = Hex(r)
                            andflagsetting8(r1)
                            DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                   
                Else
                    MsgBox("substraction cannot be processed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                        result = result + "1"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("And Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                Dim dataGridValue As String = ""

                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u3 As String = hex_to_bin(v3)
                                    Dim u4 As String = hex_to_bin(u1)
                                    Dim source As String = u4
                                    Dim dest As String = u3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1" Then
                                            result = result + "1"
                                        Else
                                            result = result + "0"
                                        End If
                                    Next
                                    MsgBox("And Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = Hex(r)
                                    andflagsetting8(r1)
                                    DataGridView1.Rows(0).Cells(1).Value = r1.Substring(0, 2)
                                    Dim dataGridValue As String = ""
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction CAnnot be performed")
                    End If
                Else
                    MsgBox("Substraction CAnnot be performed")
                End If
            Else
                MsgBox("Invlaid sign operation")
            End If
        Else
            MsgBox("Invalid register cobination")
        End If
    End Sub
    Sub XorregstrMod()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox("enter the value for" + TextBox32.Text.Trim.ToUpper)
        If v1.Length = 5 And v2.Length = 5 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                    result = result + "0"
                Else
                    result = result + "1"
                End If
            Next
            MsgBox("XOR Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            orflagsetting(r1)
            If (b(0).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(0).Contains(TextBox30.Text.Trim.ToUpper) <> b(0).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AH.Text = r1.ToUpper.Substring(0, 2)
                AL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(1).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(1).Contains(TextBox30.Text.Trim.ToUpper) <> b(1).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BH.Text = r1.ToUpper.Substring(0, 2)
                BL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(2).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(2).Contains(TextBox30.Text.Trim.ToUpper) <> b(2).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = r1.ToUpper.Substring(0, 2)
                CL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(3).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(3).Contains(TextBox30.Text.Trim.ToUpper) <> b(3).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = r1.ToUpper.Substring(0, 2)
                DL.Text = r1.ToUpper.Substring(2, 2)
            ElseIf (b(4).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> b(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SI.Text = r1.ToUpper
            ElseIf (b(5).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(5).Contains(TextBox30.Text.Trim.ToUpper) <> b(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DI.Text = r1.ToUpper
            ElseIf (b(6).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(6).Contains(TextBox30.Text.Trim.ToUpper) <> b(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                SP.Text = r1.ToUpper
            ElseIf (b(7).Contains(TextBox30.Text.Trim.ToUpper) And b.Contains(TextBox32.Text.Trim.ToUpper)) And (b(7).Contains(TextBox30.Text.Trim.ToUpper) <> b(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BP.Text = r1.ToUpper
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf v1.Length = 3 And v2.Length = 3 And v1.Trim.ToUpper.EndsWith("H") And v2.Trim.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.ToUpper.Substring(0, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v3)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v3)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                    result = result + "0"
                Else
                    result = result + "1"
                End If
            Next
            MsgBox("XOR Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            orflagsetting8(r1)
            If (c(0).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(0).Contains(TextBox30.Text.Trim.ToUpper) <> c(0).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AH.Text = r1.ToUpper
                AL.Text = "00"
            ElseIf (c(1).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(1).Contains(TextBox30.Text.Trim.ToUpper) <> c(1).Contains(TextBox32.Text.Trim.ToUpper)) Then
                AL.Text = r1.ToUpper
                AH.Text = "00"
            ElseIf (c(2).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(2).Contains(TextBox30.Text.Trim.ToUpper) <> c(2).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BH.Text = r1.ToUpper
                BL.Text = "00"
            ElseIf (c(3).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(3).Contains(TextBox30.Text.Trim.ToUpper) <> c(3).Contains(TextBox32.Text.Trim.ToUpper)) Then
                BL.Text = r1.ToUpper
                BH.Text = "00"
            ElseIf (c(4).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(4).Contains(TextBox30.Text.Trim.ToUpper) <> c(4).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CH.Text = r1.ToUpper
                CL.Text = "00"
            ElseIf (c(5).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(5).Contains(TextBox30.Text.Trim.ToUpper) <> c(5).Contains(TextBox32.Text.Trim.ToUpper)) Then
                CL.Text = r1.ToUpper
                CH.Text = "00"
            ElseIf (c(6).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(6).Contains(TextBox30.Text.Trim.ToUpper) <> c(6).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DH.Text = r1.ToUpper
                DL.Text = "00"
            ElseIf (c(7).Contains(TextBox30.Text.Trim.ToUpper) And c.Contains(TextBox32.Text.Trim.ToUpper)) And (c(7).Contains(TextBox30.Text.Trim.ToUpper) <> c(7).Contains(TextBox32.Text.Trim.ToUpper)) Then
                DL.Text = r1.ToUpper
                DH.Text = "00"
            Else
                MsgBox("Invalid ax to 16 in regstr")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varorregster()
        Else
            MsgBox("Invalid combination of register")
        End If

    End Sub
    Sub Xorimmdete()
        Dim v1 As String = InputBox("enter the value for" + TextBox30.Text.Trim.ToUpper)
        MsgBox(v1)
        If v1.Length = 5 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 4)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v2)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow()
            Dim s1 As String = hex_to_bin(v2)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                    result = result + "0"
                Else
                    result = result + "1"
                End If
            Next
            MsgBox("XOR Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hexa(r)
            orflagsetting(r1)
            If TextBox30.Text.Trim.ToUpper = b(0) Then
                AH.Text = r1.Substring(0, 2).ToUpper
                AL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                BH.Text = r1.Substring(0, 2).ToUpper
                BL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                CH.Text = r1.Substring(0, 2).ToUpper
                CL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                DH.Text = r1.Substring(0, 2).ToUpper
                DL.Text = r1.Substring(2, 2).ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                SI.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                DI.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                SP.Text = r1.ToUpper
            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                BP.Text = r1.ToUpper
            Else
                MsgBox("Invalid combination of register")
            End If
        ElseIf v1.Length = 3 And v1.Trim.ToUpper.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.ToUpper.Substring(0, 2)
            MsgBox(v2)
            Dim v3 As String = TextBox32.Text.Trim.ToUpper
            MsgBox(v3)
            Dim v4 As String = v3.ToUpper.ToUpper.Substring(0, 2)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            binOp1 = hex_to_bin(v2)
            binOp2 = hex_to_bin(v4)
            t5.Text = OverFlow8()
            Dim s1 As String = hex_to_bin(v2)
            Dim s2 As String = hex_to_bin(v4)
            Dim source As String = s2
            Dim dest As String = s1
            Dim result As String = ""
            For i As Integer = 0 To dest.Length - 1
                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                    result = result + "0"
                Else
                    result = result + "1"
                End If
            Next
            MsgBox("XOR Result is " + result)
            Dim r As String = bin_to_dec(result)
            Dim r1 As String = hex8(r)
            orflagsetting8(r1)
            If TextBox30.Text.Trim.ToUpper = c(0) Then
                AH.Text = r1.ToUpper
                AL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                AL.Text = r1.ToUpper
                AH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                BH.Text = r1.ToUpper
                BL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                BL.Text = r1.ToUpper
                BH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                CH.Text = r1.ToUpper
                CL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                CL.Text = r1.ToUpper
                CH.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                DH.Text = r1.ToUpper
                DL.Text = "00"
            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                DL.Text = r1.ToUpper
                DH.Text = "00"
            Else
                MsgBox("Invalid combination of register")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varorimmdete()
        Else
            MsgBox("Invalid combination of regisetr value")
        End If
    End Sub
    Sub XorregindctMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                result = result + "0"
                            Else
                                result = result + "1"
                            End If
                        Next
                        MsgBox("XOR Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hexa(r)
                        orflagsetting(r1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = r1.ToUpper.Substring(0, 2)
                            AL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = r1.ToUpper.Substring(0, 2)
                            BL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = r1.ToUpper.Substring(0, 2)
                            CL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = r1.ToUpper.Substring(0, 2)
                            DL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            SP.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BP.Text = r1.ToUpper
                        Else
                            MsgBox("Invalid reg combination")
                        End If
                    Else
                        MsgBox("Invalid hexadecimal number")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) Or (v1.Length = 3) And v1.ToUpper.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v3.Length - 1

                If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                    count = count + 1

                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next

            If count = v3.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v3)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v3)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                result = result + "0"
                            Else
                                result = result + "1"
                            End If
                        Next
                        MsgBox("XOR Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hex8(r)
                        orflagsetting8(r1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AH.Text = r1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            AL.Text = r1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BH.Text = r1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            BL.Text = r1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CH.Text = r1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            CL.Text = r1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DH.Text = r1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                            DL.Text = r1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("Invalid combination")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varoregindrct()
        Else
            MsgBox("Invalid combination register")
        End If
    End Sub
    Sub XordirctMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 4)
            MsgBox(v4)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If
            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                    DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 4 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow()
                        Dim s1 As String = hex_to_bin(v2)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                result = result + "0"
                            Else
                                result = result + "1"
                            End If
                        Next
                        MsgBox("XOR Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hexa(r)
                        orflagsetting(r1)
                        If TextBox30.Text.Trim.ToUpper = b(0) Then
                            AH.Text = r1.ToUpper.Substring(0, 2)
                            AL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                            BH.Text = r1.ToUpper.Substring(0, 2)
                            BL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                            CH.Text = r1.ToUpper.Substring(0, 2)
                            CL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                            DH.Text = r1.ToUpper.Substring(0, 2)
                            DL.Text = r1.ToUpper.Substring(2, 2)
                        ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                            SI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                            DI.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                            SP.Text = r1.ToUpper
                        ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                            BP.Text = r1.ToUpper
                        Else
                            MsgBox("INvalid destination register")
                        End If

                    Else
                        MsgBox("Invalid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = TextBox32.Text.Trim.ToUpper.Substring(1, 2)
            Dim count As Integer = 0
            For i As Integer = 0 To v2.Length - 1

                If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                    count = count + 1
                End If
            Next
            Dim count1 As Integer = 0
            For i As Integer = 0 To v4.Length - 1

                If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                    count1 = count1 + 1
                End If
            Next
            If count = v2.Length And count1 = v4.Length Then
                MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
            Else
                MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                Exit Sub
            End If

            For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                Dim f As Integer = hex_to_dec(v4)
                Dim f1 As Integer = hex_to_dec(tempstr)
                If (f = f1) Then
                    Dim values1 As String = InputBox("enter the value for" + v4)
                    DataGridView1.Rows(f).Cells(1).Value = values1
                    TextBox32.Text = values1
                    Dim u1 As String = TextBox32.Text
                    If u1.Length = 2 Then
                        binOp1 = hex_to_bin(v2)
                        binOp2 = hex_to_bin(u1)
                        t5.Text = OverFlow8()
                        Dim s1 As String = hex_to_bin(v2)
                        Dim s2 As String = hex_to_bin(u1)
                        Dim source As String = s2
                        Dim dest As String = s1
                        Dim result As String = ""
                        For i As Integer = 0 To dest.Length - 1
                            If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                result = result + "0"
                            Else
                                result = result + "1"
                            End If
                        Next
                        MsgBox("XOR Result is " + result)
                        Dim r As String = bin_to_dec(result)
                        Dim r1 As String = hex8(r)
                        orflagsetting8(r1)
                        If TextBox30.Text.Trim.ToUpper = c(0) Then
                            AH.Text = r1.ToUpper
                            AL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                            AL.Text = r1.ToUpper
                            AH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                            BH.Text = r1.ToUpper
                            BL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                            BL.Text = r1.ToUpper
                            BH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                            CH.Text = r1.ToUpper
                            CL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                            CL.Text = r1.ToUpper
                            CH.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                            DH.Text = r1.ToUpper
                            DL.Text = "00"
                        ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                            DL.Text = r1.ToUpper
                            DH.Text = "00"
                        Else
                            MsgBox("INvalid destination register")
                        End If
                    Else
                        MsgBox("Inavlid hexadecimal value")
                    End If

                    Exit For
                Else

                End If
            Next
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varordrct()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub XorbaseindexMode()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        If b.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 5 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1
                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase1 As String = Hex(sumbase)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                    result = result + "0"
                                Else
                                    result = result + "1"
                                End If
                            Next
                            MsgBox("XOR Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hexa(r)
                            MsgBox(r1)
                            orflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("INvalid destination register")
                            End If

                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = hexa(r)
                                MsgBox(r1)
                                orflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("INvalid destination register")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be possibl")
                End If
            Else
                MsgBox("Invalid sign Opeartion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And v2.Trim.ElementAt(6) = "+" Or v2.Trim.ElementAt(6) = "-" And v1.Length = 3 And v2.Length = 13 And v2.Trim.StartsWith("[") And v2.Trim.EndsWith("]") And (v2.Trim.ToUpper.ElementAt(5) = "h" Or v2.Trim.ToUpper.ElementAt(5) = "H") And (v2.Trim.ToUpper.ElementAt(11) = "h" Or v2.Trim.ToUpper.ElementAt(11) = "H") And (v1.ToUpper.Trim.EndsWith("h") Or v1.ToUpper.Trim.EndsWith("H")) Then
            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            If v2.Trim.ToUpper.ElementAt(6) = "+" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                MsgBox(baseadd1)
                Dim baseadd2 As Long = hex_to_dec(v4)

                Dim baseadd3 As Long = hex_to_dec(v5)

                Dim sumbase As Long = baseadd2 + baseadd3
                Dim sumbase2 As String = Hex(sumbase)
                Dim sumbase1 As String = sumbase2 + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumbase1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumbase1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                    result = result + "0"
                                Else
                                    result = result + "1"
                                End If
                            Next
                            MsgBox("XOR Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hex8(r)
                            orflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = r1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = r1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = r1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = r1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal value")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.Trim.ToUpper.ElementAt(6) = "-" Then
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next

                If count = v3.Length And count1 = v4.Length And count2 = v5.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim baseadd1 As Long = hex_to_dec(v3)
                Dim baseadd2 As Long = hex_to_dec(v4)
                Dim baseadd3 As Long = hex_to_dec(v5)
                If baseadd2 > baseadd3 Then
                    Dim sumbase As Long = baseadd2 - baseadd3
                    Dim sumbase1 As String = Hex(sumbase)
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumbase1)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumbase1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hex8(r)
                                orflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal value")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox(" substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varorbaseindx()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub Xorrgstrrelativ()
        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v3 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox((b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))))
        If (b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And (v1.ToUpper.Trim.EndsWith("H")) And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 4)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.Trim.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v2)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                    result = result + "0"
                                Else
                                    result = result + "1"
                                End If
                            Next
                            MsgBox("XOR Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            orflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("INvalid destination register")
                            End If

                        Else
                            MsgBox("Invalid hexadecmil enterd")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next
            ElseIf v3.Trim.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                orflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("INvalid destination register")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be proseccd")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And (v1.ToUpper.Trim.ElementAt(2) = "H") And ((v3.Length = 10) Or (v3.Length = 11) Or (v3.Length = 12) Or (v3.Length = 13))) Then
            Dim v2 As String = v1.ToUpper.Trim.Substring(0, 2)
            Dim v4 As String = v3.Substring(1, 4)
            Dim v5 As String = TextBox32.Text.ToUpper
            If v3.ElementAt(6) = "+" Then
                Dim str() As String = v5.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                Dim adddec As Long = decregrltv2 + decregrltv3
                Dim sumadddec As String = Hex(adddec)
                Dim sumadddec1 As String = sumadddec + "H"
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadddec)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1
                        'TextBox32.Text = DataGridView1.Rows(ij).Cells(1).Value.ToString
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then
                            binOp1 = hex_to_bin(v2)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                    result = result + "0"
                                Else
                                    result = result + "1"
                                End If
                            Next
                            MsgBox("XOR Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = hex8(r)
                            MsgBox(r1)
                            orflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then
                                AH.Text = r1.ToUpper
                                AL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                BH.Text = r1.ToUpper
                                BL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                BL.Text = r1.ToUpper
                                BH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                CH.Text = r1.ToUpper
                                CL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                CL.Text = r1.ToUpper
                                CH.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                DH.Text = r1.ToUpper
                                DL.Text = "00"
                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid register ")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v3.ElementAt(6) = "-" Then
                Dim str() As String = v5.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                MsgBox(actualstring)
                Dim v6 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v6)
                Dim count As Integer = 0
                For i As Integer = 0 To v2.Length - 1

                    If f1.Contains(v2.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v6.Length - 1

                    If f1.Contains(v6.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                If count = v2.Length And count1 = v4.Length And count2 = v6.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim decregrltv1 As Long = hex_to_dec(v2)
                Dim decregrltv2 As Long = hex_to_dec(v4)
                Dim decregrltv3 As Long = hex_to_dec(v6)
                If decregrltv2 > decregrltv3 Then
                    Dim adddec As Long = decregrltv2 - decregrltv3
                    Dim sumadddec As String = Hex(adddec)
                    Dim sumadddec1 As String = sumadddec + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sumadddec)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sumadddec1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v2)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim s1 As String = hex_to_bin(v3)
                                Dim s2 As String = hex_to_bin(u1)
                                Dim source As String = s2
                                Dim dest As String = s1
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hex8(r)
                                orflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then
                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then
                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then
                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then
                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then
                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then
                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"
                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then
                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid register ")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal valie")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next
                Else
                    MsgBox("Substraction cannot be possible")
                End If
            Else
                MsgBox("Invalid sign Operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varorrgstrrltv()
        Else
            MsgBox("Invalid register combination")
        End If
    End Sub
    Sub Xorrltvbase()

        Dim v1 As String = InputBox(TextBox30.Text.Trim.ToUpper)
        Dim v2 As String = InputBox(TextBox32.Text.Trim.ToUpper)
        MsgBox((c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H")))
        If b.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 5) And v1.ToUpper.Trim.EndsWith("H") Then
            Dim v3 As String = v1.ToUpper.Substring(0, 4)

            Dim v4 As String = v2.ToUpper.Substring(1, 4)

            Dim v5 As String = v2.ToUpper.Substring(7, 4)

            Dim v6 As String = TextBox32.Text.Trim.ToUpper

            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                MsgBox(actualstring)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                MsgBox(v7)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If

                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                        DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                        TextBox32.Text = values1
                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 4 Then
                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow()
                            Dim s1 As String = hex_to_bin(v3)
                            Dim s2 As String = hex_to_bin(u1)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                    result = result + "0"
                                Else
                                    result = result + "0"
                                End If
                            Next
                            MsgBox("XOR Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            Dim r1 As String = hexa(r)
                            andflagsetting(r1)
                            If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                AH.Text = r1.ToUpper.Substring(0, 2)
                                AL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                BH.Text = r1.ToUpper.Substring(0, 2)
                                BL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                CH.Text = r1.ToUpper.Substring(0, 2)
                                CL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                DH.Text = r1.ToUpper.Substring(0, 2)
                                DL.Text = r1.ToUpper.Substring(2, 2)
                            ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                SI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                DI.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                SP.Text = r1.ToUpper
                            ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                BP.Text = r1.ToUpper
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction cannot be prossed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                            DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 4 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow()
                                Dim s3 As String = hex_to_bin(v3)
                                Dim s4 As String = hex_to_bin(u1)
                                Dim source As String = s4
                                Dim dest As String = s3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = hexa(r)
                                andflagsetting(r1)
                                If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    AH.Text = r1.ToUpper.Substring(0, 2)
                                    AL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BH.Text = r1.ToUpper.Substring(0, 2)
                                    BL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    CH.Text = r1.ToUpper.Substring(0, 2)
                                    CL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DH.Text = r1.ToUpper.Substring(0, 2)
                                    DL.Text = r1.ToUpper.Substring(2, 2)
                                ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    DI.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    SP.Text = r1.ToUpper
                                ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                    BP.Text = r1.ToUpper
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction cannot be done")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f - 1).Cells(1).Value = values1.Substring(values1.Length - 2, 2)
                                DataGridView1.Rows(f).Cells(1).Value = values1.Substring(values1.Length - 4, 2)
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 4 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow()
                                    Dim s3 As String = hex_to_bin(v3)
                                    Dim s4 As String = hex_to_bin(u1)
                                    Dim source As String = s4
                                    Dim dest As String = s3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                            result = result + "0"
                                        Else
                                            result = result + "1"
                                        End If
                                    Next
                                    MsgBox("XOR Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    Dim r1 As String = hexa(r)
                                    andflagsetting(r1)
                                    If TextBox30.Text.Trim.ToUpper = b(0) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        AH.Text = r1.ToUpper.Substring(0, 2)
                                        AL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(1) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        BH.Text = r1.ToUpper.Substring(0, 2)
                                        BL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(2) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        CH.Text = r1.ToUpper.Substring(0, 2)
                                        CL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(3) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        DH.Text = r1.ToUpper.Substring(0, 2)
                                        DL.Text = r1.ToUpper.Substring(2, 2)
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(4) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        SI.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(5) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        DI.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(6) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        SP.Text = r1.ToUpper
                                    ElseIf TextBox30.Text.Trim.ToUpper = b(7) Or (v2.Trim.ToUpper.Substring(1, 2) = "BX") Or (v2.Trim.ToUpper.Substring(1, 2) = "SI") Or (v2.Trim.ToUpper.Substring(1, 2) = "DI") Or (v2.Trim.ToUpper.Substring(1, 2) = "SP") Or (v2.Trim.ToUpper.Substring(1, 2) = "BP") Then
                                        BP.Text = r1.ToUpper
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next
                    Else
                        MsgBox("Substraction cannot be perfomred")
                    End If
                Else
                    MsgBox("Substraction cannot be perfomred")
                End If
            Else
                MsgBox("Invalid sign opearion")
            End If
        ElseIf c.Contains(TextBox30.Text.Trim.ToUpper) And (v1.Length = 3) And v1.ToUpper.Trim.EndsWith("H") Then

            Dim v3 As String = v1.ToUpper.Substring(0, 2)
            Dim v4 As String = v2.ToUpper.Substring(1, 4)
            Dim v5 As String = v2.ToUpper.Substring(7, 4)
            Dim v6 As String = TextBox32.Text.Trim.ToUpper
            If v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim sumadd As Long = adddec2 + adddec3 + adddec4
                Dim sumadd1 As String = Hex(sumadd)
                Dim flagValue As Boolean = False
                For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                    Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                    Dim f As Integer = hex_to_dec(sumadd1)
                    Dim f1 As Integer = hex_to_dec(tempstr)
                    If (f = f1) Then
                        Dim values1 As String = InputBox("enter the value for" + sumadd1)
                        DataGridView1.Rows(f).Cells(1).Value = values1
                        TextBox32.Text = values1

                        Dim u1 As String = TextBox32.Text
                        If u1.Length = 2 Then

                            binOp1 = hex_to_bin(v3)
                            binOp2 = hex_to_bin(u1)
                            t5.Text = OverFlow8()
                            Dim s1 As String = hex_to_bin(v3)
                            MsgBox(s1)
                            Dim s2 As String = hex_to_bin(u1)
                            MsgBox(s2)
                            Dim source As String = s2
                            Dim dest As String = s1
                            Dim result As String = ""
                            For i As Integer = 0 To dest.Length - 1
                                If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                    result = result + "0"
                                Else
                                    result = result + "1"
                                End If
                            Next
                            MsgBox("XOR Result is " + result)
                            Dim r As String = bin_to_dec(result)
                            MsgBox(r)
                            Dim r1 As String = Hex(r)
                            MsgBox(r1)
                            andflagsetting8(r1)
                            If TextBox30.Text.Trim.ToUpper = c(0) Then

                                AH.Text = r1.ToUpper
                                AL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                AL.Text = r1.ToUpper
                                AH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                BH.Text = r1.ToUpper
                                BL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                BL.Text = r1.ToUpper
                                BH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                CH.Text = r1.ToUpper
                                CL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                CL.Text = r1.ToUpper
                                CH.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                DH.Text = r1.ToUpper
                                DL.Text = "00"

                            ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                DL.Text = r1.ToUpper
                                DH.Text = "00"
                            Else
                                MsgBox("Invalid reg combination")
                            End If
                        Else
                            MsgBox("Invalid hexadecimal number")
                        End If
                        flagValue = False
                        Exit For
                    Else
                        flagValue = True
                    End If
                Next

            ElseIf v2.ToUpper.ElementAt(6) = "+" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                Dim s1 As Long = adddec2 + adddec3
                If s1 > adddec4 Then
                    Dim s2 As Long = s1 - adddec4
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1

                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "0"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                MsgBox(r)
                                Dim r1 As String = Hex(r)
                                MsgBox(r1)
                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("substraction cannot be processed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "+" Then
                Dim str() As String = v6.Split("+")
                Dim actualstring As String = str(1).Substring(0, str(1).Length - 1)
                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)
                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)

                Dim adddec2 As Long = hex_to_dec(v4)

                Dim adddec3 As Long = hex_to_dec(v5)

                Dim adddec4 As Long = hex_to_dec(v7)

                Dim s1 As Long = adddec2 + adddec4
                If s1 > adddec3 Then
                    Dim s2 As Long = s1 - adddec3
                    MsgBox(s2)
                    Dim sum As String = Hex(s2)
                    Dim sum1 As String = sum + "H"
                    Dim flagValue As Boolean = False
                    For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                        Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                        Dim f As Integer = hex_to_dec(sum)
                        Dim f1 As Integer = hex_to_dec(tempstr)
                        If (f = f1) Then
                            Dim values1 As String = InputBox("enter the value for" + sum1)
                            DataGridView1.Rows(f).Cells(1).Value = values1
                            TextBox32.Text = values1
                            Dim u1 As String = TextBox32.Text
                            If u1.Length = 2 Then
                                binOp1 = hex_to_bin(v3)
                                binOp2 = hex_to_bin(u1)
                                t5.Text = OverFlow8()
                                Dim u3 As String = hex_to_bin(v3)
                                Dim u4 As String = hex_to_bin(u1)
                                Dim source As String = u4
                                Dim dest As String = u3
                                Dim result As String = ""
                                For i As Integer = 0 To dest.Length - 1
                                    If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                        result = result + "0"
                                    Else
                                        result = result + "1"
                                    End If
                                Next
                                MsgBox("XOR Result is " + result)
                                Dim r As String = bin_to_dec(result)
                                Dim r1 As String = Hex(r)
                                andflagsetting8(r1)
                                If TextBox30.Text.Trim.ToUpper = c(0) Then

                                    AH.Text = r1.ToUpper
                                    AL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                    AL.Text = r1.ToUpper
                                    AH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                    BH.Text = r1.ToUpper
                                    BL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                    BL.Text = r1.ToUpper
                                    BH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                    CH.Text = r1.ToUpper
                                    CL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                    CL.Text = r1.ToUpper
                                    CH.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                    DH.Text = r1.ToUpper
                                    DL.Text = "00"

                                ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                    DL.Text = r1.ToUpper
                                    DH.Text = "00"
                                Else
                                    MsgBox("Invalid reg combination")
                                End If
                            Else
                                MsgBox("Invalid hexadecimal number")
                            End If
                            flagValue = False
                            Exit For
                        Else
                            flagValue = True
                        End If
                    Next

                Else
                    MsgBox("Substraction Cannot be performed")
                End If
            ElseIf v2.ToUpper.ElementAt(6) = "-" And v2.ToUpper.ElementAt(12) = "-" Then
                Dim str() As String = v6.Split("-")
                Dim actualstring As String = str(2).Substring(0, str(2).Length - 1)

                Dim v7 As String = actualstring.Substring(0, actualstring.Length - 1)

                Dim count As Integer = 0
                For i As Integer = 0 To v3.Length - 1

                    If f1.Contains(v3.Substring(i, 1).ToUpper) Then
                        count = count + 1
                    End If
                Next
                Dim count1 As Integer = 0
                For i As Integer = 0 To v4.Length - 1

                    If f1.Contains(v4.Substring(i, 1).ToUpper) Then
                        count1 = count1 + 1
                    End If
                Next
                Dim count2 As Integer = 0
                For i As Integer = 0 To v5.Length - 1

                    If f1.Contains(v5.Substring(i, 1).ToUpper) Then
                        count2 = count2 + 1
                    End If
                Next
                Dim count3 As Integer = 0
                For i As Integer = 0 To v7.Length - 1

                    If f1.Contains(v7.Substring(i, 1).ToUpper) Then
                        count3 = count3 + 1
                    End If
                Next
                If count = v3.Length And count1 = v4.Length And count2 = v5.Length And count3 = v7.Length Then
                    MsgBox("Valid", MsgBoxStyle.Information, "Confirmation")
                Else
                    MsgBox("Invalid", MsgBoxStyle.Information, "Confirmation")
                    Exit Sub
                End If
                Dim adddec1 As Long = hex_to_dec(v3)
                Dim adddec2 As Long = hex_to_dec(v4)
                Dim adddec3 As Long = hex_to_dec(v5)
                Dim adddec4 As Long = hex_to_dec(v7)
                If adddec2 > adddec3 Then
                    Dim s1 As Long = adddec2 - adddec3
                    If s1 > adddec4 Then
                        Dim s2 As Long = s1 - adddec4
                        Dim sum As String = Hex(s2)
                        Dim sum1 As String = sum + "H"
                        Dim flagValue As Boolean = False
                        For ij As Integer = 0 To DataGridView1.Rows.Count - 2
                            Dim tempstr As String = DataGridView1.Rows(ij).Cells(0).Value.ToString
                            Dim f As Integer = hex_to_dec(sum)
                            Dim f1 As Integer = hex_to_dec(tempstr)
                            If (f = f1) Then
                                Dim values1 As String = InputBox("enter the value for" + sum1)
                                DataGridView1.Rows(f).Cells(1).Value = values1
                                TextBox32.Text = values1
                                Dim u1 As String = TextBox32.Text
                                If u1.Length = 2 Then
                                    binOp1 = hex_to_bin(v3)
                                    binOp2 = hex_to_bin(u1)
                                    t5.Text = OverFlow8()
                                    Dim u3 As String = hex_to_bin(v3)
                                    MsgBox(s1)
                                    Dim u4 As String = hex_to_bin(u1)
                                    MsgBox(s2)
                                    Dim source As String = u4
                                    Dim dest As String = u3
                                    Dim result As String = ""
                                    For i As Integer = 0 To dest.Length - 1
                                        If (dest.Substring(i, 1) = "1" And source.Substring(i, 1) = "1") Or (dest.Substring(i, 1) = "0" And source.Substring(i, 1) = "0") Then
                                            result = result + "0"
                                        Else
                                            result = result + "1"
                                        End If
                                    Next
                                    MsgBox("XOR Result is " + result)
                                    Dim r As String = bin_to_dec(result)
                                    MsgBox(r)
                                    Dim r1 As String = Hex(r)
                                    MsgBox(r1)
                                    andflagsetting8(r1)
                                    If TextBox30.Text.Trim.ToUpper = c(0) Then

                                        AH.Text = r1.ToUpper
                                        AL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(1) Then
                                        AL.Text = r1.ToUpper
                                        AH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(2) Then

                                        BH.Text = r1.ToUpper
                                        BL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(3) Then

                                        BL.Text = r1.ToUpper
                                        BH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(4) Then

                                        CH.Text = r1.ToUpper
                                        CL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(5) Then

                                        CL.Text = r1.ToUpper
                                        CH.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(6) Then

                                        DH.Text = r1.ToUpper
                                        DL.Text = "00"

                                    ElseIf TextBox30.Text.Trim.ToUpper = c(7) Then

                                        DL.Text = r1.ToUpper
                                        DH.Text = "00"
                                    Else
                                        MsgBox("Invalid reg combination")
                                    End If
                                Else
                                    MsgBox("Invalid hexadecimal number")
                                End If
                                flagValue = False
                                Exit For
                            Else
                                flagValue = True
                            End If
                        Next

                    Else
                        MsgBox("Substraction CAnnot be performed")
                    End If
                Else
                    MsgBox("Substraction CAnnot be performed")
                End If

            Else
                MsgBox("Invlaid sign operation")
            End If
        ElseIf (Not (b.Contains(TextBox30.Text.Trim) Or c.Contains(TextBox30.Text.Trim))) Then
            'varorrltvbase()
        Else
            MsgBox("Invalid register cobination")
        End If
    End Sub
    Sub executes()
        Dim inp, inp1, inp2 As String
        inp = UCase(TextBox29.Text)
        inp1 = UCase(TextBox30.Text)
        inp2 = UCase(TextBox32.Text)
        If b.Contains(TextBox30.Text.Trim.ToUpper) Or c.Contains(TextBox30.Text.Trim.ToUpper) Then
            If inp = a(0) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    MOVimmediateAddressing()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    MOVregisterAddressing()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    MOVregisterIndirect()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    MOVdirctAddressing()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    MOVBaseIndexAddressing()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    MOVregisterRelativeAddressing()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    MOVRelativeBaseIndexMode()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(1) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    AddImmediateAddressing()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    AddRegisterAddressing()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    AddRegisterIndirectAddressing()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    AddDirectAddressing()   
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    AddBaseIndexAddressing()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    AddRegisterRelativeAddressing()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    AddRelativeBaseIndexAddressing()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(2) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    SubImmediateAddressing()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    SubRegisterAddressing()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    SubRegisterIndirectAddressing()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    SubDirectAddressing()       
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    SubBaseInderAddressing()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    SubRegisterRelativeAddressing()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    SubRelativeBaseIndexAddressing()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(14) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    sbbimmdte()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    sbbregstr()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    sbbrgstrindrct()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    sbbdrct()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    sbbbasedindex()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    sbbbaserltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    sbbrltvbaseindx()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(5) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    andimmdtemode()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    andregstrMode()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    andrgindctMode()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    anddrctMode()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    andbaseindexMode()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    andrgstrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    andrltvbase()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(6) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    orimmdete()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    orregstrMod()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    orregindctMode()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    ordirctMode()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    orbaseindexMode()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    orrgstrrelativ()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    orrltvbase()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If
            ElseIf inp = a(22) Then
                If (rgster_add(inp1, inp2, 1) = 1) Then
                    XorregstrMod()
                ElseIf (immdt_add(inp1, inp2, 1) = 1) Then
                    Xorimmdete()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    XorregindctMode()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    XordirctMode()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    XorbaseindexMode()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    Xorrgstrrelativ()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    Xorrltvbase()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(21) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    cmpimmdte()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    cmpregstr()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    cmprgstrindrct()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    cmpdrct()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    cmpbaseindx()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    cmprgtrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    cmpbaserltv()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(13) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    testimmdte()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    testrgstr()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    testrgindrct()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    testdrct()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    testbaseindex()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    testrgstrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    testrltvbase()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(7) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    exchangeimmdte()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    xchgregaddsngMode()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    xchgregindctMode()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    xchgdrctMode()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    xchgbaseindxMode()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    xchgbaserltvMode()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    xchgrltvbaseindexMode()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(11) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    adcimmdte()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    adcrgstr()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    adcrggtrindcr()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    adcdrct()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    adcbaseindex()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    adcrgstrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    adcrltvbaseindx()
                Else
                    MsgBox("Invalid Adressing Mode")
                End If

            ElseIf inp = a(3) Then
                If (reg1_add(inp1, 1) = 1) Then
                    MulRegisterAddressing()
                Else
                    MsgBox("Invalid multiplication addressing mode")
                End If

            ElseIf inp = a(4) Then
                If (reg1_add(inp1, 1) = 1) Then
                    DivRegisterAddressing()
                Else
                    MsgBox("Invalid division addressing mode")
                End If
            ElseIf inp = a(8) Then
                If (reg1_add(inp1, 1) = 1) Then
                    IncRegisterAddressing()
                Else
                    MsgBox("Invalid regstr")
                End If
            ElseIf inp = a(9) Then
                If (reg1_add(inp1, 1) = 1) Then
                    decregisteraddressingMode()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            ElseIf inp = a(10) Then
                If (reg1_add(inp1, 1) = 1) Then
                    NotRegisterAddressing()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            ElseIf inp = a(12) Then
                If (reg1_add(inp1, 1) = 1) Then
                    negrgstr()
                End If
            ElseIf inp = a(15) Then
                If (shftrtr(inp1, inp2, 1) = 1) Then
                    shl()
                ElseIf (shftrtr1(inp1, inp2, 1) = 1) Then
                    shl()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            ElseIf inp = a(16) Then
                If (shftrtr(inp1, inp2, 1) = 1) Then
                    shr()
                ElseIf (shftrtr1(inp1, inp2, 1) = 1) Then
                    shr()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            ElseIf inp = a(17) Then
                If (shftrtr(inp1, inp2, 1) = 1) Then
                    sar()
                ElseIf (shftrtr1(inp1, inp2, 1) = 1) Then
                    sar()
                Else
                    MsgBox("Invalid not reg1 add mode")
                End If
            ElseIf inp = a(18) Then
                If (shftrtr(inp1, inp2, 1) = 1) Then
                    sal()
                ElseIf (shftrtr1(inp1, inp2, 1) = 1) Then
                    sal()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            ElseIf inp = a(19) Then
                If (shftrtr(inp1, inp2, 1) = 1) Then
                    rol()
                ElseIf (shftrtr1(inp1, inp2, 1) = 1) Then
                    rol()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            ElseIf inp = a(20) Then
                If (shftrtr(inp1, inp2, 1) = 1) Then
                    ror()
                ElseIf (shftrtr1(inp1, inp2, 1) = 1) Then
                    ror()
                Else
                    MsgBox("Invalid not reg add mode")
                End If
            Else
                MsgBox("Inavlid,instruction")
            End If
        Else
            If inp = a(3) Then
                If (reg1_add(inp1, 1) = 1) Then
                    varmulregstrMode()
                Else
                    MsgBox("Invalid addressing mode")
                End If
            ElseIf inp = a(4) Then
                If (reg1_add(inp1, 1) = 1) Then
                    vardivrgstrmode()
                Else
                    MsgBox("Invalid division addressing mode")
                End If
            ElseIf inp = a(10) Then
                If (reg1_add(inp1, 1) = 1) Then
                    varnotregMode()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf TextBox29.Text.Trim.ToUpper = a(8) Then
                If (reg1_add(inp1, 1) = 1) Then
                    varincrgstr()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf TextBox29.Text.Trim.ToUpper = a(9) Then
                If (reg1_add(inp1, 1) = 1) Then
                    vardecrgstrMode()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf inp = a(0) Then
                If (regindct_add(inp1, inp2, 1) = 1) Then
                    varmovrgstrindrctMode()
                ElseIf (drct_add1(inp1, inp2, 1) = 1) Then
                    varmovdrctMode()
                ElseIf (immdt_add(inp1, inp2, 1) = 1) Then
                    varmovimmdtMode()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    varmovregMode()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    varmovbaseindxMode()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf inp = a(6) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    varorimmdete()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    varoregindrct()
                ElseIf (drct_add3(inp1, inp2, 1) = 1) Then
                    varordrct()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    varorbaseindx()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    varorrgstrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    varorrltvbase()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    varorregster()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf inp = a(1) Then
                If (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    varaddrgstrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    varaddrltvbaseMode()
                ElseIf (immdt_add(inp1, inp2, 1) = 1) Then
                    varaddImmdtMode()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    varaddregindctMode()
                ElseIf (drct_add(inp1, inp2, 1) = 1) Then
                    varadddrctMode()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    varaddregadd()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    varaddbaseMode()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf TextBox29.Text.Trim.ToUpper = a(2) Then
                If (rgster_add(inp1, inp2, 1) = 1) Then
                    varsubregMode()
                ElseIf (immdt_add(inp1, inp2, 1) = 1) Then
                    varsubimmtrMode()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    varsubregindrctMode()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    varsubbaseindxMode()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    varsubrgstrrltvMode()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    varsubbserltvMode()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            ElseIf inp = a(5) Then
                If (immdt_add(inp1, inp2, 1) = 1) Then
                    varandimmedate()
                ElseIf (baseindx_add(inp1, inp2, 1) = 1) Then
                    varandbaseindxMode()
                ElseIf (regstrrltv_add(inp1, inp2, 1) = 1) Then
                    varandrgstrrltv()
                ElseIf (rltvbasdindx_add(inp1, inp2, 1) = 1) Then
                    varandrltvbase()
                ElseIf (regindct_add(inp1, inp2, 1) = 1) Then
                    varandrgstrindrct()
                ElseIf (drct_add3(inp1, inp2, 1) = 1) Then
                    varanddrctMode()
                ElseIf (rgster_add(inp1, inp2, 1) = 1) Then
                    varandreg()
                Else
                    MsgBox("Invalid Addressing Mode")
                End If
            End If
            End If

    End Sub
   
    Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
        executes()
    End Sub
    Private Sub t1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles t1.TextChanged, t2.TextChanged, t3.TextChanged, t4.TextChanged, t5.TextChanged, t6.TextChanged, t7.TextChanged, t8.TextChanged, t9.TextChanged, t10.TextChanged, t11.TextChanged, t12.TextChanged, t13.TextChanged, t14.TextChanged, t15.TextChanged, t16.TextChanged
        If sender.text = "1" Then
            sender.backcolor = Color.GreenYellow
        ElseIf sender.text = "0" Then
            sender.backcolor = Color.Yellow
        End If
    End Sub
    Private Sub GroupBox5_Enter(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GroupBox5.Enter

    End Sub
    Private Sub TextBox30_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TextBox29.KeyPress, TextBox30.KeyPress, TextBox31.KeyPress, TextBox32.KeyPress
        If e.KeyChar = " " Then
            e.Handled = True
        End If
    End Sub
   
    Private Sub TextBox32_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox32.TextChanged
        TextBox31.Text = ","

    End Sub

    Private Sub Label5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label5.Click

    End Sub

    Private Sub GroupBox2_Enter(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GroupBox2.Enter

    End Sub
End Class

